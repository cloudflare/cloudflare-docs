---
pcx-content-type: tutorial
title: Direct creator uploads
weight: 4
---

# Direct creator uploads

Direct creator uploads allow users to upload videos without API tokens. A common place to
use Direct creator uploads is on web apps, client side applications, or on mobile apps
where users upload content directly to Stream.

## Generate a unique one-time upload URL

To give users the ability to directly upload their videos, first generate and
provide them with a unique one-time upload URL with the following API request.

To make API requests you will need your [Cloudflare API token](https://www.cloudflare.com/a/account/my-account) and your Cloudflare [account ID](https://www.cloudflare.com/a/overview/).

### Upload constraints

There are several constraints you can enforce on your user's uploads through the
body of the `POST` request:

{{<definitions>}}

- `maxDurationSeconds` {{<type>}}integer{{</type>}} {{<prop-meta>}}required{{</prop-meta>}}

  - Enforces the maximum duration in seconds for a video the user uploads. For direct uploads, Stream requires videos are at least 1 second in length, and restricts to a maximum of 6 hours. Therefore, this field must be greater than 1 and less than 21,600.

- `expiry` {{<type>}}string (date){{</type>}} {{<prop-meta>}}default: now + 30 minutes{{</prop-meta>}}
  - Optional string field that enforces the time after which the unique one-time upload URL is invalid. The time value must be formatted in RFC3339 layout and will be interpreted against UTC time zone. If an expiry is set, it must be no less than two minutes in the future, and not more than 6 hours in the future. If an expiry is not set, the upload URL will expire 30 minutes after it's creation.

{{</definitions>}}

Additionally, you can control security features through these fields:

{{<definitions>}}

- `requireSignedURLs` {{<type>}}boolean{{</type>}} {{<prop-meta>}}default: false{{</prop-meta>}}

  - Limits the permission to view the video to only [signed URLs](/stream/viewing-videos/securing-your-stream/).

- `allowedOrigins` {{<type>}}array of strings{{</type>}} {{<prop-meta>}}default: _empty_{{</prop-meta>}}

  - Limit the domains this video can be embedded on. Learn more about [allowed origins](/stream/viewing-videos/securing-your-stream/).

- `thumbnailTimestampPct` {{<type>}}float{{</type>}} {{<prop-meta>}}default: 0{{</prop-meta>}}

  - Sets the timestamp location of [thumbnail](/stream/viewing-videos/displaying-thumbnails/) image to a percentage location of the video from 0 to 1.

- `watermark` {{<type>}}string{{</type>}} {{<prop-meta>}}default: _none_{{</prop-meta>}}

  - `uid` of the watermark profile to be included in this video. Video uploaded by the link will be [watermarks](/stream/uploading-videos/applying-watermarks/) automatically.

- `meta` {{<type>}}json map{{</type>}} {{<prop-meta>}}default: _none_{{</prop-meta>}}
  - Set the video's `name` along with any other additional arbitrary keys for metadata to be stored.

{{</definitions>}}

## Using Basic Uploads

If the uploads from your creators are under 200MB, you can use basic uploads. For videos over 200 MB, use TUS uploads (described later in this article.)

The first step is to request a token by calling the `direct_upload` end point from your server:
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-function">curl</span><span class="CodeBlock--token-plain"> -X POST </span><span class="CodeBlock--token-punctuation">\</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"> -H </span><span class="CodeBlock--token-string">'Authorization: Bearer $TOKEN'</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-punctuation">\</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">https://api.cloudflare.com/client/v4/accounts/</span><span class="CodeBlock--token-variable">$ACCOUNT</span><span class="CodeBlock--token-plain">/stream/direct_upload </span><span class="CodeBlock--token-punctuation">\</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"> --data </span><span class="CodeBlock--token-string">'{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-string">    &quot;maxDurationSeconds&quot;: 3600,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-string">    &quot;expiry&quot;: &quot;2020-04-06T02:20:00Z&quot;,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-string">    &quot;requireSignedURLs&quot;: true,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-string">    &quot;allowedOrigins&quot;: [&quot;example.com&quot;],</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-string">    &quot;thumbnailTimestampPct&quot;: 0.568427,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-string">    &quot;watermark&quot;: {</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-string">        &quot;uid&quot;: &quot;$watermark_uid&quot;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-string">    }</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-string"> }'</span><span class="CodeBlock--token-plain">
</span></div></span></span></span></code></pre>{{</raw>}}

### Example responses

A successful response looks like:
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-string">&quot;result&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-string">&quot;uploadURL&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">&quot;https://upload.videodelivery.net/f65014bc6ff5419ea86e7972a047ba22&quot;</span><span class="CodeBlock--token-plain">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-string">&quot;uid&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">&quot;f65014bc6ff5419ea86e7972a047ba22&quot;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-plain">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-string">&quot;success&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> true,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-string">&quot;errors&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-punctuation">[</span><span class="CodeBlock--token-punctuation">]</span><span class="CodeBlock--token-plain">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-string">&quot;messages&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-punctuation">[</span><span class="CodeBlock--token-punctuation">]</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-plain">
</span></div></span></span></span></code></pre>{{</raw>}}

An unsuccessful response might look like:
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-string">&quot;result&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> null,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-string">&quot;success&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> false,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-string">&quot;errors&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-punctuation">[</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-string">&quot;code&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-number">10005</span><span class="CodeBlock--token-plain">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-string">&quot;message&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">&quot;Bad Request&quot;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-punctuation">}</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-punctuation">]</span><span class="CodeBlock--token-plain">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-string">&quot;messages&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-punctuation">[</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-string">&quot;code&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-number">10005</span><span class="CodeBlock--token-plain">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-string">&quot;message&quot;</span><span class="CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">&quot;required field maxDurationSeconds is missing&quot;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-punctuation">}</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-punctuation">]</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-plain">
</span></div></span></span></span></code></pre>{{</raw>}}

The `uploadURL` provided in the `result` body of a successful request should be passed along to the end-user to make their upload request.

The `uid` references the reserved media object's unique identifier and can be kept as a reference to query our [API](/stream/uploading-videos/searching/).

## Direct creator upload request from end users

Using the `uploadURL` provided in the previous request, users can upload video
files. Uploads are limited to 200 MB in size.
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-function">curl</span><span class="CodeBlock--token-plain"> -X POST </span><span class="CodeBlock--token-punctuation">\</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  -F </span><span class="CodeBlock--token-assign-left CodeBlock--token-variable">file</span><span class="CodeBlock--token-operator">=</span><span class="CodeBlock--token-plain">@/Users/mickie/Downloads/example_video.mp4 </span><span class="CodeBlock--token-punctuation">\</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  https://upload.videodelivery.net/f65014bc6ff5419ea86e7972a047ba22</span></div></span></span></span></code></pre>{{</raw>}}

A successful upload will receive a `200` response. If the upload does not meet
the upload constraints defined at time of creation or is larger than 200 MB in
size, the user will receive a `4xx` response.

### Example
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-html" language="html"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-doctype CodeBlock--token-punctuation">&lt!</span><span class="CodeBlock--token-doctype CodeBlock--token-doctype-tag">DOCTYPE</span><span class="CodeBlock--token-doctype"> </span><span class="CodeBlock--token-doctype CodeBlock--token-name">html</span><span class="CodeBlock--token-doctype CodeBlock--token-punctuation">&gt</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt</span><span class="CodeBlock--token-tag CodeBlock--token-tag">html</span><span class="CodeBlock--token-tag"> </span><span class="CodeBlock--token-tag CodeBlock--token-attr-name">lang</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation CodeBlock--token-attr-equals">=</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation">&quot;</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value">en</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation">&quot;</span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">&gt</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt</span><span class="CodeBlock--token-tag CodeBlock--token-tag">head</span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">&gt</span><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt/</span><span class="CodeBlock--token-tag CodeBlock--token-tag">head</span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">&gt</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt</span><span class="CodeBlock--token-tag CodeBlock--token-tag">body</span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">&gt</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt</span><span class="CodeBlock--token-tag CodeBlock--token-tag">form</span><span class="CodeBlock--token-tag"> </span><span class="CodeBlock--token-tag CodeBlock--token-attr-name">id</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation CodeBlock--token-attr-equals">=</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation">&quot;</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value">form</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation">&quot;</span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">&gt</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt</span><span class="CodeBlock--token-tag CodeBlock--token-tag">input</span><span class="CodeBlock--token-tag"> </span><span class="CodeBlock--token-tag CodeBlock--token-attr-name">type</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation CodeBlock--token-attr-equals">=</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation">&quot;</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value">file</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation">&quot;</span><span class="CodeBlock--token-tag"> </span><span class="CodeBlock--token-tag CodeBlock--token-attr-name">accept</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation CodeBlock--token-attr-equals">=</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation">&quot;</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value">video/*</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation">&quot;</span><span class="CodeBlock--token-tag"> </span><span class="CodeBlock--token-tag CodeBlock--token-attr-name">id</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation CodeBlock--token-attr-equals">=</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation">&quot;</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value">video</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation">&quot;</span><span class="CodeBlock--token-tag"> </span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">/&gt</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt</span><span class="CodeBlock--token-tag CodeBlock--token-tag">button</span><span class="CodeBlock--token-tag"> </span><span class="CodeBlock--token-tag CodeBlock--token-attr-name">type</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation CodeBlock--token-attr-equals">=</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation">&quot;</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value">submit</span><span class="CodeBlock--token-tag CodeBlock--token-attr-value CodeBlock--token-punctuation">&quot;</span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">&gt</span><span class="CodeBlock--token-plain">Upload Video</span><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt/</span><span class="CodeBlock--token-tag CodeBlock--token-tag">button</span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">&gt</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt/</span><span class="CodeBlock--token-tag CodeBlock--token-tag">form</span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">&gt</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt</span><span class="CodeBlock--token-tag CodeBlock--token-tag">script</span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">&gt</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">      </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">async</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">function</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-function">getOneTimeUploadUrl</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">        </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-comment">// The real implementation of this function should make an API call to your server</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">        </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-comment">// where a unique one-time upload URL should be generated and returned to the browser.</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">        </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-comment">// Here we will use a fake one that looks real but won't actually work.</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">        </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">return</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-string">'https://upload.videodelivery.net/f65014bc6ff5419ea86e7972a047ba22'</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">      </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">}</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">      </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">const</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> form </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-operator">=</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> document</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-function">getElementById</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-string">'form'</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">      </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">const</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> videoInput </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-operator">=</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> document</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-function">getElementById</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-string">'video'</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">      form</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-function">addEventListener</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-string">'submit'</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">,</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">async</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-parameter">e</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-operator">=&gt</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">        e</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-function">preventDefault</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">        </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">const</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> oneTimeUploadUrl </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-operator">=</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">await</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-function">getOneTimeUploadUrl</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">        </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">const</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> video </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-operator">=</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> videoInput</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript">files</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">[</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-number">0</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">]</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">        </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">const</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> formData </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-operator">=</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">new</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-class-name">FormData</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">        formData</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-function">append</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-string">'file'</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">,</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> video</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">        </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">const</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> uploadResult </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-operator">=</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-keyword">await</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-function">fetch</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript">oneTimeUploadUrl</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">,</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">          </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-literal-property">method</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-operator">:</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-string">'POST'</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">          </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-literal-property">body</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-operator">:</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> formData</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">        </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">        form</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript">innerHTML </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-operator">=</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript"> </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-string">'&lth3&gtUpload successful!&lt/h3&gt'</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">      </span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-script CodeBlock--token-language-javascript CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-script CodeBlock--token-language-javascript">    </span><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt/</span><span class="CodeBlock--token-tag CodeBlock--token-tag">script</span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">&gt</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt/</span><span class="CodeBlock--token-tag CodeBlock--token-tag">body</span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">&gt</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-tag CodeBlock--token-tag CodeBlock--token-punctuation">&lt/</span><span class="CodeBlock--token-tag CodeBlock--token-tag">html</span><span class="CodeBlock--token-tag CodeBlock--token-punctuation">&gt</span><span class="CodeBlock--token-plain">
</span></div></span></span></span></code></pre>{{</raw>}}

## Using tus (recommended for videos over 200MB)

tus is a protocol that supports resumable uploads and works best for larger files.

Typically, tus uploads require the authentication information to be sent with every request. This is not ideal for direct creators uploads because it exposes your API key (or token) to the end user.

To get around this, you can request a one-time tokenized URL by making a POST request to the `/stream?direct_user=true` end point:
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-function">curl</span><span class="CodeBlock--token-plain"> -H </span><span class="CodeBlock--token-string">&quot;Authorization: bearer </span><span class="CodeBlock--token-string CodeBlock--token-variable">$TOKEN</span><span class="CodeBlock--token-string">&quot;</span><span class="CodeBlock--token-plain"> -X POST -H </span><span class="CodeBlock--token-string">'Tus-Resumable: 1.0.0'</span><span class="CodeBlock--token-plain"> -H </span><span class="CodeBlock--token-string">'Upload-Length: $VIDEO_LENGTH'</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">'https://api.cloudflare.com/client/v4/accounts/$ACCOUNT/stream?direct_user=true'</span><span class="CodeBlock--token-plain">
</span></div></span></span></span></code></pre>{{</raw>}}

The response will contain a `Location` header which provides the one-time URL the client can use to upload the video using tus.

Here is a demo Cloudflare Worker script which returns the one-time upload URL:
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-js" language="js"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-function">addEventListener</span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-string">'fetch'</span><span class="CodeBlock--token-punctuation">,</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-parameter">event</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-operator">=&gt</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  event</span><span class="CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-function">respondWith</span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-function">handleRequest</span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-plain">event</span><span class="CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-plain">request</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-punctuation">;</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-punctuation">;</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-comment">/**</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-comment"> * Respond to the request</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-comment"> * @param {Request} request</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-comment"> */</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-keyword">async</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-keyword">function</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">handleRequest</span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-parameter">request</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-keyword">const</span><span class="CodeBlock--token-plain"> response </span><span class="CodeBlock--token-operator">=</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-keyword">await</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">fetch</span><span class="CodeBlock--token-punctuation">(</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-string">'https://api.cloudflare.com/client/v4/accounts/$ACCOUNT/stream?direct_user=true'</span><span class="CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-literal-property">method</span><span class="CodeBlock--token-operator">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">'POST'</span><span class="CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-literal-property">headers</span><span class="CodeBlock--token-operator">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">        </span><span class="CodeBlock--token-string-property">'Authorization'</span><span class="CodeBlock--token-operator">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">'bearer $TOKEN'</span><span class="CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">        </span><span class="CodeBlock--token-string-property">'Tus-Resumable'</span><span class="CodeBlock--token-operator">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">'1.0.0'</span><span class="CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">        </span><span class="CodeBlock--token-string-property">'Upload-Length'</span><span class="CodeBlock--token-operator">:</span><span class="CodeBlock--token-plain"> request</span><span class="CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-plain">headers</span><span class="CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-function">get</span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-string">'Upload-Length'</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">        </span><span class="CodeBlock--token-string-property">'Upload-Metadata'</span><span class="CodeBlock--token-operator">:</span><span class="CodeBlock--token-plain"> request</span><span class="CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-plain">headers</span><span class="CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-function">get</span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-string">'Upload-Metadata'</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-punctuation">}</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-keyword">const</span><span class="CodeBlock--token-plain"> destination </span><span class="CodeBlock--token-operator">=</span><span class="CodeBlock--token-plain"> response</span><span class="CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-plain">headers</span><span class="CodeBlock--token-punctuation">.</span><span class="CodeBlock--token-function">get</span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-string">'Location'</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-punctuation">;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-keyword">return</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-keyword">new</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-class-name">Response</span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-keyword">null</span><span class="CodeBlock--token-punctuation">,</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-literal-property">headers</span><span class="CodeBlock--token-operator">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-string-property">'Access-Control-Expose-Headers'</span><span class="CodeBlock--token-operator">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">'Location'</span><span class="CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-string-property">'Access-Control-Allow-Headers'</span><span class="CodeBlock--token-operator">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">'*'</span><span class="CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-string-property">'Access-Control-Allow-Origin'</span><span class="CodeBlock--token-operator">:</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">'*'</span><span class="CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">      </span><span class="CodeBlock--token-string-property">'Location'</span><span class="CodeBlock--token-operator">:</span><span class="CodeBlock--token-plain"> destination</span><span class="CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">    </span><span class="CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-punctuation">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">  </span><span class="CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-punctuation">;</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-plain">
</span></div></span></span></span></code></pre>{{</raw>}}

Once you have an endpoint that returns the tokenized upload URL from the `location` header, you can use it by setting the tus client to make a request to _your_ endpoint. For details on using a tus client, refer to the [Resumable uploads with tus ](/stream/uploading-videos/upload-video-file/#resumable-uploads-with-tus-for-large-files) article.

### Testing your Direct Creator Upload Endpoint

Once you have built your endpoint which calls Stream and returns the tokenized URL in the location header, you can test it with this [tus codepen demo](https://codepen.io/cfzf/pen/wvGMRXe). In the demo codepen, paste your end point URL in the `Upload endpoint` field and then try to upload a video.

When using Direct Creator Uploads, the `Upload endpoint` field in the demo should contain the url to your endpoint, not to the videodelivery.net tokenized URL. This is the most common reason Direct Creator Uploads fail using tus. Customers often set the tus url to the videodelivery.net URL instead of to their endpoint which _returns_ the videodelivery.net URL.

Please note that if you are developing on localhost, your test using the codepen may fail. Before testing, it is best to push your endpoint to a server with an IP and/or domain so you are not using localhost. Alternatively, you can setup a Worker with the example code provided above.

### Upload-Metadata header syntax

You can apply the same constraints as Direct Creator Upload via basic upload when using tus. To do so, you must pass the expiry and maxDurationSeconds as part of the `Upload-Metadata` request header as part of the first request (made by the Worker in the example above.) The `Upload-Metadata` values are ignored from subsequent requests that do the actual file upload.

Upload-Metadata header should contain key-value pairs. The keys are text and the values should be base64. Separate the key and values by a space, _not_ an equal sign. To join multiple key-value pairs, include a comma with no additional spaces.

In the example below, the `Upload-Metadata` header is instructing Stream to only accept uploads with max video duration of 10 minutes and to make this video private:

`'Upload-Metadata: maxDurationSeconds NjAw,requiresignedurls'`

_NjAw_ is the base64 encoded value for "600" (or 10 minutes).

## Tracking user upload progress

After the creation of a unique one-time upload URL, you may wish to retain the
`uid` returned in the response to track the progress of a user's upload.

You can do that two ways:

1.  You can [query the media API](/stream/uploading-videos/searching/) with the UID
    to understand it's status.

2.  You can [create a webhook subscription](/stream/uploading-videos/using-webhooks/) to receive notifications
    regarding the status of videos. These notifications include the video's UID.
