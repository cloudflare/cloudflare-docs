---
pcx-content-type: tutorial
title: Parse Cloudflare Logs JSON data
weight: 86
---

# Parse Cloudflare Logs JSON data

## Overview

After downloading your Cloudflare Logs data, you can use different tools to parse and analyze your logs.

In this tutorial, you will learn how to parse your JSON log data using _jq_. To get started with _jq_, visit the [_jq_ official site](https://stedolan.github.io/jq/).

{{<Aside type="note" header="Note">}}

_jq_ is a powerful command line for parsing JSON data and performing certain types of analysis. To perform more detailed analysis, consider a full-fledged data analysis system, such as _Kibana_.

{{</Aside>}}

## Aggregating fields

To aggregate a field appearing in the log, such as by IP address, URI, or referrer, you can use several _jq_ commands. This is useful to identify any patterns in traffic; for example, to identify your most popular pages or to block an attack.

The following examples match on a field name and provide a count of each field instance, sorted in ascending order by count.
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">$ jq -r .ClientRequestURI logs.json </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">uniq</span><span class="CodeBlock--token-plain"> -c </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">tail</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-number">2</span><span class="CodeBlock--token-plain"> /nginx-logo.png</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">2</span><span class="CodeBlock--token-plain"> /poweredby.png</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">2</span><span class="CodeBlock--token-plain"> /testagain</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">3</span><span class="CodeBlock--token-plain"> /favicon.ico</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">3</span><span class="CodeBlock--token-plain"> /testing</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">3</span><span class="CodeBlock--token-plain"> /testing123</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">6</span><span class="CodeBlock--token-plain"> /test</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">7</span><span class="CodeBlock--token-plain"> /testing1234</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">10</span><span class="CodeBlock--token-plain"> /cdn-cgi/nexp/dok3v</span><span class="CodeBlock--token-operator">=</span><span class="CodeBlock--token-plain">1613a3a185/cloudflare/rocket.js</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">54</span><span class="CodeBlock--token-plain"> /</span></div></span></span></span></code></pre>{{</raw>}}
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">$ jq -r .ClientRequestUserAgent logs.json </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">uniq</span><span class="CodeBlock--token-plain"> -c </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">tail</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-number">1</span><span class="CodeBlock--token-plain"> python-requests/2.9.1</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">2</span><span class="CodeBlock--token-plain"> Mozilla/5.0 </span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-plain">Macintosh</span><span class="CodeBlock--token-punctuation">;</span><span class="CodeBlock--token-plain"> Intel Mac OS X 10_7_5</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-plain"> AppleWebKit/537.17 </span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-plain">KHTML, like Gecko</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-plain"> Chrome/24.0.1312.56 Safari/537.17</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">4</span><span class="CodeBlock--token-plain"> Mozilla/5.0 </span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-plain">X11</span><span class="CodeBlock--token-punctuation">;</span><span class="CodeBlock--token-plain"> Linux x86_64</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-plain"> AppleWebKit/537.36 </span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-plain">KHTML, like Gecko</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-plain"> Chrome/48.0.2564.116 Safari/537.36</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">5</span><span class="CodeBlock--token-plain"> curl/7.47.2-DEV</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">36</span><span class="CodeBlock--token-plain"> Mozilla/5.0 </span><span class="CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-plain">X11</span><span class="CodeBlock--token-punctuation">;</span><span class="CodeBlock--token-plain"> Linux x86_64</span><span class="CodeBlock--token-punctuation">;</span><span class="CodeBlock--token-plain"> rv:44.0</span><span class="CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-plain"> Gecko/20100101 Firefox/44.0</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">51</span><span class="CodeBlock--token-plain"> curl/7.46.0-DEV</span></div></span></span></span></code></pre>{{</raw>}}
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">$ jq -r .ClientRequestReferer logs.json </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">uniq</span><span class="CodeBlock--token-plain"> -c </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">tail</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-number">2</span><span class="CodeBlock--token-plain"> http://example.com/testagain</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">3</span><span class="CodeBlock--token-plain"> http://example.com/testing</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">5</span><span class="CodeBlock--token-plain"> http://example.com/</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">5</span><span class="CodeBlock--token-plain"> http://example.com/testing123</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">7</span><span class="CodeBlock--token-plain"> http://example.com/testing1234</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">77</span><span class="CodeBlock--token-plain"> null</span></div></span></span></span></code></pre>{{</raw>}}

## Filtering fields

Another common use case involves filtering data for a specific field value and then aggregating after that. This helps answer questions like _Which URLs saw the most 502 errors?_ For example:
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">$ jq </span><span class="CodeBlock--token-string">'select(.OriginResponseStatus == 502) | .ClientRequestURI'</span><span class="CodeBlock--token-plain"> logs.json </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">uniq</span><span class="CodeBlock--token-plain"> -c </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">tail</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-number">1</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">&quot;/favicon.ico&quot;</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-number">1</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">&quot;/testing&quot;</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-number">3</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">&quot;/testing123&quot;</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-number">6</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">&quot;/test&quot;</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-number">6</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">&quot;/testing1234&quot;</span><span class="CodeBlock--token-plain">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-number">18</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-string">&quot;/&quot;</span><span class="CodeBlock--token-plain">
</span></div></span></span></span></code></pre>{{</raw>}}

To find out the top IP addresses blocked by the Cloudflare WAF, use the following query:
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">$ jq -r </span><span class="CodeBlock--token-string">'select(.WAFAction == &quot;drop&quot;) | .ClientIP'</span><span class="CodeBlock--token-plain"> logs.json </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">uniq</span><span class="CodeBlock--token-plain"> -c </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">1</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-number">127.0</span><span class="CodeBlock--token-plain">.0.1</span></div></span></span></span></code></pre>{{</raw>}}

## Showing cached requests

To retrieve your cache ratios, try the following query:
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">$ jq -r </span><span class="CodeBlock--token-string">'.CacheCacheStatus'</span><span class="CodeBlock--token-plain"> logs.json </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">uniq</span><span class="CodeBlock--token-plain"> -c </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">3</span><span class="CodeBlock--token-plain"> hit</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">3</span><span class="CodeBlock--token-plain"> null</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">3</span><span class="CodeBlock--token-plain"> stale</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">4</span><span class="CodeBlock--token-plain"> expired</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">6</span><span class="CodeBlock--token-plain"> miss</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">81</span><span class="CodeBlock--token-plain"> unknown</span></div></span></span></span></code></pre>{{</raw>}}

## Showing TLS versions

To find out which TLS versions your visitors are using — for example, to decide if you can disable TLS versions that are older than 1.2 — use the following query:
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">$ jq -r </span><span class="CodeBlock--token-string">'.ClientSSLProtocol'</span><span class="CodeBlock--token-plain"> logs.json </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">uniq</span><span class="CodeBlock--token-plain"> -c </span><span class="CodeBlock--token-operator">|</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-function">sort</span><span class="CodeBlock--token-plain"> -n</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">42</span><span class="CodeBlock--token-plain"> none</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain"></span><span class="CodeBlock--token-number">58</span><span class="CodeBlock--token-plain"> TLSv1.2</span></div></span></span></span></code></pre>{{</raw>}}
