---
pcx-content-type: how-to
title: Manage custom certificates
weight: 2
---

# Manage custom certificates

## Certificate requirements

Certificates are parsed and checked for validity before being accepted. Each certificate uploaded must:

- Be encoded in PEM format (PEM, PKCS#7, or PKCS#12), see [Converting Using OpenSSL](https://www.sslshopper.com/article-most-common-openssl-commands.html) for conversion examples.
- Not have a [key file password](/ssl/edge-certificates/custom-certificates/remove-file-key-password/).
- Not be expiring in less than 14 days from time of upload.
- Have a subject alternative name (SAN) matching at least one hostname in the zone where it’s being uploaded.
- Use a private key greater than or equal to a minimum length (currently 2048 bit for RSA and 225 bit for ECDSA).
- Be publicly trusted by a major browser, unless the `User Defined` bundling method is used.
- Be one of the following certificate types:

  - Unified Communications Certificates (UCC)
  - Extended Validation (EV)
  - Domain Validated (DV)
  - Organization Validated (OV)

---

## Upload a custom certificate

### Using the dashboard

To upload a custom SSL certificate in the dashboard:

1.  Log in to the [Cloudflare dashboard](https://dash.cloudflare.com) and select your account.

2.  Select your application.

3.  Navigate to **SSL/TLS**.

4.  In **Edge Certificates**, click **Upload Custom SSL Certificate**.

5.  Copy and paste relevant values into **SSL Certificate** and **Private key** text areas (or click **Paste from file**).

    {{<Aside type="note">}}If doing this manually, include the `---BEGIN CERTIFICATE---` and `---END CERTIFICATE---` like the placeholder text.{{</Aside>}}

6.  Choose the appropriate [**Bundle Method**](/ssl/edge-certificates/custom-certificates/bundling-methodologies/).

7.  Select a value for [**Private Key Restriction**](/ssl/edge-certificates/custom-certificates/#geo-key-manager-private-key-restriction).

8.  Select a value for **Legacy Client Support**, which toggles [Server Name Indication (SNI)](/fundamentals/glossary/#server-name-indication-sni) support:

    - **Modern (recommended)**: SNI only
    - **Legacy**: Supports non-SNI

9.  Click **Upload Custom Certificate**. If you see an error for `The key you provided does not match the certificate`, contact your Certificate Authority to ensure the private key matches the certificate.

10. (optional) [Add a CAA DNS record](/ssl/edge-certificates/custom-certificates/caa-records/).

---

### Using the API

The call below will upload a certificate for use with `app.example.com`. Cloudflare will automatically bundle the certificate with a certificate chain optimized for maximum compatibility with browsers.

Note that if you are using an ECC key generated by OpenSSL, you will need to first remove the `-----BEGIN EC PARAMETERS-----...-----END EC PARAMETERS-----` section of the file.

#### Step 1 — Update the file and build the payload

{{<render file="_custom-cert-file-example.md">}}
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">$ </span><span class="CodeBlock--token-assign-left CodeBlock--token-variable">request_body</span><span class="CodeBlock--token-operator">=</span><span class="CodeBlock--token-variable CodeBlock--token-variable">$(</span><span class="CodeBlock--token-variable CodeBlock--token-operator">&lt</span><span class="CodeBlock--token-variable"> </span><span class="CodeBlock--token-variable CodeBlock--token-operator">&lt</span><span class="CodeBlock--token-variable CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-variable CodeBlock--token-function">cat</span><span class="CodeBlock--token-variable"> </span><span class="CodeBlock--token-variable CodeBlock--token-operator">&lt&lt</span><span class="CodeBlock--token-variable CodeBlock--token-string">EOF</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable CodeBlock--token-string">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable CodeBlock--token-string">	&quot;certificate&quot;: &quot;</span><span class="CodeBlock--token-variable CodeBlock--token-string CodeBlock--token-variable">$MYCERT</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable CodeBlock--token-string">	&quot;private_key&quot;: &quot;</span><span class="CodeBlock--token-variable CodeBlock--token-string CodeBlock--token-variable">$MYKEY</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable CodeBlock--token-string">	&quot;bundle_method&quot;:&quot;ubiquitous&quot;</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable CodeBlock--token-string">}</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable CodeBlock--token-string">EOF</span><span class="CodeBlock--token-variable">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-variable CodeBlock--token-variable">)</span><span class="CodeBlock--token-plain">
</span></div></span></span></span></code></pre>{{</raw>}}

You can optionally add [geographic restrictions](https://blog.cloudflare.com/introducing-cloudflare-geo-key-manager/) that specify where your private key can physically be decrypted:
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">$ </span><span class="CodeBlock--token-assign-left CodeBlock--token-variable">request_body</span><span class="CodeBlock--token-operator">=</span><span class="CodeBlock--token-variable CodeBlock--token-variable">$(</span><span class="CodeBlock--token-variable CodeBlock--token-operator">&lt</span><span class="CodeBlock--token-variable"> </span><span class="CodeBlock--token-variable CodeBlock--token-operator">&lt</span><span class="CodeBlock--token-variable CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-variable CodeBlock--token-function">cat</span><span class="CodeBlock--token-variable"> </span><span class="CodeBlock--token-variable CodeBlock--token-operator">&lt&lt</span><span class="CodeBlock--token-variable">EOF</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable"></span><span class="CodeBlock--token-variable CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable">	</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;certificate&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-variable"> </span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-string CodeBlock--token-variable">$MYCERT</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;</span><span class="CodeBlock--token-variable">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable">	</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;private_key&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-variable"> </span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-string CodeBlock--token-variable">$MYKEY</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;</span><span class="CodeBlock--token-variable">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable">	</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;bundle_method&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;ubiquitous&quot;</span><span class="CodeBlock--token-variable">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable">	</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;geo_restrictions&quot;</span><span class="CodeBlock--token-variable">:</span><span class="CodeBlock--token-variable CodeBlock--token-punctuation">{</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;label&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;us&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-variable">'</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable"></span><span class="CodeBlock--token-variable CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-variable">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-variable CodeBlock--token-variable">)</span><span class="CodeBlock--token-plain">
</span></div></span></span></span></code></pre>{{</raw>}}

You can also enable support for legacy clients which do not include SNI in the TLS handshake.
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">$ </span><span class="CodeBlock--token-assign-left CodeBlock--token-variable">request_body</span><span class="CodeBlock--token-operator">=</span><span class="CodeBlock--token-variable CodeBlock--token-variable">$(</span><span class="CodeBlock--token-variable CodeBlock--token-operator">&lt</span><span class="CodeBlock--token-variable"> </span><span class="CodeBlock--token-variable CodeBlock--token-operator">&lt</span><span class="CodeBlock--token-variable CodeBlock--token-punctuation">(</span><span class="CodeBlock--token-variable CodeBlock--token-function">cat</span><span class="CodeBlock--token-variable"> </span><span class="CodeBlock--token-variable CodeBlock--token-operator">&lt&lt</span><span class="CodeBlock--token-variable">EOF</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable"></span><span class="CodeBlock--token-variable CodeBlock--token-punctuation">{</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable">	</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;certificate&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-variable"> </span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-string CodeBlock--token-variable">$MYCERT</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;</span><span class="CodeBlock--token-variable">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable">	</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;private_key&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-variable"> </span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-string CodeBlock--token-variable">$MYKEY</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;</span><span class="CodeBlock--token-variable">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable">	</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;bundle_method&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;ubiquitous&quot;</span><span class="CodeBlock--token-variable">,</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable">	</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;geo_restrictions&quot;</span><span class="CodeBlock--token-variable">:</span><span class="CodeBlock--token-variable CodeBlock--token-punctuation">{</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;label&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;us&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-variable">',</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable">	</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;type&quot;</span><span class="CodeBlock--token-variable CodeBlock--token-builtin CodeBlock--token-class-name">:</span><span class="CodeBlock--token-variable CodeBlock--token-string">&quot;sni_custom&quot;</span><span class="CodeBlock--token-variable">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-variable">
</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-variable CodeBlock--token-punctuation">)</span><span class="CodeBlock--token-variable CodeBlock--token-variable">)</span><span class="CodeBlock--token-plain">
</span></div></span></span></span></code></pre>{{</raw>}}

`sni_custom` is recommended by Cloudflare. Use `legacy_custom` when a specific client requires non-SNI support. The Cloudflare API treats all Custom SSL certificates as Legacy by default.

#### Step 2 — Upload your certificate and key

Use the [POST](https://api.cloudflare.com/#custom-ssl-for-a-zone-create-ssl-configuration) endpoint to upload your certificate and key.
{{<raw>}}<pre class="CodeBlock CodeBlock-with-rows CodeBlock-scrolls-horizontally CodeBlock-is-light-in-light-theme CodeBlock--language-bash" language="bash"><code><span class="CodeBlock--rows"><span class="CodeBlock--rows-content"><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">$ </span><span class="CodeBlock--token-function">curl</span><span class="CodeBlock--token-plain"> -sX POST https://api.cloudflare.com/client/v4/zones/</span><span class="CodeBlock--token-punctuation">{</span><span class="CodeBlock--token-plain">zone_id</span><span class="CodeBlock--token-punctuation">}</span><span class="CodeBlock--token-plain">/custom_certificates </span><span class="CodeBlock--token-punctuation">\</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">     -H </span><span class="CodeBlock--token-string">&quot;X-Auth-Email: {email}&quot;</span><span class="CodeBlock--token-plain"> -H </span><span class="CodeBlock--token-string">&quot;X-Auth-Key: {key}&quot;</span><span class="CodeBlock--token-plain"> </span><span class="CodeBlock--token-punctuation">\</span></div></span><span class="CodeBlock--row"><span class="CodeBlock--row-indicator"></span><div class="CodeBlock--row-content"><span class="CodeBlock--token-plain">     -H </span><span class="CodeBlock--token-string">&quot;Content-Type: application/json&quot;</span><span class="CodeBlock--token-plain"> -d </span><span class="CodeBlock--token-string">&quot;</span><span class="CodeBlock--token-string CodeBlock--token-variable">$request_body</span><span class="CodeBlock--token-string">&quot;</span><span class="CodeBlock--token-plain">
</span></div></span></span></span></code></pre>{{</raw>}}

#### Step 3 (optional) — Add a CAA record

{{<render file="_caa-records-definition.md">}}

For more guidance, refer to [Create a CAA record](/ssl/edge-certificates/custom-certificates/caa-records/).

## Update a certificate

### Using the dashboard

To update a certificate:

1.  Log in to the [Cloudflare dashboard](https://dash.cloudflare.com) and select your account.
2.  Select your application.
3.  Navigate to **SSL/TLS**.
4.  In **Edge Certificates**, locate a custom certificate.
5.  Click the wrench icon and click **Replace SSL certificate and key**.
6.  Follow the same steps as [create a new certificate](#upload-a-custom-certificate).

{{<Aside type="note">}}

To update the **Private Key Restriction** setting of a certificate, delete and re-add the certificate.

{{</Aside>}}

### Using the API

Use a [PATCH](https://api.cloudflare.com/#custom-ssl-for-a-zone-edit-ssl-configuration) command.
