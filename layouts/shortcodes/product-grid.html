{{- $dataArray := slice }}
{{- $availableOptions := slice "Cloudflare Essentials" "Infrastructure" "Zero Trust" "Consumer products" "Developer platform" -}}

{{- range readDir "./data/" -}}
{{- if in .Name ".yml"}}
{{- $productName :=  replace .Name ".yml" "" -}}
{{ $dataArray = $dataArray | append (index $.Site.Data $productName) }}
{{- end -}}
{{- end -}}

<style>
  .ProductGrid--content {
    --n: 1;
    display: grid;
    flex-direction: column;
    grid-template-columns: repeat(var(--n), 1fr);
    gap: 5px
  }

  .ProductGrid--title {
    font-size: 1.3em;
    font-weight: 600;
    margin: 1.2em 0;
  }

  @media screen and (min-width: 600px) {
    .ProductGrid--content {
      --n: 2;
    }
  }

  @media screen and (min-width: 978px) {
    .ProductGrid--content {
      --n: 3;
    }
  }

  @media screen and (min-width: 1200px) {
    .ProductGrid--content {
      --n: 4;
    }
  }
</style>

<div class="ProductGrid">
  {{- range $availableOptions -}}
  {{- $currentOption := . }}
  {{- $title := "" -}}
  {{- if eq $currentOption "Cloudflare Essentials" -}}
    {{- $title = "Quick links" -}}
  {{- else -}}
    {{- $title = $currentOption -}}
  {{- end -}}
  <div class="ProductGrid--title">
    <span>{{$title}}</span>
  </div>
  <div class="ProductGrid--content">
    {{- range $dataArray -}} 
      {{- if eq $currentOption .product.group -}}
        {{- $product := .product -}} 
        {{- $wrap := default false $product.wrap -}}
        <a
          class="ProductGrid--link"
          data-wrap-title="{{ $wrap }}"
          href="{{ $product.url }}"
        >
          <div>{{ safeHTML .logo }}</div>
          <span>{{ $product.title }}</span>
        </a>
        {{- end -}}
      {{- end -}}
  </div>
  {{- end -}}
</div>
