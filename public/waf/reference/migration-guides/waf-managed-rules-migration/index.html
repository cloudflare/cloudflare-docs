<!doctype html>
<html lang="en" theme="light" is-docs-page js-focus-visible-polyfill-available >
  <head>

  <meta charset="utf-8">
  <title>WAF Managed Rules migration · Cloudflare Web Application Firewall (WAF) docs</title>
  <meta name="title" content="WAF Managed Rules migration · Cloudflare Web Application Firewall (WAF) docs" />
  <meta name="image" content="https://developers.cloudflare.com/core-services-preview.png" />

  <meta http-equiv="cleartype" content="on" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="application-name" content="WAF Managed Rules migration · Cloudflare Web Application Firewall (WAF) docs" />
  <meta name="msapplication-tap-highlight" content="no" />
  <meta name="apple-mobile-web-app-title" content="WAF Managed Rules migration · Cloudflare Web Application Firewall (WAF) docs" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="theme-color" content="#f38020" />

  <meta name="description" content="On 2022-05-04, Cloudflare started the WAF migration from the previous version of WAF managed rules to the new WAF Managed Rules, allowing a first set …" />

  <meta property="og:site_name" content="Cloudflare Docs" />
  <meta property="og:image" content="https://developers.cloudflare.com/core-services-preview.png" />
  <meta property="og:title" content="WAF Managed Rules migration · Cloudflare Web Application Firewall (WAF) docs" />
  <meta property="og:description" content="On 2022-05-04, Cloudflare started the WAF migration from the previous version of WAF managed rules to the new WAF Managed Rules, allowing a first set …" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://developers.cloudflare.com/waf/reference/migration-guides/waf-managed-rules-migration/" />

  <meta name="twitter:title" content="WAF Managed Rules migration · Cloudflare Web Application Firewall (WAF) docs" />
  <meta name="twitter:image" content="https://developers.cloudflare.com/core-services-preview.png" />
  <meta name="twitter:description" content="On 2022-05-04, Cloudflare started the WAF migration from the previous version of WAF managed rules to the new WAF Managed Rules, allowing a first set …" />
  <meta name="twitter:card" content="summary_large_image" />

  <meta name="pcx_product" content="waf"><meta name="algolia_product_filter" content="WAF"><meta name="algolia_page_title" content="WAF Managed Rules migration">
  <meta name="pcx_word_count" content="3600"><meta name="pcx_last_modified" content="44"><meta name="pcx_last_reviewed" content="500" /><meta name="pcx_content_type" content="reference" />
  <meta name="algolia_content_type" content="Reference"><meta name="pcx_content_group" content="Application security" />
  
  
  <link rel="icon" href="/favicon-32x32.png" />
  <link rel="canonical" href="https://developers.cloudflare.com/waf/reference/migration-guides/waf-managed-rules-migration/" />
  <link rel="sitemap" href="/sitemap.xml" type="application/xml" />
  <link rel="manifest" href="/manifest.webmanifest" />

  <link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png" />
  <link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png" />
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png" />
  <link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png" />
  <link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png" />
  <link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png" />
  <link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png" /><script type="module" src="/search.js" defer></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3.5.1" />
  <script defer async src="https://cdn.jsdelivr.net/npm/@docsearch/js@3.5.1"></script>
  <script>window.algoliaConfig = {"apikey":"4edb0a6cef3338ff4bcfbc6b3d2db56b","index":"developers-cloudflare2","product":"waf"}</script>
  <meta name="docsearch:product" content="waf" /><link rel="stylesheet preconnect" href="/style.css" />
      <link rel="stylesheet preconnect" href="/codeBlock.css" /><link rel="preload" href="https://unpkg.com/littlefoot@4.0.0-11/dist/littlefoot.css" as="style">
    <link rel="preload" href="https://unpkg.com/littlefoot@4.0.0-11/dist/littlefoot.js" as="script" />
    <link rel="stylesheet" href="https://unpkg.com/littlefoot@4.0.0-11/dist/littlefoot.css" /><script>// <stdin>
(function() {
  let tooEarly = false;
  let btn;
  let media;
  if (document.readyState !== "loading") init();
  else addEventListener("DOMContentLoaded", init);
  btn = document.querySelector("#ThemeToggle");
  tooEarly = !btn;
  function setter(isDark) {
    try {
      let theme = isDark ? "dark" : "light";
      document.documentElement.setAttribute("theme", theme);
      document.documentElement.setAttribute("data-theme", theme);
      localStorage.theme = JSON.stringify({ theme });
      if (btn) {
        btn.checked = isDark;
        tooEarly = false;
      } else if (tooEarly) {
        setTimeout(setter, 1, isDark);
      }
    } catch (err) {
    }
    const themeToggleTooltip = document.querySelector("#ThemeToggle--tooltip");
    if (!themeToggleTooltip) return;
    if (isDark) {
      themeToggleTooltip.textContent = "Set theme to light (\u21E7+D)";
    } else {
      themeToggleTooltip.textContent = "Set theme to dark (\u21E7+D)";
    }
  }
  function init() {
    btn = btn || document.querySelector("#ThemeToggle");
    btn.addEventListener("change", () => setter(!!btn.checked));
    addEventListener("keydown", (ev) => {
      if (ev.target !== document.body || ev.repeat) return;
      if (ev.which === 68 && ev.shiftKey) {
        ev.preventDefault();
        setter(!btn.checked);
      }
    });
  }
  try {
    media = window.matchMedia("(prefers-color-scheme:dark)");
    media.onchange = (ev) => setter(ev.matches);
  } catch (err) {
  }
  try {
    let value = localStorage.theme;
    let row = value && JSON.parse(value);
    setter(row ? /dark/.test(row.theme) : !!(media && media.matches));
  } catch (err) {
  }
})();
</script><script type="module" src="/main.js" defer></script></head>
  <body><div class="DocsPage"><div>
    <a class="skip-link" href='#main'>Skip to content</a>
</div><div class="DocsMobileHeader">
  <a class="DocsMobileHeader--cloudflare-logo-link Link Link-without-underline" href="/">
    <div class="DocsNavLogoLockup DocsNavLogoLockup-with-small-gap">
      
<div class="DocsNavLogoLockup--logo">
  <svg viewBox="0 0 48 48" fill="currentColor" role="img" aria-labelledby="title - cf8c256bceddeba4cdaf8cfc154d4c84" xmlns="http://www.w3.org/2000/svg">
    <title id="title - cf8c256bceddeba4cdaf8cfc154d4c84">Cloudflare Docs logomark</title>
    <path d="M31.236 28.717c-.373-.548-1.003-.864-1.76-.9l-14.353-.195a.262.262 0 01-.221-.122.348.348 0 01-.035-.267.396.396 0 01.338-.268l14.48-.195c1.714-.085 3.58-1.533 4.232-3.309l.828-2.25a.503.503 0 00.023-.292c-.932-4.404-4.698-7.689-9.198-7.689-4.15 0-7.672 2.798-8.931 6.679a4.156 4.156 0 00-2.973-.864c-1.994.207-3.59 1.874-3.789 3.954a4.84 4.84 0 00.105 1.545c-3.253.097-5.853 2.871-5.853 6.29 0 .304.024.608.059.912.023.146.14.256.28.256h26.488c.151 0 .291-.11.338-.268l.198-.742c.245-.876.152-1.68-.256-2.275zM36.062 21.39c-.128 0-.268 0-.396.012-.093 0-.175.073-.21.17l-.56 2.032c-.244.876-.151 1.679.257 2.275.373.548 1.003.864 1.76.9l3.055.195c.093 0 .175.049.222.122a.356.356 0 01.035.267.396.396 0 01-.339.268l-3.182.195c-1.726.085-3.58 1.532-4.232 3.309l-.234.62c-.046.122.035.243.164.243h10.935a.289.289 0 00.28-.219 8.654 8.654 0 00.292-2.214c0-4.501-3.521-8.175-7.847-8.175"></path>
  </svg>
</div>
<span class="DocsNavLogoLockup--text">
  <span data-text="Cloudflare">Cloudflare </span>
  <span data-text="Docs">Docs</span>
</span>
    </div>
  </a>
</div>

<div class="DocsMobileTitleHeader">
  <a aria-current="page" class="DocsMobileTitleHeader--logo-link Link Link-without-underline" href="/waf/">
    <div class="DocsNavLogoLockup DocsNavLogoLockup-with-small-gap">
      <div class="DocsNavLogoLockup--logo">
        <span title="Cloudflare WAF logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 49"><path d="m43.5 25.995 1.5-1.5v-9l-1.5-1.5h-6.3V6.54l-1.5-1.5H4.5L3 6.54v9l1.5 1.5h6.293v6H4.5L3 24.54v9l1.5 1.5h6.293v7.5l1.5 1.5H43.5l1.5-1.5v-9l-1.5-1.5h-6.3v-6l6.3-.045Zm-1.5-3H29.392V17.04H42v5.955ZM34.2 8.04v6H21.6v-6h12.6ZM6 8.04h12.6v6H6v-6Zm7.793 9h12.6v6h-12.6v-6ZM6 25.995h12.6v6H6v-6Zm7.793 15.045v-6h12.6v6h-12.6Zm28.207 0H29.392v-6H42v6Zm-7.792-9H21.6v-6h12.6l.008 6Z"/></svg></span>
      </div>

      <span class="DocsNavLogoLockup--text">
        <span class="DocsSidebar--docs-title-text-scaler" style="--length:3">WAF</span>
      </span>
    </div>
  </a>

  <button class="Button DocsMobileTitleHeader--sidebar-toggle-button">
    <span class="DocsMobileTitleHeader--sidebar-toggle-button-icon" aria-hidden="true">
      <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" role="img" aria-labelledby="title-1332672649688018"
        xmlns="http://www.w3.org/2000/svg">
        <title id="title-1332672649688018">Navigation menu icon</title>
        <path data-index="1" d="M5, 7h10" transform-origin="10  7"></path>
        <path data-index="2" d="M5,10h10" transform-origin="10 10"></path>
        <path data-index="3" d="M5,13h10" transform-origin="10 13"></path>
      </svg>
      <span is-visually-hidden="">Open external link</span>
    </span>
  </button>
</div>

<div class="DocsMobileNavBackdrop"></div><div class="DocsSidebar">
  <div class="DocsSidebar--sections">
    <div class="DocsSidebar--section DocsSidebar--header-section">
      <a class="DocsSidebar--cloudflare-logo-link DocsSidebar--link" href="/">
        <div class="DocsNavLogoLockup">
          
<div class="DocsNavLogoLockup--logo">
  <svg viewBox="0 0 48 48" fill="currentColor" role="img" aria-labelledby="title - cfb88f5bccdf1c4dc4e4aea465cd2cd8" xmlns="http://www.w3.org/2000/svg">
    <title id="title - cfb88f5bccdf1c4dc4e4aea465cd2cd8">Cloudflare Docs logomark</title>
    <path d="M31.236 28.717c-.373-.548-1.003-.864-1.76-.9l-14.353-.195a.262.262 0 01-.221-.122.348.348 0 01-.035-.267.396.396 0 01.338-.268l14.48-.195c1.714-.085 3.58-1.533 4.232-3.309l.828-2.25a.503.503 0 00.023-.292c-.932-4.404-4.698-7.689-9.198-7.689-4.15 0-7.672 2.798-8.931 6.679a4.156 4.156 0 00-2.973-.864c-1.994.207-3.59 1.874-3.789 3.954a4.84 4.84 0 00.105 1.545c-3.253.097-5.853 2.871-5.853 6.29 0 .304.024.608.059.912.023.146.14.256.28.256h26.488c.151 0 .291-.11.338-.268l.198-.742c.245-.876.152-1.68-.256-2.275zM36.062 21.39c-.128 0-.268 0-.396.012-.093 0-.175.073-.21.17l-.56 2.032c-.244.876-.151 1.679.257 2.275.373.548 1.003.864 1.76.9l3.055.195c.093 0 .175.049.222.122a.356.356 0 01.035.267.396.396 0 01-.339.268l-3.182.195c-1.726.085-3.58 1.532-4.232 3.309l-.234.62c-.046.122.035.243.164.243h10.935a.289.289 0 00.28-.219 8.654 8.654 0 00.292-2.214c0-4.501-3.521-8.175-7.847-8.175"></path>
  </svg>
</div>
<span class="DocsNavLogoLockup--text">
  <span data-text="Cloudflare">Cloudflare </span>
  <span data-text="Docs">Docs</span>
</span>
        </div>
      </a>
    </div>

    <div class="DocsSidebar--section-separator"></div>

    <div class="DocsSidebar--section DocsSidebar--docs-title-section">
      <a aria-current="page" class="DocsSidebar--docs-title-logo-link DocsSidebar--link" href="/waf/">
        <div class="DocsNavLogoLockup">
          <div class="DocsNavLogoLockup--logo">
            <span title="Cloudflare WAF logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 49"><path d="m43.5 25.995 1.5-1.5v-9l-1.5-1.5h-6.3V6.54l-1.5-1.5H4.5L3 6.54v9l1.5 1.5h6.293v6H4.5L3 24.54v9l1.5 1.5h6.293v7.5l1.5 1.5H43.5l1.5-1.5v-9l-1.5-1.5h-6.3v-6l6.3-.045Zm-1.5-3H29.392V17.04H42v5.955ZM34.2 8.04v6H21.6v-6h12.6ZM6 8.04h12.6v6H6v-6Zm7.793 9h12.6v6h-12.6v-6ZM6 25.995h12.6v6H6v-6Zm7.793 15.045v-6h12.6v6h-12.6Zm28.207 0H29.392v-6H42v6Zm-7.792-9H21.6v-6h12.6l.008 6Z"/></svg></span>
          </div>

          <span class="DocsNavLogoLockup--text">
            <span class="DocsSidebar--docs-title-text-scaler" style="--length:3">WAF</span>
          </span>
        </div>
      </a>

      <div class="DocsSidebar--section-more Dropdown" data-expanded="false">
        <button class="DocsSidebar--section-more-button Button" aria-expanded="false">
          <div class="DocsSidebar--section-more-button-icon">
            <svg viewBox="0 0 4 16" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" fill="currentColor" role="img" aria-labelledby="title-6032186738345315"
              xmlns="http://www.w3.org/2000/svg">
              <title id="title-6032186738345315">Dropdown icon</title>
              <path d="M2,2v0m0,6v0m0,6v0z"></path>
            </svg>
            <span is-visually-hidden>WAF menu</span>
          </div>
        </button>

        <div class="DocsSidebar--section-more-dropdown Dropdown--dropdown">
          <ul class="Dropdown--list"><li class="Dropdown--item">
                <a class="Dropdown--link" href="https://www.cloudflare.com/waf/" tabindex="-1">Cloudflare WAF homepage</a>
              </li><li class="Dropdown--item">
                <a class="Dropdown--link" href="https://cloudflare.com" tabindex="-1">Cloudflare homepage</a>
              </li></ul>
        </div>
      </div>
    </div>

    <div class="DocsSidebar--section DocsSidebar--nav-section" style="position:relative;overflow:hidden;width:100%;height:100%">
      <div style="position: absolute; inset: 0px; overflow-y: auto; margin-right: 0px; margin-bottom: 0px;">
        <div class="DocsSidebar--nav-section-shadow" style="opacity: 0;"></div>

        <ul class="DocsSidebar--nav">
          <li class="DocsSidebar--nav-item">
            <a class="DocsSidebar--nav-link" href="/waf/">
              <span class="DocsSidebar--nav-link-highlight"></span>
              <span class="DocsSidebar--nav-link-text">Overview</span>
            </a>
          </li>
          <li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/get-started/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Get started</span></a></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Concepts</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/about/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Concepts</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="1" style="--depth:1"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/about/waf-attack-score/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">WAF attack score</span></a></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Uploaded content scanning</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/about/content-scanning/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Uploaded content scanning</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/about/content-scanning/get-started/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Get started</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/about/content-scanning/example-rules/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Example rules</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/about/content-scanning/api-calls/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Common API calls</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Custom rules</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Custom rules</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="1" style="--depth:1"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/create-dashboard/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Create in the dashboard</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/create-api/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Create via API</span></a></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Configure a rule with the Skip action</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/skip/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Configure a rule with the Skip action</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/skip/api-examples/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">API examples</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/skip/options/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Skip options</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Common use cases</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Common use cases</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/allow-traffic-from-ips-in-allowlist/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Allow traffic from IP addresses in allowlist only</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/allow-traffic-from-verified-bots/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Allow traffic from search engine bots</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/allow-traffic-from-specific-countries/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Allow traffic from specific countries only</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/block-ms-exchange-autodiscover/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Block Microsoft Exchange Autodiscover requests</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/block-ip-reputation/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Block requests by Threat Score</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/block-traffic-from-specific-countries/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Block traffic from specific countries</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/challenge-bad-bots/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Challenge bad bots</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/configure-token-authentication/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Configure token authentication</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/exempt-partners-hotlink-protection/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Exempt partners from Hotlink Protection</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/require-specific-cookie/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Require a specific cookie</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/site-admin-only-known-ips/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Require known IP addresses in site admin area</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/require-specific-headers/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Require specific HTTP headers</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/require-specific-http-ports/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Require specific HTTP ports</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/stop-rudy-attacks/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Stop R-U-Dead-Yet? (R.U.D.Y.) attacks</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/use-cases/update-rules-customers-partners/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Update custom rules for customers or partners</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Custom rulesets</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/custom-rulesets/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Custom rulesets</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/custom-rulesets/create-dashboard/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Use the dashboard</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/custom-rules/custom-rulesets/create-api/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Use the API</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Rate limiting rules</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/rate-limiting-rules/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Rate limiting rules</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="1" style="--depth:1"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/rate-limiting-rules/request-rate/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Request rate calculation</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/rate-limiting-rules/create-zone-dashboard/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Create in the dashboard for a zone</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/rate-limiting-rules/create-account-dashboard/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Create in the dashboard for an account</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/rate-limiting-rules/create-api/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Create via API</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/rate-limiting-rules/find-rate-limit/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Find appropriate rate limit</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/rate-limiting-rules/parameters/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Rate limiting parameters</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/rate-limiting-rules/use-cases/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Rule examples</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/rate-limiting-rules/best-practices/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Best practices</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Managed rules</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Managed rules</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="1" style="--depth:1"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/deploy-zone-dashboard/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Deploy in the dashboard for a zone</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/deploy-account-dashboard/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Deploy in the dashboard for an account</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/deploy-api/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Deploy via API</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/handle-false-positives/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Handle false positives</span></a></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Create exceptions</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/waf-exceptions/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Create exceptions</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/waf-exceptions/define-dashboard/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Add an exception in the dashboard</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/waf-exceptions/define-api/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Add an exception via API</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Log the payload of matched rules</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/payload-logging/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Log the payload of matched rules</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/payload-logging/configure/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Configure payload logging in the dashboard</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/payload-logging/view/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">View the payload content in the dashboard</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/payload-logging/configure-api/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Configure payload logging via API</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/payload-logging/decrypt-in-logs/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Store decrypted matched payloads in logs</span></a></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Command-line operations</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/payload-logging/command-line/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Command-line operations</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="3" style="--depth:3"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/payload-logging/command-line/generate-key-pair/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Generate a key pair</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/payload-logging/command-line/decrypt-payload/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Decrypt the payload content</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Check for exposed credentials</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/check-for-exposed-credentials/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Check for exposed credentials</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/check-for-exposed-credentials/how-checks-work/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">How it works</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/check-for-exposed-credentials/configure-api/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Configure via API</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/check-for-exposed-credentials/test-configuration/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Test your configuration</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/check-for-exposed-credentials/monitor-events/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Monitor exposed credentials events</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Rulesets reference</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/reference/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Rulesets reference</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/reference/cloudflare-managed-ruleset/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Cloudflare Managed Ruleset</span></a></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Cloudflare OWASP Core Ruleset</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/reference/owasp-core-ruleset/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Cloudflare OWASP Core Ruleset</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="3" style="--depth:3"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/reference/owasp-core-ruleset/concepts/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Concepts</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/reference/owasp-core-ruleset/example/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Example</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/reference/owasp-core-ruleset/configure-dashboard/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Configure in the dashboard</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/reference/owasp-core-ruleset/configure-api/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Configure via API</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/terraform/additional-configurations/waf-managed-rulesets/#configure-the-owasp-paranoia-level-score-threshold-and-action"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Configure in Terraform</span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/reference/exposed-credentials-check/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Cloudflare Exposed Credentials Check Managed Ruleset</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/managed-rules/reference/sensitive-data-detection/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Cloudflare Sensitive Data Detection</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Additional tools</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/tools/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Additional tools</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="1" style="--depth:1"><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Lists</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/tools/lists/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Lists</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/lists/custom-lists/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Custom lists</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/rules/url-forwarding/bulk-redirects/concepts/#bulk-redirect-lists"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Bulk Redirect Lists</span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/lists/managed-lists/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Managed Lists</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/lists/create-dashboard/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Create in the dashboard</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/lists/use-in-expressions/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Use lists in expressions</span></a></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Lists API</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/tools/lists/lists-api/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Lists API</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="3" style="--depth:3"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/lists/lists-api/json-object/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">JSON object</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/lists/lists-api/endpoints/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Endpoints</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: IP Access rules</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/tools/ip-access-rules/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">IP Access rules</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/ip-access-rules/create/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Create a rule</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/ip-access-rules/parameters/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Parameters</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/ip-access-rules/actions/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Actions</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Scrape Shield</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/tools/scrape-shield/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Scrape Shield</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/scrape-shield/email-address-obfuscation/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Email Address Obfuscation</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/scrape-shield/hotlink-protection/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Hotlink Protection</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/user-agent-blocking/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">User Agent Blocking</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/zone-lockdown/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Zone Lockdown</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/browser-integrity-check/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Browser Integrity Check</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/challenge-passage/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Challenge Passage</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/privacy-pass/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Privacy Pass</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/replace-insecure-js-libraries/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Replace insecure JS libraries</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/tools/security-level/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Security Level</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Analytics</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/analytics/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Analytics</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="1" style="--depth:1"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/analytics/security-analytics/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Security Analytics</span></a></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Security Events</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/analytics/security-events/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Security Events</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/analytics/security-events/free-plan/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Free plan</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/analytics/security-events/paid-plans/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Paid plans</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/analytics/security-events/additional-information/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Additional information</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item" is-active-root is-expanded><button class="Button DocsSidebar--nav-expand-collapse-button">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Reference</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/reference/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Reference</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-expanded" style="min-height:0px;transition-duration:400ms" is-expanded><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="1" style="--depth:1"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/reference/alerts/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Alerts</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/reference/phases/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Phases</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/reference/cloudflare-challenges/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Challenges</span></a></li><li class="DocsSidebar--nav-item" is-active-root is-expanded><button class="Button DocsSidebar--nav-expand-collapse-button">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Migration guides</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/reference/migration-guides/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Migration guides</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-expanded" style="min-height:0px;transition-duration:400ms" is-expanded><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item" is-active><a aria-current="page" class="DocsSidebar--nav-link"  href="/waf/reference/migration-guides/waf-managed-rules-migration/"   is-active>
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">WAF Managed Rules migration</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/reference/migration-guides/firewall-rules-to-custom-rules/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Firewall Rules to WAF custom rules migration</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/reference/migration-guides/old-rate-limiting-deprecation/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Rate limiting (previous version) deprecation</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Legacy features</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/reference/legacy/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Legacy features</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="2" style="--depth:2"><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: WAF managed rules (previous version)</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/reference/legacy/old-waf-managed-rules/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">WAF managed rules (previous version)</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="3" style="--depth:3"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/reference/legacy/old-waf-managed-rules/troubleshooting/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Troubleshooting</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button" tabindex="-1">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Rate Limiting (previous version)</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/reference/legacy/old-rate-limiting/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Rate Limiting (previous version)</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="3" style="--depth:3"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/reference/legacy/old-rate-limiting/troubleshooting/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Troubleshooting</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li></ul>
            </div>
          </div>
        </div>
      </div></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Troubleshooting</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/troubleshooting/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Troubleshooting</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="1" style="--depth:1"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/troubleshooting/blocked-bing-site-scans/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Bing&#39;s Site Scan blocked by a managed rule</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/troubleshooting/facebook-sharing/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Issues sharing to Facebook</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/troubleshooting/samesite-cookie-interaction/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">SameSite cookie interaction with Cloudflare</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/troubleshooting/faq/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">FAQ</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/glossary/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Glossary</span></a></li><li class="DocsSidebar--nav-item"><button class="Button DocsSidebar--nav-expand-collapse-button">
      <span class="DocsSidebar--nav-expand-collapse-button-content" aria-hidden="true"></span>
      <span is-visually-hidden>Expand: Changelog</span>
    </button><a class="DocsSidebar--nav-link"  href="/waf/change-log/"  >
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Changelog</span></a><div class="DocsSidebar--nav-item-collapse-container DocsSidebar--nav-item-collapse-hidden" style="min-height:0px;"><div class="DocsSidebar--nav-item-collapse-wrapper">
          <div class="DocsSidebar--nav-item-collapse-wrapperInner">
            <div class="DocsSidebar--nav-item-collapse-content">
              <ul class="DocsSidebar--nav-subnav" depth="1" style="--depth:1"><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/general-updates/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">General updates</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/scheduled-changes/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Scheduled changes</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-07-29/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-07-29</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-07-24/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-07-24</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-07-17/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-07-17</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-07-10/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-07-10</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-06-18---emergency-release/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-06-18 - Emergency</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-06-06---emergency-release/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-06-06 - Emergency</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-05-30---emergency-release/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-05-30 - Emergency</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-05-29---emergency-release/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-05-29 - Emergency</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-05-21/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-05-21</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-05-14/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-05-14</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-05-08/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-05-08</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-05-06/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-05-06</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-04-24/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-04-24</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-04-22/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-04-22</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-04-16---emergency-release/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-04-16 - Emergency</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-04-15/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-04-15</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-04-08/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-04-08</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-03-18/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-03-18</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-03-11/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-03-11</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-03-04/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-03-04</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-02-26/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-02-26</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-02-20/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-02-20</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-02-12/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-02-12</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-02-05/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-02-05</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-01-22---emergency-release/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-01-22 - Emergency</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-01-17---emergency-release/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-01-17 - Emergency</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-01-16/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-01-16</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/2024-01-04/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">2024-01-04</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/historical-2023/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Historical (2023)</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/historical-2022/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Historical (2022)</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/historical-2021/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Historical (2021)</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/historical-2020/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Historical (2020)</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/historical-2019/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Historical (2019)</span></a></li><li class="DocsSidebar--nav-item"><a class="DocsSidebar--nav-link"  href="/waf/change-log/historical-2018/"   tabindex="-1">
      <span class="DocsSidebar--nav-link-highlight"></span>
      <span class="DocsSidebar--nav-link-text">Historical (2018)</span></a></li></ul>
            </div>
          </div>
        </div>
      </div></li></ul>
      </div>
      <div style="position:absolute;height:6px;display:none;right:2px;bottom:2px;left:2px;border-radius:3px">
        <div style="position:relative;display:block;height:100%;cursor:pointer;border-radius:inherit;background-color:rgba(0,0,0,.2)"></div>
      </div>
      <div style="position:absolute;width:6px;display:none" class="Scrollbars--track Scrollbars--track-vertical">
        <div style="position:relative;display:block;width:100%" class="Scrollbars--thumb Scrollbars--thumb-vertical"></div>
      </div>
    </div>
  </div>
  <div class="DocsSidebar--shadow"></div>
</div><div class="DocsToolbar">

<div class="DocsToolbar--search">
  <div class="DocsSearch">
    <div id="algolia"></div>
  </div>
</div>
<div class="DocsToolbar--tools"><div class="Tooltip---root">
  <a class="DocsToolbar--feedback Button Button-is-docs-secondary" href="https://github.com/cloudflare/cloudflare-docs/blob/production/content/waf/reference/migration-guides/waf-managed-rules-migration.md" target="_blank">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64">
      <path d="M22.742 47.456L23.757 46.912L52.175 18.573V15.743L42.254 5.823H39.428L11.012 34.16L10.461 35.193L8.03899 47.614L10.399 49.957L22.742 47.456ZM14.27 36.56L40.84 10.06L47.932 17.152L21.358 43.652L12.538 45.439L14.27 36.56Z" fill="currentColor"/>
      <path d="M56.002 54H7.99799V58H56.002V54Z" fill="currentColor"/>
      </svg>Edit
  </a>
  <span class="Tooltip" role="tooltip" position="bottom-end">
    Edit this page
  </span>
</div>
  <div class="DocsToolbar--tools-spacer"></div>
  <div class="Tooltip---root">
  <a class="DocsToolbar--feedback Button Button-is-docs-secondary" href="https://github.com/cloudflare/cloudflare-docs/issues/new/choose" target="_blank">
    <svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 17">
      <path d="M14 2.5H2l-.5.5v11.165l.863.345 2.852-3.01H14l.5-.5V3l-.5-.5Zm-.5 8H4.785L2.5 12.911V3.5h11v7Z"
        fill="currentColor"></path>
      <path d="M12.5 5.003h-9v1h9v-1ZM12.5 7.5h-9v1h9v-1Z" fill="currentColor"></path>
    </svg>Issue
  </a>
  <span class="Tooltip" role="tooltip" position="bottom-end">
    Report an issue with this page
  </span>
  </div>

  <div class="DocsToolbar--tools-spacer"></div>
  <div class="Tooltip---root">
  <a class="DocsToolbar--feedback Button Button-is-docs-primary" href="https://dash.cloudflare.com/login" target="_blank">
    <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 64 64">
      <path d="M36.85 34.76H27.17C21.5587 34.7653 16.1786 36.996 12.2099 40.9629C8.24121 44.9297 6.00794 50.3087 6 55.92L8 57.92H56L58 55.92C57.9921 50.3122 55.7615 44.9362 51.7972 40.9699C47.8328 37.0037 42.4578 34.7706 36.85 34.76ZM10.12 53.92C10.6165 49.7453 12.6256 45.8972 15.7674 43.1037C18.9092 40.3102 22.9659 38.7648 27.17 38.76H36.85C41.0455 38.777 45.09 40.3278 48.2213 43.1202C51.3526 45.9126 53.3546 49.7538 53.85 53.92H10.12Z" fill="currentColor"/>
      <path d="M32.05 32C34.8189 32 37.5257 31.1789 39.828 29.6406C42.1303 28.1022 43.9247 25.9157 44.9843 23.3576C46.0439 20.7994 46.3212 17.9845 45.781 15.2687C45.2408 12.553 43.9074 10.0584 41.9495 8.10051C39.9916 6.14258 37.497 4.80921 34.7813 4.26901C32.0655 3.72882 29.2506 4.00607 26.6924 5.06569C24.1343 6.12532 21.9478 7.91973 20.4094 10.222C18.8711 12.5243 18.05 15.2311 18.05 18C18.05 21.713 19.525 25.274 22.1505 27.8995C24.776 30.525 28.337 32 32.05 32ZM32.05 8.00001C34.0278 8.00001 35.9612 8.5865 37.6057 9.68531C39.2502 10.7841 40.5319 12.3459 41.2888 14.1732C42.0457 16.0004 42.2437 18.0111 41.8579 19.9509C41.472 21.8907 40.5196 23.6725 39.1211 25.0711C37.7225 26.4696 35.9407 27.422 34.0009 27.8079C32.0611 28.1937 30.0504 27.9957 28.2232 27.2388C26.3959 26.4819 24.8341 25.2002 23.7353 23.5557C22.6365 21.9112 22.05 19.9778 22.05 18C22.05 15.3478 23.1036 12.8043 24.9789 10.9289C26.8543 9.05357 29.3978 8.00001 32.05 8.00001Z"  fill="currentColor"/>
      </svg>Log&nbsp;in
  </a>
  <span class="Tooltip" role="tooltip" position="bottom-end">
    Log into the Cloudflare dashboard
  </span>
  </div>
  

  <div class="DocsToolbar--tools-spacer"></div>

  <div class="DocsToolbar--theme-toggle">
    <button id="MobileSearch" onclick='document.querySelector(".DocSearch.DocSearch-Button").click()'>
      <svg viewBox="0 0 16 16" fill="currentColor" role="img" aria-labelledby="title-9701125841014673"
        xmlns="http://www.w3.org/2000/svg">
        <title id="title-9701125841014673">Search icon (depiction of a magnifying glass)</title>
        <path
          d="M11.999 10.585l3.458 3.458a1 1 0 01-1.414 1.414L10.585 12a6.5 6.5 0 111.414-1.414zM6.75 11.5a4.75 4.75 0 100-9.5 4.75 4.75 0 000 9.5z">
        </path>
      </svg>
    </button><div class="Tooltip---root">
  <div class="ThemeToggle">
    <input type="checkbox" id="ThemeToggle" class="ThemeToggle--input">

    <label class="ThemeToggle--toggle" for="ThemeToggle">
      <div class="ThemeToggle--toggle-handle"></div>

      <div class="ThemeToggle--toggle-handle-icon ThemeToggle--sun">
        <svg viewBox="0 0 16 16" fill="currentColor" role="img" aria-labelledby="title-8812071124069258"
          xmlns="http://www.w3.org/2000/svg">
          <title id="title-8812071124069258">Light theme icon (depiction of a sun)</title>
          <path
            d="M7.5 11.465a3.482 3.482 0 01-1.596-.662L4.11 12.596a.5.5 0 01-.707-.707l1.793-1.793A3.482 3.482 0 014.535 8.5H2a.5.5 0 010-1h2.535a3.482 3.482 0 01.662-1.596L3.404 4.11a.5.5 0 01.707-.707l1.793 1.793A3.482 3.482 0 017.5 4.535V2a.5.5 0 011 0v2.535a3.482 3.482 0 011.596.662l1.793-1.793a.5.5 0 01.707.707l-1.793 1.793c.343.458.577 1.003.662 1.596H14a.5.5 0 110 1h-2.535a3.482 3.482 0 01-.662 1.596l1.793 1.793a.5.5 0 01-.707.707l-1.793-1.793a3.482 3.482 0 01-1.596.662V14a.5.5 0 11-1 0v-2.535z">
          </path>
        </svg>
      </div>

      <div class="ThemeToggle--toggle-handle-icon ThemeToggle--moon">
        <svg viewBox="0 0 16 16" fill="currentColor" role="img" aria-labelledby="title-5971296394189265"
          xmlns="http://www.w3.org/2000/svg">
          <title id="title-5971296394189265">Dark theme icon (depiction of a moon)</title>
          <path d="M7.067 3.087a5 5 0 005.466 7.026 5 5 0 11-5.466-7.026z"></path>
        </svg>
      </div>
    </label>

    <span class="Tooltip" id="ThemeToggle--tooltip" role="tooltip" position="bottom-end">Set theme to dark (⇧+D)</span>
  </div>
</div></div>
</div>
</div>

    <main class="DocsBody"><div class="DocsBody--sidebar" with-styled-webkit-scrollbars="">
  <div class="DocsBody--sidebar-content-scroll-fade"></div>
  <div class="DocsBody--sidebar-content">
      <ul class="DocsTableOfContents" hidden>
        <li><a class="DocsTableOfContents-link" href="#docs-content">↑ Top</a></li>
      </ul>
  </div>
</div>
<div id="docs-content" data-reach-skip-nav-content></div>
<ol class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a href="/products/" class="DocsMarkdown--link" itemprop="item">
        <span itemprop="name" class="DocsMarkdown--link-content">Products</span></a>
      <meta itemprop="position" content="1" />
    </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/waf/" itemprop="item" class="DocsMarkdown--link" >
            <span class="DocsMarkdown--link-content"  itemprop="name" >WAF</span></a><meta itemprop="position" content="2" />
        </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/waf/reference/" itemprop="item" class="DocsMarkdown--link" aria-label="Reference" title="Reference">
            <span class="DocsMarkdown--link-content" >...</span></a><meta itemprop="name" content="Reference" /><meta itemprop="position" content="3" />
        </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/waf/reference/migration-guides/" itemprop="item" class="DocsMarkdown--link" >
            <span class="DocsMarkdown--link-content"  itemprop="name" >Migration guides</span></a><meta itemprop="position" content="4" />
        </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/waf/reference/migration-guides/waf-managed-rules-migration/" itemprop="item" class="DocsMarkdown--link" >
            <span class="DocsMarkdown--link-content"  itemprop="name" >WAF Managed Rules migration</span></a><meta itemprop="position" content="5" />
        </li></ol><div class="DocsContent" id="main" page-type="document">

        <article class="DocsMarkdown">
  <h1 id="waf-managed-rules-migration">WAF Managed Rules migration</h1><p>On 2022-05-04, Cloudflare started the WAF migration from the <a href=/waf/reference/legacy/old-waf-managed-rules/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">previous version of WAF managed rules</span></a> to the new <a href=/waf/managed-rules/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">WAF Managed Rules</span></a>, allowing a first set of eligible zones to migrate. Currently, all zones can migrate to WAF Managed Rules, including partner accounts.</p>
<p>You can start the update process for a zone in the Cloudflare dashboard or via API. Currently, the update process is always started by you. <strong>The migration is irreversible</strong> — once you update to the new WAF Managed Rules, you cannot go back to using WAF managed rules.</p>
<p>Once the migration finishes, the <strong>Managed rules</strong> tab in the Cloudflare dashboard (available in <strong>Security</strong> &gt; <strong>WAF</strong> &gt; <strong>Managed rules</strong>) will display a new interface, and the WAF managed rules APIs will stop working.</p>
<aside class="DocsMarkdown--aside" role="note" data-type="warning">
    <div class="DocsMarkdown--aside-header">Deprecation notice</div><p><strong>The previous version of WAF managed rules is now deprecated.</strong> The <a href=#api-changes class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">APIs for managing the previous version of WAF managed rules</span></a> will stop working on 2025-01-15. The same applies to <a href=#terraform-changes class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Terraform resources</span></a> related to the previous version of WAF managed rules. You must migrate before this date to avoid any issues.</p>
<p>Refer to <a href=#possible-migration-errors class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Possible migration errors</span></a> if you are having issues migrating.</p>
</aside>

<h2 id="main-benefits">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#main-benefits">&#8203;​</a>
    </span>
    <span>Main benefits</span>
  </h2><p>The new version of WAF Managed Rules provides the following benefits over the previous version:</p>
<ul>
<li>
<p><strong>New matching engine</strong> – WAF Managed Rules are powered by the Ruleset Engine, which allows faster managed rule deployments and the ability to check even more traffic without scaling issues. The rules follow the same syntax used in other Cloudflare security products like WAF custom rules.</p>
</li>
<li>
<p><strong>Updated Managed Rulesets</strong> – The Cloudflare OWASP Core Ruleset, one of WAF&rsquo;s Managed Rulesets, is based on the latest version of the OWASP Core Ruleset (v3.x), which adds <span tabindex="0" class='glossary-tooltip' data-title='Classifies rules of the OWASP managed ruleset according to their aggressiveness.' data-toggle='tooltip' data-placement='top' aria-label='paranoia levels'>paranoia levels</span> and improves false positives rates compared to the version used in WAF managed rules (2.x). You also have more control over the sensitivity score, with a clear indication of how much each rule contributes to the score and what was the total score of a triggered request.</p>
</li>
<li>
<p><strong>Better rule browsing and configuration</strong> – Deploy Managed Rulesets with a single click to get immediate protection. Override the behavior of entire rulesets, or customize a single rule. Apply overrides to all rules with a specific tag to adjust rules applicable to a given software or attack vector. You can deploy configurations like the following:</p>
<ul>
<li>Deploy the Cloudflare Managed Ruleset across all my zones.</li>
<li>Deploy the Cloudflare OWASP Core Ruleset on all traffic that does not contain <code>/api/*</code> in the path.</li>
<li>Disable Managed Rulesets across my account for traffic coming from my IP.</li>
</ul>
</li>
</ul>
<p>For more information on the benefits of WAF Managed Rules, refer to our <a href="https://blog.cloudflare.com/new-cloudflare-waf/" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">blog post</span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a>.</p>
<hr>
<h2 id="migration-impact">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#migration-impact">&#8203;​</a>
    </span>
    <span>Migration impact</span>
  </h2><p>You will be able to migrate all your zones that do not have URI-based WAF overrides. The same protection will apply to your zone once you move to the new WAF.</p>
<p>Most configuration settings from the previous version of WAF managed rules will be migrated to the new version, but some specific configurations originally defined in the OWASP ModSecurity Core Rule Set will be lost — you will have to create these configurations in the new WAF Managed Rules, if needed.</p>
<p>For API users, the APIs for managing the previous version of WAF managed rules will stop working once you migrate. You must use the Rulesets API to manage the new WAF Managed Rules.</p>
<h3 id="configurations-that-will-be-migrated">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#configurations-that-will-be-migrated">&#8203;​</a>
    </span>
    <span>Configurations that will be migrated</span>
  </h3><p>The update process will create an equivalent configuration for the following settings of WAF managed rules:</p>
<ul>
<li>Firewall rules configured with <em>Bypass</em> &gt; <em>WAF Managed Rules</em>.</li>
<li>Page Rules configured with <em>Disable Security</em>.</li>
<li>Page Rules configured with <em>Web Application Firewall: Off</em> or <em>Web Application Firewall: On</em>.</li>
</ul>
<p>The OWASP ruleset configuration will be partially migrated. Refer to the next section for details.</p>
<h3 id="configurations-that-will-be-lost-in-the-update-process">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#configurations-that-will-be-lost-in-the-update-process">&#8203;​</a>
    </span>
    <span>Configurations that will be lost in the update process</span>
  </h3><p>The update process will partially migrate the settings of the OWASP ModSecurity Core Rule Set available in the previous version of WAF managed rules.</p>
<p>The following OWASP settings will be migrated:</p>
<ul>
<li>
<p><strong>Sensitivity</strong>: The <a href=/waf/reference/legacy/old-waf-managed-rules/#owasp-modsecurity-core-rule-set class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">old sensitivity values</span></a> will be migrated to the following <a href=/waf/managed-rules/reference/owasp-core-ruleset/concepts/#paranoia-level class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">paranoia level</span></a> (PL) and <a href=/waf/managed-rules/reference/owasp-core-ruleset/concepts/#score-threshold class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">score threshold</span></a> combinations in the new OWASP ruleset:</p>
<table>
<thead>
<tr>
<th>Old sensitivity</th>
<th>PL in new OWASP</th>
<th>Score threshold in new OWASP</th>
</tr>
</thead>
<tbody>
<tr>
<td>High</td>
<td>PL2</td>
<td>Medium – 40 or higher</td>
</tr>
<tr>
<td>Medium</td>
<td>PL1</td>
<td>High – 25 or higher</td>
</tr>
<tr>
<td>Low</td>
<td>PL1</td>
<td>Medium – 40 or higher</td>
</tr>
<tr>
<td>Default</td>
<td>PL2</td>
<td>Medium – 40 or higher</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Action</strong>: The action in the previous OWASP ruleset has an almost direct mapping in the new OWASP managed ruleset, except for the <em>Simulate</em> action which will be migrated to <em>Log</em>.</p>
</li>
</ul>
<p>The following OWASP settings will <strong>not</strong> be migrated, since there is no direct equivalence between rules in the two versions:</p>
<ul>
<li>OWASP group overrides</li>
<li>OWASP rule overrides</li>
</ul>
<p>To replace these settings you will need to configure the Cloudflare OWASP Core Ruleset in WAF Managed Rules again according to your needs, namely any tag/rule overrides. For more information on configuring the new OWASP Core Ruleset, refer to <a href=/waf/managed-rules/reference/owasp-core-ruleset/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Cloudflare OWASP Core Ruleset</span></a>.</p>
<h3 id="configurations-that-will-prevent-you-from-updating">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#configurations-that-will-prevent-you-from-updating">&#8203;​</a>
    </span>
    <span>Configurations that will prevent you from updating</span>
  </h3><p>If a zone has <a href="/api/operations/waf-overrides-list-waf-overrides" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">URI-based WAF overrides</span><span class="DocsMarkdown--link-api-icon" aria-hidden="true">
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="23px" height="12px" viewBox="0 0 23 12" version="1.1">
    <title>API link label</title>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Group">
            <rect id="Rectangle" fill="#e06d10" x="0" y="0" width="23" height="12" rx="2"/>
            <path d="M8.12890625,10 L9.58984375,10 L6.83984375,2.24951172 L5.27685547,2.24951172 L2.52685547,10 L3.95556641,10 L4.61621094,7.99658203 L7.46826172,7.99658203 L8.12890625,10 Z M6.0234375,3.61914062 L6.06103516,3.61914062 L7.140625,6.92773438 L4.93847656,6.92773438 L6.0234375,3.61914062 Z M10.9169922,2.24951172 L10.9169922,10 L12.3027344,10 L12.3027344,7.43798828 L13.8710938,7.43798828 C15.4394531,7.43798828 16.5405273,6.390625 16.5405273,4.84375 C16.5405273,3.296875 15.4716797,2.24951172 13.9301758,2.24951172 L10.9169922,2.24951172 Z M12.3027344,3.3828125 L13.5649414,3.3828125 C14.5585938,3.3828125 15.1333008,3.91455078 15.1333008,4.84375 C15.1333008,5.78369141 14.5532227,6.32080078 13.5595703,6.32080078 L12.3027344,6.32080078 L12.3027344,3.3828125 Z M19.4360352,10 L18.050293,10 L18.050293,2.24951172 L19.4360352,2.24951172 L19.4360352,10 Z" id="API" fill="#FFFFFF" fill-rule="nonzero"/>
        </g>
    </g>
</svg>
  <span is-visually-hidden>Open API docs link</span>
</span></a> (only available via API), you will not have the option to migrate to WAF Managed Rules. To update to WAF Managed Rules you must:</p>
<ol>
<li>Delete any existing URI-based WAF overrides using the <a href="/api/operations/waf-overrides-delete-a-waf-override" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">Delete a WAF override</span><span class="DocsMarkdown--link-api-icon" aria-hidden="true">
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="23px" height="12px" viewBox="0 0 23 12" version="1.1">
    <title>API link label</title>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Group">
            <rect id="Rectangle" fill="#e06d10" x="0" y="0" width="23" height="12" rx="2"/>
            <path d="M8.12890625,10 L9.58984375,10 L6.83984375,2.24951172 L5.27685547,2.24951172 L2.52685547,10 L3.95556641,10 L4.61621094,7.99658203 L7.46826172,7.99658203 L8.12890625,10 Z M6.0234375,3.61914062 L6.06103516,3.61914062 L7.140625,6.92773438 L4.93847656,6.92773438 L6.0234375,3.61914062 Z M10.9169922,2.24951172 L10.9169922,10 L12.3027344,10 L12.3027344,7.43798828 L13.8710938,7.43798828 C15.4394531,7.43798828 16.5405273,6.390625 16.5405273,4.84375 C16.5405273,3.296875 15.4716797,2.24951172 13.9301758,2.24951172 L10.9169922,2.24951172 Z M12.3027344,3.3828125 L13.5649414,3.3828125 C14.5585938,3.3828125 15.1333008,3.91455078 15.1333008,4.84375 C15.1333008,5.78369141 14.5532227,6.32080078 13.5595703,6.32080078 L12.3027344,6.32080078 L12.3027344,3.3828125 Z M19.4360352,10 L18.050293,10 L18.050293,2.24951172 L19.4360352,2.24951172 L19.4360352,10 Z" id="API" fill="#FFFFFF" fill-rule="nonzero"/>
        </g>
    </g>
</svg>
  <span is-visually-hidden>Open API docs link</span>
</span></a> operation.</li>
<li>Follow the update process described below.</li>
</ol>
<h3 id="cloudflare-dashboard-changes">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#cloudflare-dashboard-changes">&#8203;​</a>
    </span>
    <span>Cloudflare dashboard changes</span>
  </h3><p>After the update process is complete, the Cloudflare dashboard will display the new WAF Managed Rules interface in <strong>Security</strong> &gt; <strong>WAF</strong> &gt; <strong>Managed rules</strong>, where you can deploy managed rulesets and adjust their configuration.</p>
<p><figure class="image-caption">
    <img alt="After migrating to WAF Managed Rules, the Cloudflare dashboard will display a new interface where you can deploy managed rulesets to your zone." src="/images/waf/reference/waf-migration-dashboard-differences_huf0eb1c82957dc9705d8edaefd7210a6e_151266_1350x419_resize_q75_box_3.png" loading="lazy" class="image-figure lightbox"
    height="419" width="1350"
    style="aspect-ratio:3.221980906921241;height: auto;"/>
    <figcaption></figcaption>
</figure></p>
<p>Unlike the WAF managed rules, there is no global on/off setting to enable the WAF in the new interface. Instead, you deploy each managed ruleset individually in your zone.</p>
<p>For more information about configuring WAF Managed Rules in the dashboard, refer to <a href=/waf/managed-rules/deploy-zone-dashboard/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Deploy Managed Rulesets for a zone in the dashboard</span></a>.</p>
<h3 id="api-changes">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#api-changes">&#8203;​</a>
    </span>
    <span>API changes</span>
  </h3><p>Once the migration is complete, the APIs for interacting with WAF managed rules <strong>will stop working</strong>. These APIs are the following:</p>
<ul>
<li><a href="/api/operations/waf-packages-list-waf-packages" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">WAF packages</span><span class="DocsMarkdown--link-api-icon" aria-hidden="true">
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="23px" height="12px" viewBox="0 0 23 12" version="1.1">
    <title>API link label</title>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Group">
            <rect id="Rectangle" fill="#e06d10" x="0" y="0" width="23" height="12" rx="2"/>
            <path d="M8.12890625,10 L9.58984375,10 L6.83984375,2.24951172 L5.27685547,2.24951172 L2.52685547,10 L3.95556641,10 L4.61621094,7.99658203 L7.46826172,7.99658203 L8.12890625,10 Z M6.0234375,3.61914062 L6.06103516,3.61914062 L7.140625,6.92773438 L4.93847656,6.92773438 L6.0234375,3.61914062 Z M10.9169922,2.24951172 L10.9169922,10 L12.3027344,10 L12.3027344,7.43798828 L13.8710938,7.43798828 C15.4394531,7.43798828 16.5405273,6.390625 16.5405273,4.84375 C16.5405273,3.296875 15.4716797,2.24951172 13.9301758,2.24951172 L10.9169922,2.24951172 Z M12.3027344,3.3828125 L13.5649414,3.3828125 C14.5585938,3.3828125 15.1333008,3.91455078 15.1333008,4.84375 C15.1333008,5.78369141 14.5532227,6.32080078 13.5595703,6.32080078 L12.3027344,6.32080078 L12.3027344,3.3828125 Z M19.4360352,10 L18.050293,10 L18.050293,2.24951172 L19.4360352,2.24951172 L19.4360352,10 Z" id="API" fill="#FFFFFF" fill-rule="nonzero"/>
        </g>
    </g>
</svg>
  <span is-visually-hidden>Open API docs link</span>
</span></a></li>
<li><a href="/api/operations/waf-rule-groups-list-waf-rule-groups" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">WAF rule groups</span><span class="DocsMarkdown--link-api-icon" aria-hidden="true">
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="23px" height="12px" viewBox="0 0 23 12" version="1.1">
    <title>API link label</title>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Group">
            <rect id="Rectangle" fill="#e06d10" x="0" y="0" width="23" height="12" rx="2"/>
            <path d="M8.12890625,10 L9.58984375,10 L6.83984375,2.24951172 L5.27685547,2.24951172 L2.52685547,10 L3.95556641,10 L4.61621094,7.99658203 L7.46826172,7.99658203 L8.12890625,10 Z M6.0234375,3.61914062 L6.06103516,3.61914062 L7.140625,6.92773438 L4.93847656,6.92773438 L6.0234375,3.61914062 Z M10.9169922,2.24951172 L10.9169922,10 L12.3027344,10 L12.3027344,7.43798828 L13.8710938,7.43798828 C15.4394531,7.43798828 16.5405273,6.390625 16.5405273,4.84375 C16.5405273,3.296875 15.4716797,2.24951172 13.9301758,2.24951172 L10.9169922,2.24951172 Z M12.3027344,3.3828125 L13.5649414,3.3828125 C14.5585938,3.3828125 15.1333008,3.91455078 15.1333008,4.84375 C15.1333008,5.78369141 14.5532227,6.32080078 13.5595703,6.32080078 L12.3027344,6.32080078 L12.3027344,3.3828125 Z M19.4360352,10 L18.050293,10 L18.050293,2.24951172 L19.4360352,2.24951172 L19.4360352,10 Z" id="API" fill="#FFFFFF" fill-rule="nonzero"/>
        </g>
    </g>
</svg>
  <span is-visually-hidden>Open API docs link</span>
</span></a></li>
<li><a href="/api/operations/waf-rules-list-waf-rules" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">WAF rules</span><span class="DocsMarkdown--link-api-icon" aria-hidden="true">
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="23px" height="12px" viewBox="0 0 23 12" version="1.1">
    <title>API link label</title>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Group">
            <rect id="Rectangle" fill="#e06d10" x="0" y="0" width="23" height="12" rx="2"/>
            <path d="M8.12890625,10 L9.58984375,10 L6.83984375,2.24951172 L5.27685547,2.24951172 L2.52685547,10 L3.95556641,10 L4.61621094,7.99658203 L7.46826172,7.99658203 L8.12890625,10 Z M6.0234375,3.61914062 L6.06103516,3.61914062 L7.140625,6.92773438 L4.93847656,6.92773438 L6.0234375,3.61914062 Z M10.9169922,2.24951172 L10.9169922,10 L12.3027344,10 L12.3027344,7.43798828 L13.8710938,7.43798828 C15.4394531,7.43798828 16.5405273,6.390625 16.5405273,4.84375 C16.5405273,3.296875 15.4716797,2.24951172 13.9301758,2.24951172 L10.9169922,2.24951172 Z M12.3027344,3.3828125 L13.5649414,3.3828125 C14.5585938,3.3828125 15.1333008,3.91455078 15.1333008,4.84375 C15.1333008,5.78369141 14.5532227,6.32080078 13.5595703,6.32080078 L12.3027344,6.32080078 L12.3027344,3.3828125 Z M19.4360352,10 L18.050293,10 L18.050293,2.24951172 L19.4360352,2.24951172 L19.4360352,10 Z" id="API" fill="#FFFFFF" fill-rule="nonzero"/>
        </g>
    </g>
</svg>
  <span is-visually-hidden>Open API docs link</span>
</span></a></li>
</ul>
<aside class="DocsMarkdown--aside" role="note" data-type="warning"><p>If you have any integrations using the WAF managed rules APIs stated above, you must update them before migrating to the new WAF Managed Rules.</p>
</aside>

<p>To work with WAF Managed Rules you must use the <a href=/ruleset-engine/managed-rulesets/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Rulesets API</span></a>. For more information on deploying WAF Managed Rules via API, refer to <a href=/waf/managed-rules/deploy-api/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Deploy managed rulesets via API</span></a>.</p>
<h3 id="terraform-changes">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#terraform-changes">&#8203;​</a>
    </span>
    <span>Terraform changes</span>
  </h3><p>Once the migration is complete, the following Terraform resources for configuring WAF managed rules <strong>will stop working</strong>:</p>
<ul>
<li><a href="https://registry.terraform.io/providers/cloudflare/cloudflare/3.35.0/docs/resources/waf_package" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content"><code>cloudflare_waf_package</code></span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a></li>
<li><a href="https://registry.terraform.io/providers/cloudflare/cloudflare/3.35.0/docs/resources/waf_group" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content"><code>cloudflare_waf_group</code></span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a></li>
<li><a href="https://registry.terraform.io/providers/cloudflare/cloudflare/3.35.0/docs/resources/waf_rule" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content"><code>cloudflare_waf_rule</code></span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a></li>
</ul>
<p>These resources were only supported in the Terraform Cloudflare provider up to version 3.35. Version 4.x <a href="https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/guides/version-4-upgrade#resources-1" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">no longer supports these resources</span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a>.</p>
<p>To manage the configuration of the new WAF Managed Rules using Terraform, you must use <a href="https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/ruleset" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content"><code>cloudflare_ruleset</code></span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a> resources.</p>
<hr>
<h2 id="eligible-zones">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#eligible-zones">&#8203;​</a>
    </span>
    <span>Eligible zones</span>
  </h2><h3 id="phase-2-since-2022-09-19">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#phase-2-since-2022-09-19">&#8203;​</a>
    </span>
    <span>Phase 2 (since 2022-09-19)</span>
  </h3><aside class="DocsMarkdown--aside" role="note" data-type="note">
    <div class="DocsMarkdown--aside-header">Update notice</div><p>On 2023-08-18, Cloudflare added support for migrating partner accounts to the new WAF Managed Rules.</p>
</aside>

<p>In phase 2 all zones are eligible for migration. The exact migration procedure varies according to your Cloudflare plan.</p>
<ul>
<li>
<p><strong>Pro</strong> and <strong>Business</strong> customers can update to the new WAF Managed Rules in the Cloudflare dashboard or via API. Once the new version is enabled, the previous version of WAF managed rules will be automatically disabled.</p>
</li>
<li>
<p><strong>Enterprise</strong> customers can enable the new WAF Managed Rules configuration while keeping the previous version of WAF managed rules enabled, allowing them to check the impact of the new WAF configuration. After reviewing the behavior of the new configuration and making any required adjustments to specific managed rules, Enterprise users can then finish the migration, which will disable the previous version of WAF managed rules.</p>
</li>
</ul>
<p><strong>Note:</strong> Zones that have <a href="/api/operations/waf-overrides-list-waf-overrides" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">URI-based WAF overrides</span><span class="DocsMarkdown--link-api-icon" aria-hidden="true">
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="23px" height="12px" viewBox="0 0 23 12" version="1.1">
    <title>API link label</title>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Group">
            <rect id="Rectangle" fill="#e06d10" x="0" y="0" width="23" height="12" rx="2"/>
            <path d="M8.12890625,10 L9.58984375,10 L6.83984375,2.24951172 L5.27685547,2.24951172 L2.52685547,10 L3.95556641,10 L4.61621094,7.99658203 L7.46826172,7.99658203 L8.12890625,10 Z M6.0234375,3.61914062 L6.06103516,3.61914062 L7.140625,6.92773438 L4.93847656,6.92773438 L6.0234375,3.61914062 Z M10.9169922,2.24951172 L10.9169922,10 L12.3027344,10 L12.3027344,7.43798828 L13.8710938,7.43798828 C15.4394531,7.43798828 16.5405273,6.390625 16.5405273,4.84375 C16.5405273,3.296875 15.4716797,2.24951172 13.9301758,2.24951172 L10.9169922,2.24951172 Z M12.3027344,3.3828125 L13.5649414,3.3828125 C14.5585938,3.3828125 15.1333008,3.91455078 15.1333008,4.84375 C15.1333008,5.78369141 14.5532227,6.32080078 13.5595703,6.32080078 L12.3027344,6.32080078 L12.3027344,3.3828125 Z M19.4360352,10 L18.050293,10 L18.050293,2.24951172 L19.4360352,2.24951172 L19.4360352,10 Z" id="API" fill="#FFFFFF" fill-rule="nonzero"/>
        </g>
    </g>
</svg>
  <span is-visually-hidden>Open API docs link</span>
</span></a>, which you could only manage via API, will not be able to migrate immediately to the new WAF Managed Rules. You must delete these overrides before migrating.</p>
<h3 id="phase-1-since-2022-05-04">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#phase-1-since-2022-05-04">&#8203;​</a>
    </span>
    <span>Phase 1 (since 2022-05-04)</span>
  </h3><p>In phase 1 the migration became available to a subset of eligible zones, which had to meet the following requirements:</p>
<ul>
<li>
<p>The zone has:</p>
<ul>
<li>WAF disabled, or</li>
<li>WAF enabled and only the Cloudflare Managed Ruleset is enabled (the OWASP ModSecurity Core Rule Set must be disabled).</li>
</ul>
</li>
<li>
<p>The zone has no <a href=/firewall/cf-dashboard/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">firewall rules</span></a> or <a href=/rules/page-rules/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Page Rules</span></a> bypassing, enabling, or disabling WAF managed rules:</p>
<ul>
<li>Firewall rules configured with <em>Bypass</em> &gt; <em>WAF Managed Rules</em>.</li>
<li>Page Rules configured with <em>Disable Security</em>.</li>
<li>Page Rules configured with <em>Web Application Firewall: Off</em> or <em>Web Application Firewall: On.</em></li>
</ul>
</li>
<li>
<p>The zone has no <a href="/api/operations/waf-overrides-list-waf-overrides" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">URI-based WAF overrides</span><span class="DocsMarkdown--link-api-icon" aria-hidden="true">
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="23px" height="12px" viewBox="0 0 23 12" version="1.1">
    <title>API link label</title>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Group">
            <rect id="Rectangle" fill="#e06d10" x="0" y="0" width="23" height="12" rx="2"/>
            <path d="M8.12890625,10 L9.58984375,10 L6.83984375,2.24951172 L5.27685547,2.24951172 L2.52685547,10 L3.95556641,10 L4.61621094,7.99658203 L7.46826172,7.99658203 L8.12890625,10 Z M6.0234375,3.61914062 L6.06103516,3.61914062 L7.140625,6.92773438 L4.93847656,6.92773438 L6.0234375,3.61914062 Z M10.9169922,2.24951172 L10.9169922,10 L12.3027344,10 L12.3027344,7.43798828 L13.8710938,7.43798828 C15.4394531,7.43798828 16.5405273,6.390625 16.5405273,4.84375 C16.5405273,3.296875 15.4716797,2.24951172 13.9301758,2.24951172 L10.9169922,2.24951172 Z M12.3027344,3.3828125 L13.5649414,3.3828125 C14.5585938,3.3828125 15.1333008,3.91455078 15.1333008,4.84375 C15.1333008,5.78369141 14.5532227,6.32080078 13.5595703,6.32080078 L12.3027344,6.32080078 L12.3027344,3.3828125 Z M19.4360352,10 L18.050293,10 L18.050293,2.24951172 L19.4360352,2.24951172 L19.4360352,10 Z" id="API" fill="#FFFFFF" fill-rule="nonzero"/>
        </g>
    </g>
</svg>
  <span is-visually-hidden>Open API docs link</span>
</span></a> (only available via API).</p>
</li>
</ul>
<hr>
<h2 id="starting-the-migration">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#starting-the-migration">&#8203;​</a>
    </span>
    <span>Starting the migration</span>
  </h2><p>You can start the WAF update in the Cloudflare dashboard or via API.</p>
<h3 id="using-the-dashboard">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#using-the-dashboard">&#8203;​</a>
    </span>
    <span>Using the dashboard</span>
  </h3><ol>
<li>
<p>Log in to the <a href="https://dash.cloudflare.com/" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">Cloudflare dashboard</span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a>, and select your account and zone.</p>
</li>
<li>
<p>Go to <strong>Security</strong> &gt; <strong>WAF</strong> &gt; <strong>Managed rules</strong>.</p>
<p>If you are an Enterprise customer, the dashboard will show the following banner:</p>
<p><figure class="image-caption">
    <img alt="The migration banner displayed to Enterprise customers in WAF &amp;gt; Managed rules." src="/images/waf/reference/waf-migration-ent-banner_huec3c6a9632858a89bd3cef1a21c0709c_28729_1159x292_resize_q75_box_3.png" loading="lazy" class="image-figure lightbox"
    height="292" width="1159"
    style="aspect-ratio:3.969212328767123;height: auto;"/>
    <figcaption></figcaption>
</figure></p>
<p>If you are a Professional/Business customer, the dashboard will show the following banner:</p>
<p><figure class="image-caption">
    <img alt="The migration banner displayed to Pro/Business customers in WAF &amp;gt; Managed rules." src="/images/waf/reference/waf-migration-biz-banner_huf73962954cff84adb1ce9fe776725e6b_27685_1168x330_resize_q75_box_3.png" loading="lazy" class="image-figure lightbox"
    height="330" width="1168"
    style="aspect-ratio:3.5394242424242424;height: auto;"/>
    <figcaption></figcaption>
</figure></p>
</li>
<li>
<p>In the update banner, select <strong>Review configuration</strong>. This banner is only displayed in eligible zones.</p>
</li>
<li>
<p>Review the proposed WAF configuration rules. You can make adjustments to the proposed configuration, like <a href=/waf/managed-rules/deploy-zone-dashboard/#configure-a-managed-ruleset class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">editing the WAF Managed Rules configuration</span></a> or creating <a href=/waf/managed-rules/waf-exceptions/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">exceptions</span></a> to skip the execution of rulesets or specific rules.</p>
</li>
<li>
<p>When you are done reviewing, select <strong>Deploy</strong> to deploy the new WAF Managed Rules configuration.</p>
<p>If you are a Professional/Business customer, Cloudflare will deploy the new WAF configuration and then disable the previous WAF version. The migration process may take a couple of minutes. When the migration finishes, the dashboard will display the new WAF Managed Rules interface in <strong>Security</strong> &gt; <strong>WAF</strong> &gt; <strong>Managed rules</strong>. To check if the migration has finished, refresh the dashboard.</p>
<p>If you are an Enterprise customer, both WAF implementations will be enabled simultaneously when you select Deploy, so that you can validate your new configuration. Refer to the steps in the next section for additional guidance.</p>
</li>
</ol>
<h4 id="validate-your-new-waf-configuration-and-finish-the-upgrade-enterprise-customers-only">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#validate-your-new-waf-configuration-and-finish-the-upgrade-enterprise-customers-only">&#8203;​</a>
    </span>
    <span>Validate your new WAF configuration and finish the upgrade (Enterprise customers only)</span>
  </h4><p>If you are an Enterprise customer, after deploying your new WAF configuration both WAF implementations will be enabled simultaneously. During this stage (called validation mode), the Cloudflare dashboard will display both WAF Managed Rules, old and new, in the <strong>Managed rules</strong> tab. The new WAF Managed Rules will run before the previous version.</p>
<ol>
<li>
<p>Use the current validation mode to check the behavior of the new WAF configuration in Security Events (<strong>Security</strong> &gt; <strong>Events</strong>). For more information, refer to <a href=#analyzing-the-new-waf-behavior-in-security-events class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Analyzing the new WAF behavior in Security Events</span></a>.</p>
</li>
<li>
<p>When you are done reviewing your configuration with both WAFs enabled, select <strong>Ready to update</strong> in the update banner, and then select <strong>Turn off previous version</strong>. This operation will complete the migration and disable the previous WAF version.</p>
</li>
</ol>
<p>When the migration finishes, the dashboard will only display the new WAF Managed Rules interface in <strong>Security</strong> &gt; <strong>WAF</strong> &gt; <strong>Managed rules</strong>. To check if the migration has finished, refresh the dashboard.</p>
<aside class="DocsMarkdown--aside" role="note" data-type="note"><p>The update process can take up to an hour. During this period you may observe security events from both versions of WAF managed rules.</p>
</aside>

<h3 id="using-the-api">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#using-the-api">&#8203;​</a>
    </span>
    <span>Using the API</span>
  </h3><ol>
<li>
<p>Use the <a href=#api-operations class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Check WAF update compatibility</span></a> operation to determine if the zone can update to the new WAF, given its current configuration:</p>
<div class="code-container">
    <unparsed-codeblock data-language="bash" data-code="curl&#43;%22https%3A%2F%2Fapi.cloudflare.com%2Fclient%2Fv4%2Fzones%2F%7Bzone_id%7D%2Fwaf_migration%2Fcheck%3Fphase_two%3D1%22&#43;%5C%0A--header&#43;%22Authorization%3A&#43;Bearer&#43;%3CAPI_TOKEN%3E%22"></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div><p>Example response:</p>
<div class="code-container">
    <unparsed-codeblock data-language="json" data-code="---%0Ahighlight%3A&#43;3%0A---%0A%7B%0A&#43;&#43;%22result%22%3A&#43;%7B%0A&#43;&#43;&#43;&#43;%22compatible%22%3A&#43;true%2C%0A&#43;&#43;&#43;&#43;%22migration_state%22%3A&#43;%22start%22%0A&#43;&#43;%7D%2C%0A&#43;&#43;%22success%22%3A&#43;true%2C%0A&#43;&#43;%22errors%22%3A&#43;%5B%5D%2C%0A&#43;&#43;%22messages%22%3A&#43;%5B%5D%0A%7D"></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div><p>If the response includes <code>&quot;compatible&quot;: true</code>, this means that the zone can update to the new WAF and you can proceed with the update process. If the response includes <code>&quot;compatible&quot;: false</code>, this means that your zone is not eligible for the update, given its current configuration. Refer to <a href=#eligible-zones class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Eligible zones</span></a> for details.</p>
</li>
<li>
<p>To get the new WAF configuration corresponding to your current configuration, use the <a href=#api-operations class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Get new WAF configuration</span></a> operation:</p>
<div class="code-container">
    <unparsed-codeblock data-language="bash" data-code="curl&#43;%22https%3A%2F%2Fapi.cloudflare.com%2Fclient%2Fv4%2Fzones%2F%7Bzone_id%7D%2Fwaf_migration%2Fconfig%3Fphase_two%3D1%22&#43;%5C%0A--header&#43;%22Authorization%3A&#43;Bearer&#43;%3CAPI_TOKEN%3E%22"></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div><p>Example response:</p>
<div class="code-container">
    <unparsed-codeblock data-language="json" data-code="%7B%0A&#43;&#43;%22result%22%3A&#43;%7B%0A&#43;&#43;&#43;&#43;%22name%22%3A&#43;%22default%22%2C%0A&#43;&#43;&#43;&#43;%22rules%22%3A&#43;%5B%0A&#43;&#43;&#43;&#43;&#43;&#43;%7B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22id%22%3A&#43;%22%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22version%22%3A&#43;%22%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22action%22%3A&#43;%22execute%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22expression%22%3A&#43;%22true%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22description%22%3A&#43;%22%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22ref%22%3A&#43;%22%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22enabled%22%3A&#43;true%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22action_parameters%22%3A&#43;%7B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22id%22%3A&#43;%22efb7b8c949ac4650a09736fc376e9aee%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22overrides%22%3A&#43;%7B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22rules%22%3A&#43;%5B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%7B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22id%22%3A&#43;%2223ee7cebe6e8443e99ecf932ab579455%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22action%22%3A&#43;%22log%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22enabled%22%3A&#43;false%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%7D%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%5D%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%7D%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%7D%0A&#43;&#43;&#43;&#43;&#43;&#43;%7D%0A&#43;&#43;&#43;&#43;%5D%0A&#43;&#43;%7D%2C%0A&#43;&#43;%22success%22%3A&#43;true%2C%0A&#43;&#43;%22errors%22%3A&#43;%5B%5D%2C%0A&#43;&#43;%22messages%22%3A&#43;%5B%5D%0A%7D"></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div></li>
</ol>
<p>The returned configuration in the example above, which would match the existing configuration for the previous WAF version, contains:</p>
<ul>
<li>A rule that executes the Cloudflare Managed Ruleset (ruleset ID <code class="ruleID"> <span class="ruleID" title="Click to copy the full ID" onclick="navigator.clipboard.writeText(&#34;efb7b8c949ac4650a09736fc376e9aee&#34;)">...376e9aee&nbsp;<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" style="width: 16px;height: 18px;" class="icon-copy"><path d="M14 1.5H6l-.5.5v2.5h1v-2h7v7h-2v1H14l.5-.5V2l-.5-.5z"></path><path d="M2 5.5l-.5.5v8l.5.5h8l.5-.5V6l-.5-.5H2zm7.5 8h-7v-7h7v7z"></path></svg></span></code>).</li>
<li>A single override for the rule <code>Apache Struts - Open Redirect - CVE:CVE-2013-2248</code> (rule ID <code class="ruleID"> <span class="ruleID" title="Click to copy the full ID" onclick="navigator.clipboard.writeText(&#34;23ee7cebe6e8443e99ecf932ab579455&#34;)">...ab579455&nbsp;<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" style="width: 16px;height: 18px;" class="icon-copy"><path d="M14 1.5H6l-.5.5v2.5h1v-2h7v7h-2v1H14l.5-.5V2l-.5-.5z"></path><path d="M2 5.5l-.5.5v8l.5.5h8l.5-.5V6l-.5-.5H2zm7.5 8h-7v-7h7v7z"></path></svg></span></code>) in the same ruleset, setting the action to <code>log</code> and disabling the rule.</li>
</ul>
<ol start="3">
<li>
<p>(Optional, for Enterprise customers only) If you are migrating an Enterprise zone to WAF Managed Rules, you can enter validation mode before finishing the migration. In this mode, both WAF implementations will be enabled. Use the <a href="/api/operations/updateZoneEntrypointRuleset" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">Update a zone entry point ruleset</span><span class="DocsMarkdown--link-api-icon" aria-hidden="true">
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="23px" height="12px" viewBox="0 0 23 12" version="1.1">
    <title>API link label</title>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Group">
            <rect id="Rectangle" fill="#e06d10" x="0" y="0" width="23" height="12" rx="2"/>
            <path d="M8.12890625,10 L9.58984375,10 L6.83984375,2.24951172 L5.27685547,2.24951172 L2.52685547,10 L3.95556641,10 L4.61621094,7.99658203 L7.46826172,7.99658203 L8.12890625,10 Z M6.0234375,3.61914062 L6.06103516,3.61914062 L7.140625,6.92773438 L4.93847656,6.92773438 L6.0234375,3.61914062 Z M10.9169922,2.24951172 L10.9169922,10 L12.3027344,10 L12.3027344,7.43798828 L13.8710938,7.43798828 C15.4394531,7.43798828 16.5405273,6.390625 16.5405273,4.84375 C16.5405273,3.296875 15.4716797,2.24951172 13.9301758,2.24951172 L10.9169922,2.24951172 Z M12.3027344,3.3828125 L13.5649414,3.3828125 C14.5585938,3.3828125 15.1333008,3.91455078 15.1333008,4.84375 C15.1333008,5.78369141 14.5532227,6.32080078 13.5595703,6.32080078 L12.3027344,6.32080078 L12.3027344,3.3828125 Z M19.4360352,10 L18.050293,10 L18.050293,2.24951172 L19.4360352,2.24951172 L19.4360352,10 Z" id="API" fill="#FFFFFF" fill-rule="nonzero"/>
        </g>
    </g>
</svg>
  <span is-visually-hidden>Open API docs link</span>
</span></a> operation, making sure you include the <code>waf_migration=validation&amp;phase_two=1</code> query string parameters:</p>
<div class="code-container">
    <unparsed-codeblock data-language="bash" data-code="curl&#43;--request&#43;PUT&#43;%5C%0A%22https%3A%2F%2Fapi.cloudflare.com%2Fclient%2Fv4%2Fzones%2F%7Bzone_id%7D%2Frulesets%2Fphases%2Fhttp_request_firewall_managed%2Fentrypoint%3Fwaf_migration%3Dvalidation%26phase_two%3D1%22&#43;%5C%0A--header&#43;%22Authorization%3A&#43;Bearer&#43;%3CAPI_TOKEN%3E%22&#43;%5C%0A--header&#43;%22Content-Type%3A&#43;application%2Fjson%22&#43;%5C%0A--data&#43;%27%7B%0A&#43;&#43;%22name%22%3A&#43;%22default%22%2C%0A&#43;&#43;%22rules%22%3A&#43;%5B%0A&#43;&#43;&#43;&#43;%7B%0A&#43;&#43;&#43;&#43;&#43;&#43;%22action%22%3A&#43;%22execute%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;%22expression%22%3A&#43;%22true%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;%22description%22%3A&#43;%22%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;%22enabled%22%3A&#43;true%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;%22action_parameters%22%3A&#43;%7B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22id%22%3A&#43;%22efb7b8c949ac4650a09736fc376e9aee%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22overrides%22%3A&#43;%7B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22rules%22%3A&#43;%5B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%7B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22id%22%3A&#43;%2223ee7cebe6e8443e99ecf932ab579455%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22action%22%3A&#43;%22log%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22enabled%22%3A&#43;false%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%7D%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%5D%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%7D%0A&#43;&#43;&#43;&#43;&#43;&#43;%7D%0A&#43;&#43;&#43;&#43;%7D%0A&#43;&#43;%5D%0A%7D%27"></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div><p>After invoking this API endpoint, both WAF managed rules and WAF Managed Rules will be enabled. Check the <a href=/waf/analytics/security-events/paid-plans/#activity-log class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Activity log</span></a> in Security Events for any legitimate traffic getting blocked, and perform any required adjustments to the WAF Managed Rules configuration. For example, you can <a href=/ruleset-engine/managed-rulesets/override-managed-ruleset/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">add an override</span></a> for a single rule that disables it or changes its action.</p>
</li>
<li>
<p>To finish the migration and disable WAF managed rules, set the configuration for the new WAF using the settings you obtained in step 2 and possibly adjusted in step 3. Make sure you include the <code>waf_migration=pending&amp;phase_two=1</code> query string parameters.</p>
<div class="code-container">
    <unparsed-codeblock data-language="bash" data-code="curl&#43;--request&#43;PUT&#43;%5C%0A%22https%3A%2F%2Fapi.cloudflare.com%2Fclient%2Fv4%2Fzones%2F%7Bzone_id%7D%2Frulesets%2Fphases%2Fhttp_request_firewall_managed%2Fentrypoint%3Fwaf_migration%3Dpending%26phase_two%3D1%22&#43;%5C%0A--header&#43;%22Authorization%3A&#43;Bearer&#43;%3CAPI_TOKEN%3E%22&#43;%5C%0A--header&#43;%22Content-Type%3A&#43;application%2Fjson%22&#43;%5C%0A--data&#43;%27%7B%0A&#43;&#43;%22name%22%3A&#43;%22default%22%2C%0A&#43;&#43;%22rules%22%3A&#43;%5B%0A&#43;&#43;&#43;&#43;%7B%0A&#43;&#43;&#43;&#43;&#43;&#43;%22id%22%3A&#43;%22%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;%22version%22%3A&#43;%22%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;%22action%22%3A&#43;%22execute%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;%22expression%22%3A&#43;%22true%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;%22description%22%3A&#43;%22%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;%22ref%22%3A&#43;%22%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;%22enabled%22%3A&#43;true%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;%22action_parameters%22%3A&#43;%7B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22id%22%3A&#43;%22efb7b8c949ac4650a09736fc376e9aee%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22overrides%22%3A&#43;%7B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22rules%22%3A&#43;%5B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%7B%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22id%22%3A&#43;%2223ee7cebe6e8443e99ecf932ab579455%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22action%22%3A&#43;%22log%22%2C%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%22enabled%22%3A&#43;false%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%7D%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%5D%0A&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;%7D%0A&#43;&#43;&#43;&#43;&#43;&#43;%7D%0A&#43;&#43;&#43;&#43;%7D%0A&#43;&#43;%5D%0A%7D%27"></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div></li>
</ol>
<p>Once the provided configuration is saved and the new WAF Managed Rules are enabled, the previous version of the WAF managed rules will be automatically disabled, due to the presence of the <code>waf_migration=pending&amp;phase_two=1</code> parameters. This will make sure that your zone stays protected by one of the WAF versions during the update process.</p>
<aside class="DocsMarkdown--aside" role="note" data-type="note"><p>Pro and Business customers, which do not have access to the validation mode described in step 3, can update the rules (and overrides) in their zone entry point ruleset without triggering the migration by omitting the <code>waf_migration=pending&amp;phase_two=1</code> parameters. However, all the rules in their configuration must be disabled (<code>&quot;enabled&quot;: false</code>). Only Enterprise customers can configure (enabled) rules deploying Managed Rulesets without triggering the migration.</p>
</aside>

<hr>
<h2 id="analyzing-the-new-waf-behavior-in-security-events">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#analyzing-the-new-waf-behavior-in-security-events">&#8203;​</a>
    </span>
    <span>Analyzing the new WAF behavior in Security Events</span>
  </h2><h3 id="for-enterprise-customers">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#for-enterprise-customers">&#8203;​</a>
    </span>
    <span>For Enterprise customers</span>
  </h3><p>If you are an Enterprise customer, use the <strong>validation mode</strong> of the WAF migration process to check the behavior of the new WAF Managed Rules configuration. Cloudflare enables validation mode after you deploy the new WAF configuration. In this mode, the previous WAF version is still enabled, so that you can validate the behavior of your new configuration during the migration process. The new WAF Managed Rules will run before the previous version.</p>
<p>Go to the <a href=/waf/analytics/security-events/paid-plans/#activity-log class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Activity log</span></a> in Security Events during validation mode and check the following:</p>
<ul>
<li>
<p>Look for any requests allowed by the new WAF that are being handled by the previous WAF version (for example, by a challenge or block action). If this happens, consider writing a <a href=/firewall/cf-dashboard/create-edit-delete-rules/#create-a-firewall-rule class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">firewall rule</span></a> or a <a href=/waf/custom-rules/create-dashboard/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">WAF custom rule</span></a> to handle the requests you previously identified.</p>
</li>
<li>
<p>Look for legitimate requests being blocked by the new WAF. In this situation, edit the WAF managed rule that is blocking these requests, changing the performed action or disabling the rule. For more information, refer to <a href=/waf/managed-rules/deploy-zone-dashboard/#configure-a-managed-ruleset class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Configure a managed ruleset</span></a>.</p>
</li>
</ul>
<h3 id="for-businessprofessional-customers">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#for-businessprofessional-customers">&#8203;​</a>
    </span>
    <span>For Business/Professional customers</span>
  </h3><p>Business and Professional customers do not have access to validation mode, which means that they will be able to check the new WAF behavior after they migrate to the new WAF Managed Rules.</p>
<p>In the days following the migration, check the <a href=/waf/analytics/security-events/paid-plans/#activity-log class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Activity log</span></a> in Security Events looking for any legitimate requests being blocked by WAF Managed Rules. If you identify any incorrectly blocked requests, adjust the corresponding WAF rule action to Log. For more information on changing the action of a managed ruleset rule, refer to <a href=/waf/managed-rules/deploy-zone-dashboard/#configure-a-single-rule-in-a-managed-ruleset class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Configure a single rule in a managed ruleset</span></a>.</p>
<p>Additionally, check for requests that should have been blocked. In this situation, consider creating a <a href=/firewall/cf-dashboard/create-edit-delete-rules/#create-a-firewall-rule class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">firewall rule</span></a> or a <a href=/waf/custom-rules/create-dashboard/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">WAF custom rule</span></a> to block these requests.</p>
<hr>
<h2 id="api-operations">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#api-operations">&#8203;​</a>
    </span>
    <span>API operations</span>
  </h2><p>Updating to the new WAF Managed Rules via API requires invoking the following API operations:</p>

<div class="DocsMarkdown--table-wrap" style="font-size:88%"><div class="DocsMarkdown--table-wrap-inner">
    <table>
<thead>
<tr>
<th>Name</th>
<th>Method + Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Check WAF<br>update compatibility</td>
<td><code>GET</code> <code>/zones/&lt;ZONE_ID&gt;/waf_migration/check?phase_two=1</code></td>
<td>Checks if the current zone can be updated to the new WAF, given its current configuration.</td>
</tr>
<tr>
<td>Get new WAF<br>configuration</td>
<td><code>GET</code> <code>/zones/&lt;ZONE_ID&gt;/waf_migration/config?phase_two=1</code></td>
<td>Obtains the new WAF Managed Rules configuration that is equivalent to the current configuration (previous version of WAF managed rules).</td>
</tr>
<tr>
<td><a href=/ruleset-engine/rulesets-api/update/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Update zone<br>entry point ruleset</span></a></td>
<td><code>PUT</code> <code>/zones/&lt;ZONE_ID&gt;/rulesets/</code> <code>phases/http_request_firewall_managed/entrypoint?waf_migration=&lt;VALUE&gt;&amp;phase_two=1</code></td>
<td>Updates the configuration of the zone entry point ruleset for the <code>http_request_firewall_managed</code> phase.<br/>Available values for the <code>waf_migration</code> query string parameter:<br/>– <code>pending</code> / <code>1</code>: Defines the new WAF Managed Rules configuration and disables the previous version of WAF managed rules as soon as the provided configuration is saved and the new WAF is enabled.<br/>– <code>validation</code> / <code>2</code>: (Enterprise zones only) Defines the new WAF Managed Rules configuration and enables the new WAF Managed Rules side by side with the previous version, entering validation mode. To exit validation mode and finish the migration, invoke the same API endpoint with <code>waf_migration=pending</code>.</td>
</tr>
<tr>
<td>Get WAF status</td>
<td><code>GET</code> <code>/zones/&lt;ZONE_ID&gt;/waf_migration/status</code></td>
<td>Obtains the status of old and new WAF managed rules for a zone (enabled/disabled). The response also includes the current migration state (or mode).</td>
</tr>
</tbody>
</table>

  </div>
</div>
<p>You must prepend the Cloudflare API base URL to the endpoints listed above to obtain the full endpoint:</p>
<p><code>https://api.cloudflare.com/client/v4</code></p>
<hr>
<h2 id="possible-migration-errors">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#possible-migration-errors">&#8203;​</a>
    </span>
    <span>Possible migration errors</span>
  </h2><p>Contact Cloudflare Support to get help with the following errors:</p>
<ul>
<li>The number of firewall rules to migrate exceeds 200.</li>
<li>The length of a firewall rule expression is longer than 4 KB.</li>
</ul>
<hr>
<h2 id="additional-resources">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#additional-resources">&#8203;​</a>
    </span>
    <span>Additional resources</span>
  </h2><h3 id="configuring-the-new-waf-managed-rules-using-the-cloudflare-api">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#configuring-the-new-waf-managed-rules-using-the-cloudflare-api">&#8203;​</a>
    </span>
    <span>Configuring the new WAF Managed Rules using the Cloudflare API</span>
  </h3><p>Instead of using the previous APIs for managing WAF packages, rule groups, and rules, you must now use the <a href=/ruleset-engine/rulesets-api/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Rulesets API</span></a> to programmatically configure WAF Managed Rules.</p>
<p>You can also create <a href=/ruleset-engine/managed-rulesets/override-managed-ruleset/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">overrides</span></a> to specify changes to be executed on top of the default WAF Managed Rules configuration. These changes will take precedence over the managed ruleset’s default behavior.</p>
<p>For more information, refer to the following resources:</p>
<ul>
<li><a href=/ruleset-engine/managed-rulesets/deploy-managed-ruleset/#deploy-a-managed-ruleset-to-a-phase-at-the-zone-level class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Deploy a managed ruleset to a phase at the zone level</span></a></li>
<li><a href=/ruleset-engine/managed-rulesets/override-managed-ruleset/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Override a managed ruleset</span></a></li>
</ul>
<h3 id="configuring-the-new-waf-managed-rules-using-terraform">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#configuring-the-new-waf-managed-rules-using-terraform">&#8203;​</a>
    </span>
    <span>Configuring the new WAF Managed Rules using Terraform</span>
  </h3><p>Instead of using the previous resources for managing WAF packages, rule groups, and rules, you must now use the <a href="https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/ruleset" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content"><code>cloudflare_ruleset</code></span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a> Terraform resource to configure WAF Managed Rules. For configuration examples, refer to <a href=/terraform/additional-configurations/waf-managed-rulesets/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Configure WAF Managed Rules</span></a>.</p>
<h4 id="replace-your-configuration-using-cf-terraforming">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#replace-your-configuration-using-cf-terraforming">&#8203;​</a>
    </span>
    <span>Replace your configuration using <code>cf-terraforming</code></span>
  </h4><p>You can use the <a href="https://github.com/cloudflare/cf-terraforming" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content"><code>cf-terraforming</code></span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a> tool to generate the Terraform configuration for your new WAF Managed Rules configuration after you migrate. Then, import the new resources to Terraform state.</p>
<p>The recommended steps for replacing your old WAF managed rules configuration in Terraform with a new ruleset-based configuration for the new WAF Managed Rules are the following:</p>
<ol>
<li>
<p>Run the following command to generate all ruleset configurations for a zone:</p>
<div class="code-container">
    <unparsed-codeblock data-language="sh" data-code="---%0Ahighlight%3A&#43;%5B3%2C6%5D%0A---%0A%24&#43;cf-terraforming&#43;generate&#43;--zone&#43;%3CZONE_ID%3E&#43;--resource-type&#43;%22cloudflare_ruleset%22%0A%0Aresource&#43;%22cloudflare_ruleset%22&#43;%22terraform_managed_resource_3c0b456bc2aa443089c5f40f45f51b31%22&#43;%7B%0A&#43;&#43;kind&#43;&#43;&#43;&#43;%3D&#43;%22zone%22%0A&#43;&#43;name&#43;&#43;&#43;&#43;%3D&#43;%22default%22%0A&#43;&#43;phase&#43;&#43;&#43;%3D&#43;%22http_request_firewall_managed%22%0A&#43;&#43;zone_id&#43;%3D&#43;%22%3CZONE_ID%3E%22%0A&#43;&#43;rules&#43;%7B%0A&#43;&#43;&#43;&#43;%5B...%5D%0A&#43;&#43;%7D%0A&#43;&#43;%5B...%5D%0A%7D%0A%5B...%5D"></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div></li>
<li>
<p>The previous command may return additional ruleset configurations for other Cloudflare products also based on the <a href=/ruleset-engine/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Ruleset Engine</span></a>. Since you are looking for the WAF Managed Rules configuration, keep only the Terraform resource for the <code>http_request_firewall_managed</code> phase and save it to a <code>.tf</code> configuration file. You will need the full resource name in the next step.</p>
</li>
<li>
<p>Import the <code>cloudflare_ruleset</code> resource you previously identified into Terraform state using the <code>terraform import</code> command. For example:</p>
<div class="code-container">
    <unparsed-codeblock data-language="sh" data-code="%24&#43;terraform&#43;import&#43;cloudflare_ruleset.terraform_managed_resource_3c0b456bc2aa443089c5f40f45f51b31&#43;zone%2F%3CZONE_ID%3E%2F3c0b456bc2aa443089c5f40f45f51b31%0A%0Acloudflare_ruleset.terraform_managed_resource_3c0b456bc2aa443089c5f40f45f51b31%3A&#43;Importing&#43;from&#43;ID&#43;%22zone%2F%3CZONE_ID%3E%2F3c0b456bc2aa443089c5f40f45f51b31%22...%0Acloudflare_ruleset.terraform_managed_resource_3c0b456bc2aa443089c5f40f45f51b31%3A&#43;Import&#43;prepared%21%0A&#43;&#43;Prepared&#43;cloudflare_ruleset&#43;for&#43;import%0Acloudflare_ruleset.terraform_managed_resource_3c0b456bc2aa443089c5f40f45f51b31%3A&#43;Refreshing&#43;state...&#43;%5Bid%3D3c0b456bc2aa443089c5f40f45f51b31%5D%0A%0AImport&#43;successful%21%0A%0AThe&#43;resources&#43;that&#43;were&#43;imported&#43;are&#43;shown&#43;above.&#43;These&#43;resources&#43;are&#43;now&#43;in%0Ayour&#43;Terraform&#43;state&#43;and&#43;will&#43;henceforth&#43;be&#43;managed&#43;by&#43;Terraform."></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div></li>
<li>
<p>Run <code>terraform plan</code> to validate that Terraform now checks the state of the new <code>cloudflare_ruleset</code> resource, in addition to other existing resources already managed by Terraform. For example:</p>
<div class="code-container">
    <unparsed-codeblock data-language="sh" data-code="%24&#43;terraform&#43;plan%0A%0Acloudflare_ruleset.terraform_managed_resource_3c0b456bc2aa443089c5f40f45f51b31%3A&#43;Refreshing&#43;state...&#43;%5Bid%3D3c0b456bc2aa443089c5f40f45f51b31%5D%0A%5B...%5D%0Acloudflare_waf_package.my_package%3A&#43;Refreshing&#43;state...&#43;%5Bid%3D14a2524fd75c419f8d273116815b6349%5D%0Acloudflare_waf_group.my_group%3A&#43;Refreshing&#43;state...&#43;%5Bid%3D0580eb5d92e344ddb2374979f74c3ddf%5D%0A%5B...%5D"></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div></li>
<li>
<p>Remove any state related to the previous version of WAF managed rules from your Terraform state:</p>
<aside class="DocsMarkdown--aside" role="note" data-type="warning">
    <div class="DocsMarkdown--aside-header">Important</div><p>You must remove WAF packages, groups, and rules from Terraform state before deleting their configuration from <code>.tf</code> configuration files to prevent issues.</p>
</aside>

<ol>
<li>
<p>Run the following command to find all resources related to the previous version of WAF managed rules:</p>
<div class="code-container">
    <unparsed-codeblock data-language="sh" data-code="%24&#43;terraform&#43;state&#43;list&#43;%7C&#43;grep&#43;-E&#43;%27%5Ecloudflare_waf_%28package%7Cgroup%7Crule%29%5C.%27%0A%0Acloudflare_waf_package.my_package%0Acloudflare_waf_group.my_group"></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div></li>
<li>
<p>Run the <code>terraform state rm ...</code> command in dry-run mode to understand the impact of removing those resources without performing any changes:</p>
<div class="code-container">
    <unparsed-codeblock data-language="sh" data-code="%24&#43;terraform&#43;state&#43;rm&#43;-dry-run&#43;cloudflare_waf_package.my_package&#43;cloudflare_waf_group.my_group%0A%0AWould&#43;remove&#43;cloudflare_waf_package.my_package%0AWould&#43;remove&#43;cloudflare_waf_group.my_group"></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div></li>
<li>
<p>If the impact looks correct, run the same command without the <code>-dry-run</code> parameter to actually remove the resources from Terraform state:</p>
<div class="code-container">
    <unparsed-codeblock data-language="sh" data-code="%24&#43;terraform&#43;state&#43;rm&#43;cloudflare_waf_package.my_package&#43;cloudflare_waf_group.my_group%0A%0ARemoved&#43;cloudflare_waf_package.my_package%0ARemoved&#43;cloudflare_waf_group.my_group%0ASuccessfully&#43;removed&#43;2&#43;resource&#43;instance%28s%29."></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div></li>
</ol>
</li>
<li>
<p>After removing WAF package, group, and rule resources from Terraform state, delete <code>cloudflare_waf_package</code>, <code>cloudflare_waf_group</code>, and <code>cloudflare_waf_rule</code> resources from <code>.tf</code> configuration files.</p>
</li>
<li>
<p>Run <code>terraform plan</code> to verify that the resources you deleted from configuration files no longer appear. You should not have any pending changes.</p>
<div class="code-container">
    <unparsed-codeblock data-language="sh" data-code="%24&#43;terraform&#43;plan%0A%0Acloudflare_ruleset.terraform_managed_resource_3c0b456bc2aa443089c5f40f45f51b31%3A&#43;Refreshing&#43;state...&#43;%5Bid%3D3c0b456bc2aa443089c5f40f45f51b31%5D%0A%5B...%5D%0A%0ANo&#43;changes.&#43;Your&#43;infrastructure&#43;matches&#43;the&#43;configuration.%0A%0ATerraform&#43;has&#43;compared&#43;your&#43;real&#43;infrastructure&#43;against&#43;your&#43;configuration&#43;and&#43;found&#43;no&#43;differences%2C&#43;so&#43;no&#43;changes&#43;are&#43;needed."></unparsed-codeblock>
    <vue-component name="CodeCopy"></vue-component>
</div></li>
</ol>
<p>For details on importing Cloudflare resources to Terraform and using the <code>cf-terraforming</code> tool, refer to the following resources:</p>
<ul>
<li><a href=/terraform/advanced-topics/import-cloudflare-resources/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Import Cloudflare resources</span></a></li>
<li><a href="https://github.com/cloudflare/cf-terraforming" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content"><code>cf-terraforming</code> GitHub repository</span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a></li>
</ul>
<hr>
<h2 id="final-remarks">
    <span class="DocsMarkdown--header-anchor-positioner">
      <a class="DocsMarkdown--header-anchor Link Link-without-underline" href="#final-remarks">&#8203;​</a>
    </span>
    <span>Final remarks</span>
  </h2><p>The concept of <span tabindex="0" class='glossary-tooltip' data-title='Classifies rules of the OWASP managed ruleset according to their aggressiveness.' data-toggle='tooltip' data-placement='top' aria-label='paranoia level'>paranoia level</span> did not exist in the OWASP version (2.x) used in WAF managed rules. Based on the OWASP guide recommendations, the WAF migration process will set the paranoia level of the Cloudflare OWASP Core Ruleset to <em>PL2</em>.</p>
<p>You cannot disable the new version of WAF Managed Rules using <a href=/rules/page-rules/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">Page Rules</span></a>, since the <em>Web Application Firewall: Off</em> setting in Page Rules only applies to the previous version of WAF managed rules. To disable the new WAF Managed Rules you must configure <a href=/waf/managed-rules/waf-exceptions/ class="DocsMarkdown--link"><span class="DocsMarkdown--link-content">exceptions</span></a> (also known as skip rules).</p>
</article>
      </div>
    </main>

    <footer class="DocsFooter">
  <div class="DocsFooter--content">
    <div class="DocsFooterResources">      
      <span class="DocsFooter--content-additional-wrapper"><a href="https://dash.cloudflare.com/?to=/:account/:zone/security/waf" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">Cloudflare Dashboard</span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a>
      </span>
      
      <span class="DocsFooter--content-dot-spacer"> &nbsp; · &nbsp; </span>

      
      <span class="DocsFooter--content-additional-wrapper"><a href="https://community.cloudflare.com/c/security/6" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">Community</span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a>
      </span> 
      
      <span class="DocsFooter--content-dot-spacer"> &nbsp; · &nbsp; </span>

      <span class="DocsFooter--content-additional-wrapper"><a href="https://www.cloudflare.com/learning/ddos/glossary/web-application-firewall-waf/" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">Learning Center</span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a></span>

      <span class="DocsFooter--content-dot-spacer"> &nbsp; · &nbsp; </span>

      <span class="DocsFooter--content-additional-wrapper"><a href="/support/contacting-cloudflare-support/" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">Support Portal</span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a>
      </span>

      <span class="DocsFooter--content-dot-spacer"> &nbsp; · &nbsp; </span>

      <span class="DocsFooter--content-additional-wrapper">
        
          <a role="button" id="ot-sdk-btn" class="ot-sdk-show-settings">Cookie Settings</a>
        
      </span>
    </div>
    <div>
      <span class="DocsFooter--edit-on-gh-link-wrapper"><a href="https://github.com/cloudflare/cloudflare-docs/blob/production/content/waf/reference/migration-guides/waf-managed-rules-migration.md" class="DocsMarkdown--link" target="_blank" rel="noopener">
  <span class="DocsMarkdown--link-content">Edit on GitHub</span><span class="DocsMarkdown--link-external-icon" aria-hidden="true">
  <svg fill="none" stroke="currentColor" stroke-width="1.5" width="23px" height="12px" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 16 16" role="img" aria-labelledby="title-4744738674102027" xmlns="http://www.w3.org/2000/svg">
    <title id="title-4744738674102027">External link icon</title>
    <path d="M6.75,1.75h-5v12.5h12.5v-5m0,-4v-3.5h-3.5M8,8l5.5-5.5"></path>
  </svg>
  <span is-visually-hidden>Open external link</span>
</span></a></span><span class="DocsFooter--content-dot-spacer"> &nbsp; · &nbsp; </span>

      <span class="DocsFooter--content-time">
        Updated <time
  class="relative"
  datetime=2024-07-02T15:12:51&#43;01:00
  title=2024-07-02
>July 2, 2024</time>
      </span></div>
  </div><script type="module" src="/lightbox.js" defer></script><link rel="stylesheet" href="/lightbox.css">
</footer>

  </div>
<script defer src="https://unpkg.com/littlefoot@4.0.0-11/dist/littlefoot.js" type="application/javascript" ></script>
    <script type="application/javascript"> document.addEventListener('DOMContentLoaded', () => littlefoot.default()) </script>
  </body>
</html>
