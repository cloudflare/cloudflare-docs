---
title: Deploy a Worker
pcx_content_type: tutorial
products:
  - Workers
updated: 2024-01-08
difficulty: Beginner
languages:
  - JavaScript
  - TypeScript
  - Python
  - Go
  - Java
  - .NET
  - YAML
sidebar:
  order: 3
head:
  - tag: title
    content: Deploy a Worker
---

In this tutorial, you will go through step-by-step instructions to deploy a Hello World web application using Cloudflare Workers and Pulumi infrastructure as code (IaC) so that you can become familiar with the resource management lifecycle. In particular, you will create a Worker, a Route, and a DNS Record to access the application before cleaning up all the resources.

:::note
You will provision resources that qualify under free tier offerings for both Pulumi Cloud and Cloudflare.
:::

## Before you begin

Ensure you have:

- A Cloudflare account and API Token with permission to edit the resources in this tutorial. If you need to, sign up for a [Cloudflare account](https://dash.cloudflare.com/sign-up/workers-and-pages) before continuing.
- A Pulumi Cloud account. You can sign up for an [always-free, individual tier](https://app.pulumi.com/signup).
- The [Pulumi CLI](/pulumi/installing/) is installed on your machine.
- A [Pulumi-supported programming language](https://github.com/pulumi/pulumi?tab=readme-ov-file#languages) configured. (TypeScript, JavaScript, Python, Go, .NET, Java, or use YAML)
- A domain name. You may use `example.com` to complete the tutorial.

## 1. Initialize Pulumi

### a. Create a directory

Use a new and empty directory for this tutorial.

```sh
mkdir serverless-cloudflare
cd serverless-cloudflare
```

### b. Login

At the prompt, press Enter to log into your Pulumi Cloud account via the browser. Alternatively, you may provide a [Pulumi Cloud access token](https://www.pulumi.com/docs/pulumi-cloud/access-management/access-tokens/).

```sh
pulumi login
```

### c. Create a program

A Pulumi program is code written in a [supported programming language](https://github.com/pulumi/pulumi?tab=readme-ov-file#languages) that defines infrastructure resources.

To create a program, select your language of choice and run the `pulumi` command:

<Tabs> <TabItem label="JavaScript" icon="seti:javascript">

```sh
pulumi new javascript --name serverless-cloudflare --yes
# wait a few seconds while the project is initialized
```

</TabItem> <TabItem label="TypeScript" icon="seti:typescript">

```sh
pulumi new typescript --name serverless-cloudflare --yes
# wait a few seconds while the project is initialized
```

</TabItem> <TabItem label="Python" icon="seti:python">

```sh
pulumi new python --name serverless-cloudflare --yes
# wait a few seconds while the project is initialized
```

</TabItem> <TabItem label="go">

```sh
pulumi new go --name serverless-cloudflare --yes
# wait a few seconds while the project is initialized
```

</TabItem> <TabItem label="Java">

```sh
pulumi new java --name serverless-cloudflare --yes
# wait a few seconds while the project is initialized
```

</TabItem> <TabItem label=".NET">

```sh
pulumi new csharp --name serverless-cloudflare --yes
# wait a few seconds while the project is initialized
```

</TabItem> <TabItem label="YAML">

```sh
pulumi new yaml --name serverless-cloudflare --yes
```

</TabItem> </Tabs>

### d. Save your application settings

In this step, you will store your application settings in a Pulumi [ESC Environment](https://www.pulumi.com/docs/esc/environments/). This is a YAML file containing configurations and secrets. These can be accessed in several ways, including a Pulumi program. All ESC Environments security reside in your Pulumi Cloud account and can be fully managed via the Pulumi CLI. For this tutorial, you will save the following:

- Your Cloudflare [account ID](/fundamentals/setup/find-account-and-zone-ids/).
- A valid Cloudflare API [token](/fundamentals/api/get-started/create-token/).
- A domain. For instance, `example.com`.

```sh
# Define an ESC Environment name
E=my-dev-env

# Create a new Pulumi ESC Environment
pulumi config env init --env $E --yes --stack dev

# Replace abc123 with your Cloudflare account ID
pulumi env set $E --plaintext pulumiConfig.accountId abc123

# Replace API_TOKEN with your Cloudflare API token
pulumi env set $E --secret  pulumiConfig.cloudflare:apiToken API_TOKEN

# Replace example.com with your registered domain, or leave as is
pulumi env set $E --plaintext pulumiConfig.domain example.com

# Add the ESC Environment to your Pulumi stack
pulumi config env add $E --yes --non-interactive
```

### e. Create a stack

A Pulumi [stack](https://www.pulumi.com/docs/concepts/stack/) is an instance of a Pulumi program. Stacks are independently configurable and may represent different environments (development, staging, production) or feature branches. For this tutorial, you'll use the `dev` stack.

To instantiate your `dev` stack, run:

```sh
pulumi up --yes --stack dev
# wait a few seconds for the stack to be instantiated.
```

At this point, you have not defined any resources so you'll have an empty stack.

### f. Install the Cloudflare package

In order to define Cloudflare resources in your Pulumi program, you need to install the Cloudflare package for your language of choice.

Install the Cloudflare package by running the following command:

<Tabs> <TabItem label="JavaScript" icon="seti:javascript">

```sh
npm install @pulumi/cloudflare
```

```sh output
added 1 package ...
```

</TabItem> <TabItem label="TypeScript" icon="seti:typescript">

```sh
npm install @pulumi/cloudflare
```

```sh output
added 1 package ...
```

</TabItem> <TabItem label="Python" icon="seti:python">

```sh
echo "pulumi_cloudflare>=5.35,<6.0.0" >> requirements.txt
source venv/bin/activate
pip install -r requirements.txt
```

```sh output
...
Collecting pulumi-cloudflare
...
```

</TabItem> <TabItem label="go">

```sh
go get github.com/pulumi/pulumi-cloudflare/sdk/v3/go/cloudflare
```

```sh output
go: downloading github.com/pulumi/pulumi-cloudflare ...
```

</TabItem> <TabItem label="Java">

Below are Apache Maven instructions. For other Java project managers such as Gradle, see the official [Maven repository](https://central.sonatype.com/artifact/com.pulumi/cloudflare/overview)

1. Open your `pom.xml` file.
2. Add the Pulumi Cloudflare dependency inside the `<dependencies>` section.

```xml
<dependency>
    <groupId>com.pulumi</groupId>
    <artifactId>cloudflare</artifactId>
    <version>5.35.1</version>
</dependency>
```

3. Run:

```sh
mvn clean install
```

```sh output
...
[INFO] BUILD SUCCESS
...
```

</TabItem> <TabItem label=".NET">

```sh
dotnet add package Pulumi.Cloudflare
```

```sh output
...
info : Adding PackageReference for package 'Pulumi.Cloudflare' into project
...
```

</TabItem> <TabItem label="YAML">

There are no dependencies to download for YAML. Skip ahead.

</TabItem> </Tabs>

## 2. Add a Worker

Replace the contents of your entrypoint file with the following:

<Tabs> <TabItem label="JavaScript" icon="seti:javascript">

```typescript
import * as pulumi from "@pulumi/pulumi";
import * as cloudflare from "@pulumi/cloudflare";

const config = new pulumi.Config();
const accountId = config.require("accountId");
const domain = config.require("domain");

// A Worker script to invoke
export const script = new cloudflare.WorkerScript("hello-world-script", {
	accountId: accountId,
	name: "hello-world",
	// Read the content of the worker from a file
	// content: fs.readFileSync("./app/worker.ts", "utf8"), // TODO: Use inline code
});
```

</TabItem> </Tabs>

TODO -- ADD OTHER LANGUAGES

## 3. Add a Worker route

You will now add a Worker Route to the Pulumi stack, `dev` so the script can have an endpoint.

Append the following code to your entrypoint file:

<Tabs> <TabItem label="TypeScript" icon="seti:typescript">
```typescript
// A Worker route to serve requests and the Worker script
export const route = new cloudflare.WorkerRoute("hello-world-route", {
	zoneId: zoneId,
	pattern: "hello-world." + domain,
	scriptName: script.name,
});
```
</TabItem> </Tabs>

## 4. Add a DNS record

You will now add a DNS record so the previously configured route can be accessed via a URL.

Append the following code to your entrypoint file:

```typescript
// A DNS record to access the route from the domain
export const record = new cloudflare.Record("hello-world-record", {
	zoneId: zoneId,
	name: script.name,
	value: "192.0.2.1",
	type: "A",
	proxied: true,
});

export const url = route.pattern;
```

## 5. Deploy the changes

Now that you have defined the resources, you can deploy the changes to your Cloudflare account using the Pulumi CLI.

To deploy the changes, run:

```sh
$ pulumi up --yes
waiting for stack to become ready
```

## 6. Test the Worker

You incrementally added Cloudflare resources to run and access your Hello World application. You can test your application by curling the `url` output from the Pulumi stack.

```sh
$ pulumi stack output url
$ curl "https://$(pulumi stack output url)"
TODO
```

:::note

Depending on your domain settings, you may need to use "http" in the curl command instead.

:::

## 6. Clean up

In this last step, you will clean up the resources and stack used throughout the tutorial.

### a. Delete the Cloudflare resources

```sh
pulumi destroy
```

### b. Remove the Pulumi stack

```sh
pulumi stack rm dev
```

## Next steps

Explore other resources you can define with Pulumi and Cloudflare by visiting the [Cloudflare package documentation](https://www.pulumi.com/docs/reference/pkg/cloudflare/).