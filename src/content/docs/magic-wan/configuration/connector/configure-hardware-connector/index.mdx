---
pcx_content_type: how-to
title: Configure hardware Connector
sidebar:
  order: 3
  label: Configure hardware Connector
---

import { GlossaryTooltip, Render, Card } from "~/components";

## Before you begin

You can install up to two Magic WAN Connectors for redundancy at each of your sites. If one of your Connectors fail, traffic will fail over to the other Connector ensuring that you never lose connectivity to that site.

In this type of high availability (HA) configuration, you will choose a reliable LAN interface as the HA link which will be used to monitor the health of the peer connector. HA links can be dedicated links or can be shared with other LAN traffic.

You must decide the type of configuration you want for your site from the beginning: no redundancy or with redundancy. You cannot add redundancy after finishing configuring your dashboard settings. If, at a later stage, you decide to enable redundancy, you will need to delete your site configuration in the Cloudflare dashboard, and start again.

<Card title="Do you need a high availability configuration?" icon="information">

- If you need a high availability configuration for your premises, refer to
  [About high availability configurations](#about-high-availability-configurations) for more information
  and learn how to configure your Connector in this mode.

- If you do not need a high availability configuration for you premises, proceed to [Configure
  Cloudflare dashboard settings](#1-configure-cloudflare-dashboard-settings).

</Card>

:::caution[Warning]
You cannot enable high availability for an existing site. To add high availability to an existing site in the Cloudflare dashboard, you need to delete the site and start again. Plan accordingly to create a high availability configuration from the start if needed.
:::

---

## Prerequisites

You need to purchase [Magic WAN](https://www.cloudflare.com/magic-wan/) before you can purchase and use the Magic WAN Connector. The Magic WAN Connector can function as your primary edge device for your network, or be deployed in-line with existing network gear.

You also need to purchase a Magic WAN Connector before you can start configuring your settings in the Cloudflare dashboard. After buying a Magic WAN Connector, the device will be registered with your Cloudflare account and show up in your Cloudflare dashboard.

Contact your account representative to learn more about purchasing options for the Magic WAN Connector device.

---

## Port speeds

The hardware version of the Magic WAN connector includes two [SFP+ ports](https://en.wikipedia.org/wiki/Small_Form-factor_Pluggable) that support 10G throughput, as well as six RJ45 ports that support 1G throughput.

Refer to [SFP+ port information](/magic-wan/configuration/connector/configure-hardware-connector/sfp-port-information/) for details on this topic.

---

## 1. Configure Cloudflare dashboard settings

<Render
	file="connector/create-site"
	params={{
		one: "refers to the physical Magic WAN Connector Ethernet port that you are using for your WAN. The ports are labeled `GE1`, `GE2`, `GE3`, `GE4`, `GE5`, and `GE6`. Choose the number corresponding to the port that you are using in Connector. <br> If you need a throughput higher than 1 Gbps, you can use one of the SFP+ ports. Refer to [SFP+ port information](/magic-wan/configuration/connector/configure-hardware-connector/sfp-port-information/) for more information on the hardware supported.",
		two: "refers to the physical Magic WAN Connector Ethernet port that you are using for your LAN. The ports are labeled `GE1`, `GE2`, `GE3`, `GE4`, `GE5`, and `GE6`. Choose a number corresponding to the port that you are using in Connector. <br> If you need a throughput higher than 1 Gbps, you can use one of the SFP+ ports. Refer to [SFP+ port information](/magic-wan/configuration/connector/configure-hardware-connector/sfp-port-information/) for more information on the hardware supported.",
		three:
			"You need to have bought a Connector already for it to show up here. Refer to [Prerequisites](#prerequisites) if no Connector shows up in this list.",
	}}
/>

## 2. Set up your Magic WAN Connector

### Device installation

There are several deployment options for Magic WAN Connector. Connector can act like a DHCP server for your local network, or integrate with your local setup and have static IP addresses assigned to it.

When Connector acts like the WAN router for your site, deployment will be something like this:

```mermaid
flowchart LR
accTitle: Magic WAN Connector set up as a DHCP server, and connecting to the Internet.
    a(Magic WAN Connector)--> b(Internet) --> c(Cloudflare)

    subgraph Customer site
    d[LAN 1] --> a
    e[LAN 2] --> a
    end

    classDef orange fill:#f48120,color: black
    class a,c orange
```

<br />

In the example below, the Connector sits behind the WAN router in your site, and on-ramps only some of the existing LANs to Cloudflare.

<br />

```mermaid
flowchart LR
accTitle: Magic WAN Connector connects to the router in the site, and only some of the LANs connect to Connector.
    a(Magic WAN Connector)--> b((Site's router)) --> c(Internet) --> i(Cloudflare)

    subgraph Customer site
    d[LAN 1] --> a
    e[LAN 2] --> a
    g(LAN 3) --> b
    h(LAN 4) --> b
    end

    classDef orange fill:#f48120,color: black
    class a,i orange
```

#### Firewall settings required

If there is a firewall deployed upstream of the Magic WAN Connector, configure the firewall to allow the following traffic:

{/* prettier-ignore */}
| Protocol/port | Destination IP/URL | Purpose |
| --- | --- |--- |
| `UDP/53` | DNS destination IP `1.1.1.1` | Needed to allow DNS traffic to Cloudflare DNS servers. Cloudflare uses this port for DNS lookups of control plane API |
| `TCP/443` | - | The Connector will open outbound HTTPS connections over this port for control plane operations. |
| `UDP/4500` | Destination IP `162.159.64.1` | Needed for Connector's initialization and discovery traffic through outbound connections. |
| `UDP/4500` | Destination IP - Cloudflare anycast IPs | Needed for the Cloudflare <GlossaryTooltip term="anycast" link="/magic-wan/configuration/manually/how-to/configure-tunnels/">anycast IPs</GlossaryTooltip> assigned to your account for tunnel outbound connections. This traffic is tunnel traffic. |
| `TCP/7844`, `UDP/7844` | Outbound connections | This is for debugging facilities in the Connector. |
| `UDP/123` | `http://time.cloudflare.com/` | Needed for Magic WAN Connector to periodically contact Cloudflare's Time Services. |

## 3. Activate connector

<Render
	file="connector/activate-connector"
	params={{ one: "The Magic WAN Connector is shipped to you deactivated" }}
/>

### WAN with a static IP address

After activating your Connector, you can use it in a network configuration with the WAN interface set to a static IP address â€” that is, an Internet configuration that is not automatically set by DHCP.

To use your Connector on a network configuration with a static IP:

1. Wait 60 seconds after activating your Connector.
2. Unplug the physical connection to the Internet-connected device which provides DHCP.
3. Adjust your physical connections as required to match the configuration specified in the [site configuration](#1-create-a-site) step (for example, static IP WAN plugged into a physical port with no DHCP connection).
4. Power cycle the Connector.

---

<Render
	file="connector/ha-configs"
	params={{
		one: "Follow the instructions in [Set up your Magic WAN Connector](#2-set-up-your-magic-wan-connector) and [Activate connector](#3-activate-connector) to finish setting up your Connectors.",
	}}
/>

---

## IP sec tunnels and static routes

<Render file="connector/ipsec-static-tunnels" />

---

## Next steps

<Render file="connector/next-steps" />
