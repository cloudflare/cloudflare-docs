---
order: 50
---

# Multi-Level subdomains

You can run Tunnel to expose a multi-level subdomain, such as foo.bar.example.com. The certificate generated by Tunnel will cover the first tier of subdomains and the apex (i.e. \*.example.com and example.com) by default. To extend it to a multi-level subdomain, you can follow two options: a CNAME solution or one that uses your own TLS certificate.

### Option 1: DNS solution

The first option is for you to run Tunnel on a separate domain, and then CNAME the domain you wish to expose to that original Warped domain. How this works:

1. Run Tunnel on your origin server and expose your service on a single-level subdomain such as warp.example.com.
2. Open up the Cloudflare DNS panel and create a CNAME record for the multi-level domain to the domain where Tunnel is running: CNAME foo.bar.example.com ==> warp.example.com.

### Option 2: Bring your own TLS certificate

The reason why you need a custom solution to run Tunnel on a multi-level domain is because the certificate Tunnel generates for your origin server is not valid beyond one subdomain level.

In order to include more hostnames, you can bring your own TLS certificate. Below are instructions for how to use Tunnel with a custom certificate.

1. Install `cloudflared` on your machine
2. Run the following command when the browser window opens and select the domain in Cloudflare that will be used. The login flow will download a certificate to your origin server.

```sh
$ cloudflared tunnel login
```

3. The downloaded certificate will automatically be placed in ~/.cloudflared/cert.pem.
4. If you open the certificate file, you will see it has three sections: private key, certificate and Tunnel token. Later on you will replace the private key and certificate sections.

```bash
    -----BEGIN PRIVATE KEY-----
    MIGHAgEAMBMwd51w/9Ne9nmMolCD0Z8s6AMBMwd51w/9Ne9nmMolCD0Z8s6
    -----END PRIVATE KEY-----
    -----BEGIN CERTIFICATE-----
    MIIDKzCCAtCgAwIBAgIUfk7smiHna9wiBasCpbVyeg6vBRAwCgYIKoZIzj0EAwIw
    gY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1T
    YW4gRnJhbmNpc2NvvdWRmbGFyZS5jb20vb3JpZ2luX2Vj
    Y19jYS5jcmwwCgYIKoZIzj0EAwIDSQAwRgIhANZOIFV/kWzbHVbpmTYewL6hPEdC
    YgtWeoaU3x5WsnFQAiEAjYSW1LE1A0HjCzU0ZpEzElzo0YbVPbj57eaUV7gk+Tg=
    -----END CERTIFICATE-----
    -----BEGIN Tunnel TOKEN-----
    OWJkMDQ1ZTcxMDQ1ZWI2NTZhZmEwYzRiYTRkMjRhZjQKdjEuMC1kOWMyNTY4MmQ4
    NTBkYzdjYTc1YzQ0ZlYjI5ZjIxNTU5NjhjOTE0MzY4YTkyYmUwODdhNzRj
    ZmEyMTU3Y2I5ZjU0MDMwMTczY2Q5MmQ3OTE0MWZkNWVmMTA5MGIxLTIxNjAxZjUz
    OWQwZjRlMjU3MDRjNmRhNzVjYTZjOTE3NmMwMDRhZGU4OTQ3NDIwOTE4Y2QyZGU2
    N2ExMWNhNDE=
    -----END Tunnel TOKEN-----
```

5. Next, generate a certificate for your origin server. Cloudflare offers a free Certificate Authority for generating origin certificates that are only trusted by Cloudflare. To do so, login to the Cloudflare dashboard and [visit the SSL/TLS tab.](https://dash.cloudflare.com?to=/:account/:zone/ssl-tls/origin)
6. Scroll down to the section titled Origin Certificates. In that table you will see certificates Tunnel generated for your server.
7. Click the button labeled 'Create Certificate'.
8. When the modal opens, select the checkbox for "Let Cloudflare generate a private key and a CSR". You may keep RSA selected as the key type. Then list the hostname you need to Warp, such as foo.bar.example.com.
9. Cloudflare will then present you a certificate to use for your origin.
10. Open up the file at ~/.cloudflared/cert.pem and replace the private key and certificate sections with the values Cloudflare shows in the dashboard.
11. Once you are finished, you can exit the modal in the dashboard by clicking 'Ok'.

<Aside>

If you use an encrypted certificate file, the Tunnel client won't prompt for the passphrase and the certificate will not work.
</Aside>

You can now start Tunnel on a multi-level subdomain.