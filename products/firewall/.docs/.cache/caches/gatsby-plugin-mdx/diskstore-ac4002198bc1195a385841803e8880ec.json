{"expireTime":9007200899183233000,"key":"gatsby-plugin-mdx-entire-payload-dc659594a29bab607030c6130b2af813-","val":{"mdast":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Fields and expressions","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":25,"offset":25},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":25,"offset":25},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Overview","position":{"start":{"line":4,"column":4,"offset":30},"end":{"line":4,"column":12,"offset":38},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":27},"end":{"line":4,"column":12,"offset":38},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Every Cloudflare firewall rule, no matter how complex, is really just a combination of two elements: an ","position":{"start":{"line":6,"column":1,"offset":40},"end":{"line":6,"column":105,"offset":144},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"expression","position":{"start":{"line":6,"column":107,"offset":146},"end":{"line":6,"column":117,"offset":156},"indent":[]}}],"position":{"start":{"line":6,"column":105,"offset":144},"end":{"line":6,"column":119,"offset":158},"indent":[]}},{"type":"text","value":" and an ","position":{"start":{"line":6,"column":119,"offset":158},"end":{"line":6,"column":127,"offset":166},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"action","position":{"start":{"line":6,"column":129,"offset":168},"end":{"line":6,"column":135,"offset":174},"indent":[]}}],"position":{"start":{"line":6,"column":127,"offset":166},"end":{"line":6,"column":137,"offset":176},"indent":[]}},{"type":"text","value":". Expressions define the criteria for an HTTP request to trigger an action; the action tells Cloudflare what to do with that request.","position":{"start":{"line":6,"column":137,"offset":176},"end":{"line":6,"column":270,"offset":309},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":40},"end":{"line":6,"column":270,"offset":309},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When an HTTP request reaches the firewall, Cloudflare compares values from the request to those defined in the expression. If the expression returns ","position":{"start":{"line":8,"column":1,"offset":311},"end":{"line":8,"column":150,"offset":460},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":8,"column":150,"offset":460},"end":{"line":8,"column":156,"offset":466},"indent":[]}},{"type":"text","value":", the expression matches, and Cloudflare triggers the action for that rule.","position":{"start":{"line":8,"column":156,"offset":466},"end":{"line":8,"column":231,"offset":541},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":311},"end":{"line":8,"column":231,"offset":541},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Working with expressions","position":{"start":{"line":10,"column":4,"offset":546},"end":{"line":10,"column":28,"offset":570},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":543},"end":{"line":10,"column":28,"offset":570},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"There are two interfaces in the ","position":{"start":{"line":12,"column":1,"offset":572},"end":{"line":12,"column":33,"offset":604},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall","position":{"start":{"line":12,"column":35,"offset":606},"end":{"line":12,"column":43,"offset":614},"indent":[]}}],"position":{"start":{"line":12,"column":33,"offset":604},"end":{"line":12,"column":45,"offset":616},"indent":[]}},{"type":"text","value":" app for creating expressions: the ","position":{"start":{"line":12,"column":45,"offset":616},"end":{"line":12,"column":80,"offset":651},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Builder","position":{"start":{"line":12,"column":82,"offset":653},"end":{"line":12,"column":100,"offset":671},"indent":[]}}],"position":{"start":{"line":12,"column":80,"offset":651},"end":{"line":12,"column":102,"offset":673},"indent":[]}},{"type":"text","value":" and the ","position":{"start":{"line":12,"column":102,"offset":673},"end":{"line":12,"column":111,"offset":682},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Editor","position":{"start":{"line":12,"column":113,"offset":684},"end":{"line":12,"column":130,"offset":701},"indent":[]}}],"position":{"start":{"line":12,"column":111,"offset":682},"end":{"line":12,"column":132,"offset":703},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":12,"column":132,"offset":703},"end":{"line":12,"column":133,"offset":704},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":572},"end":{"line":12,"column":133,"offset":704},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Expression Builder’s visual interface allows you to build expressions without worrying about field names and syntax.","position":{"start":{"line":14,"column":1,"offset":706},"end":{"line":14,"column":121,"offset":826},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":706},"end":{"line":14,"column":121,"offset":826},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"By comparison, the Expression Editor is text only, but it supports advanced features not available in the builder. You can find both in the ","position":{"start":{"line":16,"column":1,"offset":828},"end":{"line":16,"column":141,"offset":968},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Firewall Rules","position":{"start":{"line":16,"column":143,"offset":970},"end":{"line":16,"column":157,"offset":984},"indent":[]}}],"position":{"start":{"line":16,"column":141,"offset":968},"end":{"line":16,"column":159,"offset":986},"indent":[]}},{"type":"text","value":" tab.","position":{"start":{"line":16,"column":159,"offset":986},"end":{"line":16,"column":164,"offset":991},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":828},"end":{"line":16,"column":164,"offset":991},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":18,"column":1,"offset":993},"end":{"line":18,"column":5,"offset":997},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-filters","children":[{"type":"emphasis","children":[{"type":"text","value":"Cloudflare Filters API","position":{"start":{"line":18,"column":7,"offset":999},"end":{"line":18,"column":29,"offset":1021},"indent":[]}}],"position":{"start":{"line":18,"column":6,"offset":998},"end":{"line":18,"column":30,"offset":1022},"indent":[]}}],"position":{"start":{"line":18,"column":5,"offset":997},"end":{"line":18,"column":48,"offset":1040},"indent":[]}},{"type":"text","value":" provides an interface for programmatically managing expressions. Use ","position":{"start":{"line":18,"column":48,"offset":1040},"end":{"line":18,"column":118,"offset":1110},"indent":[]}},{"type":"link","title":null,"url":"/api/cf-firewall-rules","children":[{"type":"emphasis","children":[{"type":"text","value":"Firewall Rules API","position":{"start":{"line":18,"column":120,"offset":1112},"end":{"line":18,"column":138,"offset":1130},"indent":[]}}],"position":{"start":{"line":18,"column":119,"offset":1111},"end":{"line":18,"column":139,"offset":1131},"indent":[]}}],"position":{"start":{"line":18,"column":118,"offset":1110},"end":{"line":18,"column":164,"offset":1156},"indent":[]}},{"type":"text","value":" to combine a filter with an action and deploy a new firewall rule.","position":{"start":{"line":18,"column":164,"offset":1156},"end":{"line":18,"column":231,"offset":1223},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":993},"end":{"line":18,"column":231,"offset":1223},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Simple and compound expressions","position":{"start":{"line":20,"column":4,"offset":1228},"end":{"line":20,"column":35,"offset":1259},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":1225},"end":{"line":20,"column":35,"offset":1259},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When working with Firewall Rules, you will encounter two kinds of expressions:","position":{"start":{"line":22,"column":1,"offset":1261},"end":{"line":22,"column":79,"offset":1339},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":1261},"end":{"line":22,"column":79,"offset":1339},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Simple expressions","position":{"start":{"line":24,"column":5,"offset":1345},"end":{"line":24,"column":23,"offset":1363},"indent":[]}}],"position":{"start":{"line":24,"column":3,"offset":1343},"end":{"line":24,"column":25,"offset":1365},"indent":[]}},{"type":"text","value":" compare a value from an HTTP request to a value defined in the expression. You can identify a simple expression by the presence of a ","position":{"start":{"line":24,"column":25,"offset":1365},"end":{"line":24,"column":159,"offset":1499},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"comparison operator","position":{"start":{"line":24,"column":161,"offset":1501},"end":{"line":24,"column":180,"offset":1520},"indent":[]}}],"position":{"start":{"line":24,"column":159,"offset":1499},"end":{"line":24,"column":182,"offset":1522},"indent":[]}},{"type":"text","value":" (","position":{"start":{"line":24,"column":182,"offset":1522},"end":{"line":24,"column":184,"offset":1524},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"equals, less than","position":{"start":{"line":24,"column":185,"offset":1525},"end":{"line":24,"column":202,"offset":1542},"indent":[]}}],"position":{"start":{"line":24,"column":184,"offset":1524},"end":{"line":24,"column":203,"offset":1543},"indent":[]}},{"type":"text","value":", for example).","position":{"start":{"line":24,"column":203,"offset":1543},"end":{"line":24,"column":218,"offset":1558},"indent":[]}}],"position":{"start":{"line":24,"column":3,"offset":1343},"end":{"line":24,"column":218,"offset":1558},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":1341},"end":{"line":25,"column":1,"offset":1559},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Compound expressions","position":{"start":{"line":26,"column":5,"offset":1564},"end":{"line":26,"column":25,"offset":1584},"indent":[]}}],"position":{"start":{"line":26,"column":3,"offset":1562},"end":{"line":26,"column":27,"offset":1586},"indent":[]}},{"type":"text","value":" combine two or more simple expressions into a single\nexpression. You can identify a compound expression by the presence of a ","position":{"start":{"line":26,"column":27,"offset":1586},"end":{"line":27,"column":75,"offset":1714},"indent":[3]}},{"type":"strong","children":[{"type":"text","value":"logical operator","position":{"start":{"line":27,"column":77,"offset":1716},"end":{"line":27,"column":93,"offset":1732},"indent":[]}}],"position":{"start":{"line":27,"column":75,"offset":1714},"end":{"line":27,"column":95,"offset":1734},"indent":[]}},{"type":"text","value":" (","position":{"start":{"line":27,"column":95,"offset":1734},"end":{"line":27,"column":97,"offset":1736},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"and","position":{"start":{"line":27,"column":98,"offset":1737},"end":{"line":27,"column":101,"offset":1740},"indent":[]}}],"position":{"start":{"line":27,"column":97,"offset":1736},"end":{"line":27,"column":102,"offset":1741},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":27,"column":102,"offset":1741},"end":{"line":27,"column":104,"offset":1743},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"or","position":{"start":{"line":27,"column":105,"offset":1744},"end":{"line":27,"column":107,"offset":1746},"indent":[]}}],"position":{"start":{"line":27,"column":104,"offset":1743},"end":{"line":27,"column":108,"offset":1747},"indent":[]}},{"type":"text","value":", for example). Since each firewall rule can only contain a single expression, compound expressions allow you to tailor rules to specific use cases with a high degree of accuracy and precision.","position":{"start":{"line":27,"column":108,"offset":1747},"end":{"line":27,"column":301,"offset":1940},"indent":[]}}],"position":{"start":{"line":26,"column":3,"offset":1562},"end":{"line":27,"column":301,"offset":1940},"indent":[3]}}],"position":{"start":{"line":26,"column":1,"offset":1560},"end":{"line":27,"column":301,"offset":1940},"indent":[1]}}],"position":{"start":{"line":24,"column":1,"offset":1341},"end":{"line":27,"column":301,"offset":1940},"indent":[1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Simple expressions","position":{"start":{"line":29,"column":5,"offset":1946},"end":{"line":29,"column":23,"offset":1964},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":1942},"end":{"line":29,"column":23,"offset":1964},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Simple expressions are composed of 3 elements:","position":{"start":{"line":31,"column":1,"offset":1966},"end":{"line":31,"column":47,"offset":2012},"indent":[]}}],"position":{"start":{"line":31,"column":1,"offset":1966},"end":{"line":31,"column":47,"offset":2012},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"A ","position":{"start":{"line":33,"column":4,"offset":2017},"end":{"line":33,"column":6,"offset":2019},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"field","position":{"start":{"line":33,"column":8,"offset":2021},"end":{"line":33,"column":13,"offset":2026},"indent":[]}}],"position":{"start":{"line":33,"column":6,"offset":2019},"end":{"line":33,"column":15,"offset":2028},"indent":[]}},{"type":"text","value":" that represents a property of an HTTP request.","position":{"start":{"line":33,"column":15,"offset":2028},"end":{"line":33,"column":62,"offset":2075},"indent":[]}}],"position":{"start":{"line":33,"column":4,"offset":2017},"end":{"line":33,"column":62,"offset":2075},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":2014},"end":{"line":33,"column":62,"offset":2075},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"A representative ","position":{"start":{"line":34,"column":4,"offset":2079},"end":{"line":34,"column":21,"offset":2096},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"value","position":{"start":{"line":34,"column":23,"offset":2098},"end":{"line":34,"column":28,"offset":2103},"indent":[]}}],"position":{"start":{"line":34,"column":21,"offset":2096},"end":{"line":34,"column":30,"offset":2105},"indent":[]}},{"type":"text","value":" for that field, which Firewall Rules will compare with the actual value from the request.","position":{"start":{"line":34,"column":30,"offset":2105},"end":{"line":34,"column":120,"offset":2195},"indent":[]}}],"position":{"start":{"line":34,"column":4,"offset":2079},"end":{"line":34,"column":120,"offset":2195},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":2076},"end":{"line":34,"column":120,"offset":2195},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"A ","position":{"start":{"line":35,"column":4,"offset":2199},"end":{"line":35,"column":6,"offset":2201},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"comparison operator","position":{"start":{"line":35,"column":8,"offset":2203},"end":{"line":35,"column":27,"offset":2222},"indent":[]}}],"position":{"start":{"line":35,"column":6,"offset":2201},"end":{"line":35,"column":29,"offset":2224},"indent":[]}},{"type":"text","value":", which specifies how the value defined in the expression must relate to the actual value from the request for the operator to return ","position":{"start":{"line":35,"column":29,"offset":2224},"end":{"line":35,"column":163,"offset":2358},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":35,"column":163,"offset":2358},"end":{"line":35,"column":169,"offset":2364},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":35,"column":169,"offset":2364},"end":{"line":35,"column":170,"offset":2365},"indent":[]}}],"position":{"start":{"line":35,"column":4,"offset":2199},"end":{"line":35,"column":170,"offset":2365},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":2196},"end":{"line":35,"column":170,"offset":2365},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":2014},"end":{"line":35,"column":170,"offset":2365},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"If the comparison operator returns ","position":{"start":{"line":37,"column":1,"offset":2367},"end":{"line":37,"column":36,"offset":2402},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":37,"column":36,"offset":2402},"end":{"line":37,"column":42,"offset":2408},"indent":[]}},{"type":"text","value":", the request matches the expression.","position":{"start":{"line":37,"column":42,"offset":2408},"end":{"line":37,"column":79,"offset":2445},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":2367},"end":{"line":37,"column":79,"offset":2445},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This Expression Builder screenshot shows an expression for matching requests that do not originate in the United Kingdom.","position":{"start":{"line":39,"column":1,"offset":2447},"end":{"line":39,"column":122,"offset":2568},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":2447},"end":{"line":39,"column":122,"offset":2568},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expressions-explained-1.png","alt":"Expression Builder","position":{"start":{"line":41,"column":1,"offset":2570},"end":{"line":41,"column":76,"offset":2645},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":2570},"end":{"line":41,"column":76,"offset":2645},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Notice how the ","position":{"start":{"line":43,"column":1,"offset":2647},"end":{"line":43,"column":16,"offset":2662},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Expression Preview","position":{"start":{"line":43,"column":18,"offset":2664},"end":{"line":43,"column":36,"offset":2682},"indent":[]}}],"position":{"start":{"line":43,"column":16,"offset":2662},"end":{"line":43,"column":38,"offset":2684},"indent":[]}},{"type":"text","value":" displays the expression in text:","position":{"start":{"line":43,"column":38,"offset":2684},"end":{"line":43,"column":71,"offset":2717},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":2647},"end":{"line":43,"column":71,"offset":2717},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"(ip.geoip.country ne \"GB\")","position":{"start":{"line":45,"column":1,"offset":2719},"end":{"line":47,"column":4,"offset":2756},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In this example, ","position":{"start":{"line":49,"column":1,"offset":2758},"end":{"line":49,"column":18,"offset":2775},"indent":[]}},{"type":"inlineCode","value":"ip.geoip.country","position":{"start":{"line":49,"column":18,"offset":2775},"end":{"line":49,"column":36,"offset":2793},"indent":[]}},{"type":"text","value":" represents the country associated with the requesting client’s IP address, and the value ","position":{"start":{"line":49,"column":36,"offset":2793},"end":{"line":49,"column":126,"offset":2883},"indent":[]}},{"type":"inlineCode","value":"\"GB\"","position":{"start":{"line":49,"column":126,"offset":2883},"end":{"line":49,"column":132,"offset":2889},"indent":[]}},{"type":"text","value":" represents the country code to match. The ","position":{"start":{"line":49,"column":132,"offset":2889},"end":{"line":49,"column":175,"offset":2932},"indent":[]}},{"type":"inlineCode","value":"ne","position":{"start":{"line":49,"column":175,"offset":2932},"end":{"line":49,"column":179,"offset":2936},"indent":[]}},{"type":"text","value":" notation between them represents the ","position":{"start":{"line":49,"column":179,"offset":2936},"end":{"line":49,"column":217,"offset":2974},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"not equal","position":{"start":{"line":49,"column":218,"offset":2975},"end":{"line":49,"column":227,"offset":2984},"indent":[]}}],"position":{"start":{"line":49,"column":217,"offset":2974},"end":{"line":49,"column":228,"offset":2985},"indent":[]}},{"type":"text","value":" comparison operator. Together, the expression specifies a match for any request with a country field value other than ","position":{"start":{"line":49,"column":228,"offset":2985},"end":{"line":49,"column":347,"offset":3104},"indent":[]}},{"type":"inlineCode","value":"GB","position":{"start":{"line":49,"column":347,"offset":3104},"end":{"line":49,"column":351,"offset":3108},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":49,"column":351,"offset":3108},"end":{"line":49,"column":352,"offset":3109},"indent":[]}}],"position":{"start":{"line":49,"column":1,"offset":2758},"end":{"line":49,"column":352,"offset":3109},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Simple expressions use this pattern:","position":{"start":{"line":51,"column":1,"offset":3111},"end":{"line":51,"column":37,"offset":3147},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":3111},"end":{"line":51,"column":37,"offset":3147},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"<field> <comparison operator> <value>","position":{"start":{"line":53,"column":1,"offset":3149},"end":{"line":55,"column":4,"offset":3197},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"For more on creating firewall rules using Cloudflare’s visual builder, see ","position":{"start":{"line":57,"column":1,"offset":3199},"end":{"line":57,"column":76,"offset":3274},"indent":[]}},{"type":"link","title":null,"url":"/cf-dashboard/create-edit-delete-rules","children":[{"type":"emphasis","children":[{"type":"text","value":"Create, edit, and delete rules","position":{"start":{"line":57,"column":78,"offset":3276},"end":{"line":57,"column":108,"offset":3306},"indent":[]}}],"position":{"start":{"line":57,"column":77,"offset":3275},"end":{"line":57,"column":109,"offset":3307},"indent":[]}}],"position":{"start":{"line":57,"column":76,"offset":3274},"end":{"line":57,"column":150,"offset":3348},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":57,"column":150,"offset":3348},"end":{"line":57,"column":151,"offset":3349},"indent":[]}}],"position":{"start":{"line":57,"column":1,"offset":3199},"end":{"line":57,"column":151,"offset":3349},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For a list of supported fields and comparison operators, see ","position":{"start":{"line":59,"column":1,"offset":3351},"end":{"line":59,"column":62,"offset":3412},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/","children":[{"type":"emphasis","children":[{"type":"text","value":"Firewall Rules language","position":{"start":{"line":59,"column":64,"offset":3414},"end":{"line":59,"column":87,"offset":3437},"indent":[]}}],"position":{"start":{"line":59,"column":63,"offset":3413},"end":{"line":59,"column":88,"offset":3438},"indent":[]}}],"position":{"start":{"line":59,"column":62,"offset":3412},"end":{"line":59,"column":113,"offset":3463},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":59,"column":113,"offset":3463},"end":{"line":59,"column":114,"offset":3464},"indent":[]}}],"position":{"start":{"line":59,"column":1,"offset":3351},"end":{"line":59,"column":114,"offset":3464},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Compound expressions","position":{"start":{"line":61,"column":5,"offset":3470},"end":{"line":61,"column":25,"offset":3490},"indent":[]}}],"position":{"start":{"line":61,"column":1,"offset":3466},"end":{"line":61,"column":25,"offset":3490},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"A ","position":{"start":{"line":63,"column":1,"offset":3492},"end":{"line":63,"column":3,"offset":3494},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"compound expression","position":{"start":{"line":63,"column":5,"offset":3496},"end":{"line":63,"column":24,"offset":3515},"indent":[]}}],"position":{"start":{"line":63,"column":3,"offset":3494},"end":{"line":63,"column":26,"offset":3517},"indent":[]}},{"type":"text","value":" uses a ","position":{"start":{"line":63,"column":26,"offset":3517},"end":{"line":63,"column":34,"offset":3525},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"logical operator","position":{"start":{"line":63,"column":36,"offset":3527},"end":{"line":63,"column":52,"offset":3543},"indent":[]}}],"position":{"start":{"line":63,"column":34,"offset":3525},"end":{"line":63,"column":54,"offset":3545},"indent":[]}},{"type":"text","value":" (","position":{"start":{"line":63,"column":54,"offset":3545},"end":{"line":63,"column":56,"offset":3547},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"and","position":{"start":{"line":63,"column":57,"offset":3548},"end":{"line":63,"column":60,"offset":3551},"indent":[]}}],"position":{"start":{"line":63,"column":56,"offset":3547},"end":{"line":63,"column":61,"offset":3552},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":63,"column":61,"offset":3552},"end":{"line":63,"column":63,"offset":3554},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"or","position":{"start":{"line":63,"column":64,"offset":3555},"end":{"line":63,"column":66,"offset":3557},"indent":[]}}],"position":{"start":{"line":63,"column":63,"offset":3554},"end":{"line":63,"column":67,"offset":3558},"indent":[]}},{"type":"text","value":", for example) to combine two or more expressions. Compound expressions are powerful because they allow you to build complex statements within a single expression.","position":{"start":{"line":63,"column":67,"offset":3558},"end":{"line":63,"column":230,"offset":3721},"indent":[]}}],"position":{"start":{"line":63,"column":1,"offset":3492},"end":{"line":63,"column":230,"offset":3721},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For example, suppose you want to stop other sites from direct linking to your website’s content. To do that, you can build an expression that matches requests to access your content URI, as in this example:","position":{"start":{"line":65,"column":1,"offset":3723},"end":{"line":65,"column":207,"offset":3929},"indent":[]}}],"position":{"start":{"line":65,"column":1,"offset":3723},"end":{"line":65,"column":207,"offset":3929},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"http.request.uri.path eq \"/content/\"","position":{"start":{"line":67,"column":1,"offset":3931},"end":{"line":69,"column":4,"offset":3978},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"While this expression will match requests for content, it does not discriminate between internal and external requests. As is, this rule will match every content request, including those referred from our own domain.","position":{"start":{"line":71,"column":1,"offset":3980},"end":{"line":71,"column":217,"offset":4196},"indent":[]}}],"position":{"start":{"line":71,"column":1,"offset":3980},"end":{"line":71,"column":217,"offset":4196},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To match only external requests for content, use the ","position":{"start":{"line":73,"column":1,"offset":4198},"end":{"line":73,"column":54,"offset":4251},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":73,"column":54,"offset":4251},"end":{"line":73,"column":59,"offset":4256},"indent":[]}},{"type":"text","value":" operator, as in this example:","position":{"start":{"line":73,"column":59,"offset":4256},"end":{"line":73,"column":89,"offset":4286},"indent":[]}}],"position":{"start":{"line":73,"column":1,"offset":4198},"end":{"line":73,"column":89,"offset":4286},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"http.referer ne \".example.com\" and http.request.uri.path eq \"/content/\"","position":{"start":{"line":75,"column":1,"offset":4288},"end":{"line":77,"column":4,"offset":4370},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Compound expressions only match requests that satisfy each of the simple expressions within. That is because the logical ","position":{"start":{"line":79,"column":1,"offset":4372},"end":{"line":79,"column":122,"offset":4493},"indent":[]}},{"type":"inlineCode","value":"and","position":{"start":{"line":79,"column":122,"offset":4493},"end":{"line":79,"column":127,"offset":4498},"indent":[]}},{"type":"text","value":" operator requires that both operands be true for the compound expression to return ","position":{"start":{"line":79,"column":127,"offset":4498},"end":{"line":79,"column":211,"offset":4582},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":79,"column":211,"offset":4582},"end":{"line":79,"column":217,"offset":4588},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":79,"column":217,"offset":4588},"end":{"line":79,"column":218,"offset":4589},"indent":[]}}],"position":{"start":{"line":79,"column":1,"offset":4372},"end":{"line":79,"column":218,"offset":4589},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In general, compound expressions use this pattern:","position":{"start":{"line":81,"column":1,"offset":4591},"end":{"line":81,"column":51,"offset":4641},"indent":[]}}],"position":{"start":{"line":81,"column":1,"offset":4591},"end":{"line":81,"column":51,"offset":4641},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"<expression> <logical operator> <expression>","position":{"start":{"line":83,"column":1,"offset":4643},"end":{"line":85,"column":4,"offset":4698},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Note that a compound expression can itself be one of the operands of a logical operator. In this way, you can use multiple operators to construct a compound expression from many individual expressions.","position":{"start":{"line":87,"column":1,"offset":4700},"end":{"line":87,"column":202,"offset":4901},"indent":[]}}],"position":{"start":{"line":87,"column":1,"offset":4700},"end":{"line":87,"column":202,"offset":4901},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Compound expressions are easier to scan when displayed in the Expression Builder’s visual interface, and the Expression Preview is a great reference for learning to write more advanced expressions.","position":{"start":{"line":89,"column":1,"offset":4903},"end":{"line":89,"column":198,"offset":5100},"indent":[]}}],"position":{"start":{"line":89,"column":1,"offset":4903},"end":{"line":89,"column":198,"offset":5100},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../images/firewall-rules-expressions-explained-2.png","alt":"Expression Builder with compound expression","position":{"start":{"line":91,"column":1,"offset":5102},"end":{"line":91,"column":101,"offset":5202},"indent":[]}}],"position":{"start":{"line":91,"column":1,"offset":5102},"end":{"line":91,"column":101,"offset":5202},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For a list of supported logical operators, see ","position":{"start":{"line":93,"column":1,"offset":5204},"end":{"line":93,"column":48,"offset":5251},"indent":[]}},{"type":"link","title":null,"url":"/cf-firewall-language/operators","children":[{"type":"emphasis","children":[{"type":"text","value":"Firewall Rules language: Operators","position":{"start":{"line":93,"column":50,"offset":5253},"end":{"line":93,"column":84,"offset":5287},"indent":[]}}],"position":{"start":{"line":93,"column":49,"offset":5252},"end":{"line":93,"column":85,"offset":5288},"indent":[]}}],"position":{"start":{"line":93,"column":48,"offset":5251},"end":{"line":93,"column":119,"offset":5322},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":93,"column":119,"offset":5322},"end":{"line":93,"column":120,"offset":5323},"indent":[]}}],"position":{"start":{"line":93,"column":1,"offset":5204},"end":{"line":93,"column":120,"offset":5323},"indent":[]}},{"type":"export","value":"export const _frontmatter = {\"pcx-content-type\":\"concept\",\"order\":210}","position":{"start":{"line":96,"column":1,"offset":5326},"end":{"line":96,"column":71,"offset":5396},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":96,"column":71,"offset":5396}}},"scopeImports":["import * as React from 'react'"],"scopeIdentifiers":["React"],"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"pcx-content-type\": \"concept\",\n  \"order\": 210\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"fields-and-expressions\"\n  }, \"Fields and expressions\"), mdx(\"h2\", {\n    \"id\": \"overview\"\n  }, \"Overview\"), mdx(\"p\", null, \"Every Cloudflare firewall rule, no matter how complex, is really just a combination of two elements: an \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"expression\"), \" and an \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"action\"), \". Expressions define the criteria for an HTTP request to trigger an action; the action tells Cloudflare what to do with that request.\"), mdx(\"p\", null, \"When an HTTP request reaches the firewall, Cloudflare compares values from the request to those defined in the expression. If the expression returns \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"true\"), \", the expression matches, and Cloudflare triggers the action for that rule.\"), mdx(\"h2\", {\n    \"id\": \"working-with-expressions\"\n  }, \"Working with expressions\"), mdx(\"p\", null, \"There are two interfaces in the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Firewall\"), \" app for creating expressions: the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Expression Builder\"), \" and the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Expression Editor\"), \".\"), mdx(\"p\", null, \"The Expression Builder\\u2019s visual interface allows you to build expressions without worrying about field names and syntax.\"), mdx(\"p\", null, \"By comparison, the Expression Editor is text only, but it supports advanced features not available in the builder. You can find both in the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Firewall Rules\"), \" tab.\"), mdx(\"p\", null, \"The \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/api/cf-filters\"\n  }, mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Cloudflare Filters API\")), \" provides an interface for programmatically managing expressions. Use \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/api/cf-firewall-rules\"\n  }, mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Firewall Rules API\")), \" to combine a filter with an action and deploy a new firewall rule.\"), mdx(\"h2\", {\n    \"id\": \"simple-and-compound-expressions\"\n  }, \"Simple and compound expressions\"), mdx(\"p\", null, \"When working with Firewall Rules, you will encounter two kinds of expressions:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Simple expressions\"), \" compare a value from an HTTP request to a value defined in the expression. You can identify a simple expression by the presence of a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"comparison operator\"), \" (\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"equals, less than\"), \", for example).\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Compound expressions\"), \" combine two or more simple expressions into a single\\nexpression. You can identify a compound expression by the presence of a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"logical operator\"), \" (\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"and\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"or\"), \", for example). Since each firewall rule can only contain a single expression, compound expressions allow you to tailor rules to specific use cases with a high degree of accuracy and precision.\"))), mdx(\"h3\", {\n    \"id\": \"simple-expressions\"\n  }, \"Simple expressions\"), mdx(\"p\", null, \"Simple expressions are composed of 3 elements:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"A \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"field\"), \" that represents a property of an HTTP request.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"A representative \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"value\"), \" for that field, which Firewall Rules will compare with the actual value from the request.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"A \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"comparison operator\"), \", which specifies how the value defined in the expression must relate to the actual value from the request for the operator to return \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"true\"), \".\")), mdx(\"p\", null, \"If the comparison operator returns \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"true\"), \", the request matches the expression.\"), mdx(\"p\", null, \"This Expression Builder screenshot shows an expression for matching requests that do not originate in the United Kingdom.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"954px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/3ce85b7accb7a1bfd58fe5c85eadbc91/eb2af/firewall-rules-expressions-explained-1.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"83.23699421965318%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABU0lEQVQ4y42SC27CMBBEfcbepkfoOXqW3qBSqiJVwSSEINLYsZ2P86GPWCAKrchgbcTKu96ZWbHP90mSZLvdWso4jtM0nabpuAxCKc2v934YhnHGcTEoVkVREFV5grU2tKDXwxGEc1aVSleV1hztnOv7nsoQHxTfp6YZPD49gijLb8DkxRyIdV0v5cyo/RnGGLgHqm3bNk1zPcs1QlJUJ7aaIb33oRhQBvkwEckgAeBO13VYi69EQYMg7EXkgJAPGH+DHqfTe2GswR7a0/VGs5u/5+Tk+1FZz0GwUkrJYm3TdAeyLM/zypjqf2Cq0qyWFnCAHiQbVCbMX9TqFkAcDgduLt/nW6uox23eRxvIZ1lWVebPzbmADRrGSTAhNNDMzouJT+s4RohFLy+5hD1BCOBc3bXN+9q+RVqEke7Huy7GxdXqk62QGxlFH9tEPr9+Pb1EP3OK3t7fqLXEAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Expression Builder\",\n    \"title\": \"Expression Builder\",\n    \"src\": \"/static/3ce85b7accb7a1bfd58fe5c85eadbc91/eb2af/firewall-rules-expressions-explained-1.png\",\n    \"srcSet\": [\"/static/3ce85b7accb7a1bfd58fe5c85eadbc91/8f77f/firewall-rules-expressions-explained-1.png 346w\", \"/static/3ce85b7accb7a1bfd58fe5c85eadbc91/e185b/firewall-rules-expressions-explained-1.png 691w\", \"/static/3ce85b7accb7a1bfd58fe5c85eadbc91/eb2af/firewall-rules-expressions-explained-1.png 954w\"],\n    \"sizes\": \"(max-width: 954px) 100vw, 954px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"Notice how the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Expression Preview\"), \" displays the expression in text:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"(ip.geoip.country ne \\\"GB\\\")\\n\")), mdx(\"p\", null, \"In this example, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ip.geoip.country\"), \" represents the country associated with the requesting client\\u2019s IP address, and the value \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\\"GB\\\"\"), \" represents the country code to match. The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ne\"), \" notation between them represents the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"not equal\"), \" comparison operator. Together, the expression specifies a match for any request with a country field value other than \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"GB\"), \".\"), mdx(\"p\", null, \"Simple expressions use this pattern:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"<field> <comparison operator> <value>\\n\")), mdx(\"p\", null, \"For more on creating firewall rules using Cloudflare\\u2019s visual builder, see \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-dashboard/create-edit-delete-rules\"\n  }, mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Create, edit, and delete rules\")), \".\"), mdx(\"p\", null, \"For a list of supported fields and comparison operators, see \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-firewall-language/\"\n  }, mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Firewall Rules language\")), \".\"), mdx(\"h3\", {\n    \"id\": \"compound-expressions\"\n  }, \"Compound expressions\"), mdx(\"p\", null, \"A \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"compound expression\"), \" uses a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"logical operator\"), \" (\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"and\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"or\"), \", for example) to combine two or more expressions. Compound expressions are powerful because they allow you to build complex statements within a single expression.\"), mdx(\"p\", null, \"For example, suppose you want to stop other sites from direct linking to your website\\u2019s content. To do that, you can build an expression that matches requests to access your content URI, as in this example:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"http.request.uri.path eq \\\"/content/\\\"\\n\")), mdx(\"p\", null, \"While this expression will match requests for content, it does not discriminate between internal and external requests. As is, this rule will match every content request, including those referred from our own domain.\"), mdx(\"p\", null, \"To match only external requests for content, use the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"and\"), \" operator, as in this example:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"http.referer ne \\\".example.com\\\" and http.request.uri.path eq \\\"/content/\\\"\\n\")), mdx(\"p\", null, \"Compound expressions only match requests that satisfy each of the simple expressions within. That is because the logical \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"and\"), \" operator requires that both operands be true for the compound expression to return \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"true\"), \".\"), mdx(\"p\", null, \"In general, compound expressions use this pattern:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sql\"\n  }, \"<expression> <logical operator> <expression>\\n\")), mdx(\"p\", null, \"Note that a compound expression can itself be one of the operands of a logical operator. In this way, you can use multiple operators to construct a compound expression from many individual expressions.\"), mdx(\"p\", null, \"Compound expressions are easier to scan when displayed in the Expression Builder\\u2019s visual interface, and the Expression Preview is a great reference for learning to write more advanced expressions.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1382px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/16b48c6ed28b37c1c5549cd71fb96c4e/e0202/firewall-rules-expressions-explained-2.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"82.9479768786127%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAABt0lEQVQ4y42T6XKrMAyFef83bNKyGELYwTbGhOTO3M82ZWh/tPWcOPIiHelYRGV5H8fJLHY2C1gW62DXvyC636u27bq+b7ueKNauDGOMdWP9GZGUCp9pkoD18/la1webhmR+dSbtqmr8XN9uZV03PzsQ+vHYdmfSHmCWCiPPC6VniqEOyDneJThBSs1t49WJmradpEuY24C0iT4MI2fb8wnJGdAW5T1JRagrQivrFFrm2QCltPGyY5AFhZ+BDOxPkyK0Sxupt23DDsqN40hG2H0/cG/bvpCzvH1jhjAwwwQXDFrPAGbpEzkzyzNz07RK61Dz6B+Nbf46N3r4rZc34PX6B3OaZjszvUGUo+ag8GHjuZxqRkjcvC6fNYd+QHNoYXH2JOEMb3pUS5Tr+0dMxXnhOhrm8ADu9e0DhGLYWT1nWNr9kdf95mefuJopLnT1Af9t2MM+HdlJm3rQzajch5Gk1C+YRZ5ngowKfsyZcEtR5Ley5CjNsrDPXFZ11Xauwy7X69vl8h7HqRBJloZ7iUecJCxFUaQiix1HFk4JR186Z6eTpGGR0A0/88K74XbUyQ53lA6d/x/vX8Pd9mLDyQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Expression Builder with compound expression\",\n    \"title\": \"Expression Builder with compound expression\",\n    \"src\": \"/static/16b48c6ed28b37c1c5549cd71fb96c4e/f868f/firewall-rules-expressions-explained-2.png\",\n    \"srcSet\": [\"/static/16b48c6ed28b37c1c5549cd71fb96c4e/8f77f/firewall-rules-expressions-explained-2.png 346w\", \"/static/16b48c6ed28b37c1c5549cd71fb96c4e/e185b/firewall-rules-expressions-explained-2.png 691w\", \"/static/16b48c6ed28b37c1c5549cd71fb96c4e/f868f/firewall-rules-expressions-explained-2.png 1382w\", \"/static/16b48c6ed28b37c1c5549cd71fb96c4e/e0202/firewall-rules-expressions-explained-2.png 1395w\"],\n    \"sizes\": \"(max-width: 1382px) 100vw, 1382px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"For a list of supported logical operators, see \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/cf-firewall-language/operators\"\n  }, mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Firewall Rules language: Operators\")), \".\"));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"pcx-content-type\": \"concept\",\n  \"order\": 210\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <h1 {...{\n      \"id\": \"fields-and-expressions\"\n    }}>{`Fields and expressions`}</h1>\n    <h2 {...{\n      \"id\": \"overview\"\n    }}>{`Overview`}</h2>\n    <p>{`Every Cloudflare firewall rule, no matter how complex, is really just a combination of two elements: an `}<strong parentName=\"p\">{`expression`}</strong>{` and an `}<strong parentName=\"p\">{`action`}</strong>{`. Expressions define the criteria for an HTTP request to trigger an action; the action tells Cloudflare what to do with that request.`}</p>\n    <p>{`When an HTTP request reaches the firewall, Cloudflare compares values from the request to those defined in the expression. If the expression returns `}<inlineCode parentName=\"p\">{`true`}</inlineCode>{`, the expression matches, and Cloudflare triggers the action for that rule.`}</p>\n    <h2 {...{\n      \"id\": \"working-with-expressions\"\n    }}>{`Working with expressions`}</h2>\n    <p>{`There are two interfaces in the `}<strong parentName=\"p\">{`Firewall`}</strong>{` app for creating expressions: the `}<strong parentName=\"p\">{`Expression Builder`}</strong>{` and the `}<strong parentName=\"p\">{`Expression Editor`}</strong>{`.`}</p>\n    <p>{`The Expression Builder’s visual interface allows you to build expressions without worrying about field names and syntax.`}</p>\n    <p>{`By comparison, the Expression Editor is text only, but it supports advanced features not available in the builder. You can find both in the `}<strong parentName=\"p\">{`Firewall Rules`}</strong>{` tab.`}</p>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"/api/cf-filters\"\n      }}><em parentName=\"a\">{`Cloudflare Filters API`}</em></a>{` provides an interface for programmatically managing expressions. Use `}<a parentName=\"p\" {...{\n        \"href\": \"/api/cf-firewall-rules\"\n      }}><em parentName=\"a\">{`Firewall Rules API`}</em></a>{` to combine a filter with an action and deploy a new firewall rule.`}</p>\n    <h2 {...{\n      \"id\": \"simple-and-compound-expressions\"\n    }}>{`Simple and compound expressions`}</h2>\n    <p>{`When working with Firewall Rules, you will encounter two kinds of expressions:`}</p>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><strong parentName=\"p\">{`Simple expressions`}</strong>{` compare a value from an HTTP request to a value defined in the expression. You can identify a simple expression by the presence of a `}<strong parentName=\"p\">{`comparison operator`}</strong>{` (`}<em parentName=\"p\">{`equals, less than`}</em>{`, for example).`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><strong parentName=\"p\">{`Compound expressions`}</strong>{` combine two or more simple expressions into a single\nexpression. You can identify a compound expression by the presence of a `}<strong parentName=\"p\">{`logical operator`}</strong>{` (`}<em parentName=\"p\">{`and`}</em>{`, `}<em parentName=\"p\">{`or`}</em>{`, for example). Since each firewall rule can only contain a single expression, compound expressions allow you to tailor rules to specific use cases with a high degree of accuracy and precision.`}</p>\n      </li>\n    </ul>\n    <h3 {...{\n      \"id\": \"simple-expressions\"\n    }}>{`Simple expressions`}</h3>\n    <p>{`Simple expressions are composed of 3 elements:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`A `}<strong parentName=\"li\">{`field`}</strong>{` that represents a property of an HTTP request.`}</li>\n      <li parentName=\"ol\">{`A representative `}<strong parentName=\"li\">{`value`}</strong>{` for that field, which Firewall Rules will compare with the actual value from the request.`}</li>\n      <li parentName=\"ol\">{`A `}<strong parentName=\"li\">{`comparison operator`}</strong>{`, which specifies how the value defined in the expression must relate to the actual value from the request for the operator to return `}<inlineCode parentName=\"li\">{`true`}</inlineCode>{`.`}</li>\n    </ol>\n    <p>{`If the comparison operator returns `}<inlineCode parentName=\"p\">{`true`}</inlineCode>{`, the request matches the expression.`}</p>\n    <p>{`This Expression Builder screenshot shows an expression for matching requests that do not originate in the United Kingdom.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"954px\"\n        }\n      }}>{`\n      `}<a parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-link\",\n          \"href\": \"/static/3ce85b7accb7a1bfd58fe5c85eadbc91/eb2af/firewall-rules-expressions-explained-1.png\",\n          \"style\": {\n            \"display\": \"block\"\n          },\n          \"target\": \"_blank\",\n          \"rel\": \"noopener\"\n        }}>{`\n    `}<span parentName=\"a\" {...{\n            \"className\": \"gatsby-resp-image-background-image\",\n            \"style\": {\n              \"paddingBottom\": \"83.23699421965318%\",\n              \"position\": \"relative\",\n              \"bottom\": \"0\",\n              \"left\": \"0\",\n              \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABU0lEQVQ4y42SC27CMBBEfcbepkfoOXqW3qBSqiJVwSSEINLYsZ2P86GPWCAKrchgbcTKu96ZWbHP90mSZLvdWso4jtM0nabpuAxCKc2v934YhnHGcTEoVkVREFV5grU2tKDXwxGEc1aVSleV1hztnOv7nsoQHxTfp6YZPD49gijLb8DkxRyIdV0v5cyo/RnGGLgHqm3bNk1zPcs1QlJUJ7aaIb33oRhQBvkwEckgAeBO13VYi69EQYMg7EXkgJAPGH+DHqfTe2GswR7a0/VGs5u/5+Tk+1FZz0GwUkrJYm3TdAeyLM/zypjqf2Cq0qyWFnCAHiQbVCbMX9TqFkAcDgduLt/nW6uox23eRxvIZ1lWVebPzbmADRrGSTAhNNDMzouJT+s4RohFLy+5hD1BCOBc3bXN+9q+RVqEke7Huy7GxdXqk62QGxlFH9tEPr9+Pb1EP3OK3t7fqLXEAAAAAElFTkSuQmCC')\",\n              \"backgroundSize\": \"cover\",\n              \"display\": \"block\"\n            }\n          }}></span>{`\n  `}<img parentName=\"a\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"alt\": \"Expression Builder\",\n            \"title\": \"Expression Builder\",\n            \"src\": \"/static/3ce85b7accb7a1bfd58fe5c85eadbc91/eb2af/firewall-rules-expressions-explained-1.png\",\n            \"srcSet\": [\"/static/3ce85b7accb7a1bfd58fe5c85eadbc91/8f77f/firewall-rules-expressions-explained-1.png 346w\", \"/static/3ce85b7accb7a1bfd58fe5c85eadbc91/e185b/firewall-rules-expressions-explained-1.png 691w\", \"/static/3ce85b7accb7a1bfd58fe5c85eadbc91/eb2af/firewall-rules-expressions-explained-1.png 954w\"],\n            \"sizes\": \"(max-width: 954px) 100vw, 954px\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            },\n            \"loading\": \"lazy\"\n          }}></img>{`\n  `}</a>{`\n    `}</span></p>\n    <p>{`Notice how the `}<strong parentName=\"p\">{`Expression Preview`}</strong>{` displays the expression in text:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sql\"\n      }}>{`(ip.geoip.country ne \"GB\")\n`}</code></pre>\n    <p>{`In this example, `}<inlineCode parentName=\"p\">{`ip.geoip.country`}</inlineCode>{` represents the country associated with the requesting client’s IP address, and the value `}<inlineCode parentName=\"p\">{`\"GB\"`}</inlineCode>{` represents the country code to match. The `}<inlineCode parentName=\"p\">{`ne`}</inlineCode>{` notation between them represents the `}<em parentName=\"p\">{`not equal`}</em>{` comparison operator. Together, the expression specifies a match for any request with a country field value other than `}<inlineCode parentName=\"p\">{`GB`}</inlineCode>{`.`}</p>\n    <p>{`Simple expressions use this pattern:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sql\"\n      }}>{`<field> <comparison operator> <value>\n`}</code></pre>\n    <p>{`For more on creating firewall rules using Cloudflare’s visual builder, see `}<a parentName=\"p\" {...{\n        \"href\": \"/cf-dashboard/create-edit-delete-rules\"\n      }}><em parentName=\"a\">{`Create, edit, and delete rules`}</em></a>{`.`}</p>\n    <p>{`For a list of supported fields and comparison operators, see `}<a parentName=\"p\" {...{\n        \"href\": \"/cf-firewall-language/\"\n      }}><em parentName=\"a\">{`Firewall Rules language`}</em></a>{`.`}</p>\n    <h3 {...{\n      \"id\": \"compound-expressions\"\n    }}>{`Compound expressions`}</h3>\n    <p>{`A `}<strong parentName=\"p\">{`compound expression`}</strong>{` uses a `}<strong parentName=\"p\">{`logical operator`}</strong>{` (`}<em parentName=\"p\">{`and`}</em>{`, `}<em parentName=\"p\">{`or`}</em>{`, for example) to combine two or more expressions. Compound expressions are powerful because they allow you to build complex statements within a single expression.`}</p>\n    <p>{`For example, suppose you want to stop other sites from direct linking to your website’s content. To do that, you can build an expression that matches requests to access your content URI, as in this example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sql\"\n      }}>{`http.request.uri.path eq \"/content/\"\n`}</code></pre>\n    <p>{`While this expression will match requests for content, it does not discriminate between internal and external requests. As is, this rule will match every content request, including those referred from our own domain.`}</p>\n    <p>{`To match only external requests for content, use the `}<inlineCode parentName=\"p\">{`and`}</inlineCode>{` operator, as in this example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sql\"\n      }}>{`http.referer ne \".example.com\" and http.request.uri.path eq \"/content/\"\n`}</code></pre>\n    <p>{`Compound expressions only match requests that satisfy each of the simple expressions within. That is because the logical `}<inlineCode parentName=\"p\">{`and`}</inlineCode>{` operator requires that both operands be true for the compound expression to return `}<inlineCode parentName=\"p\">{`true`}</inlineCode>{`.`}</p>\n    <p>{`In general, compound expressions use this pattern:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sql\"\n      }}>{`<expression> <logical operator> <expression>\n`}</code></pre>\n    <p>{`Note that a compound expression can itself be one of the operands of a logical operator. In this way, you can use multiple operators to construct a compound expression from many individual expressions.`}</p>\n    <p>{`Compound expressions are easier to scan when displayed in the Expression Builder’s visual interface, and the Expression Preview is a great reference for learning to write more advanced expressions.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1382px\"\n        }\n      }}>{`\n      `}<a parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-link\",\n          \"href\": \"/static/16b48c6ed28b37c1c5549cd71fb96c4e/e0202/firewall-rules-expressions-explained-2.png\",\n          \"style\": {\n            \"display\": \"block\"\n          },\n          \"target\": \"_blank\",\n          \"rel\": \"noopener\"\n        }}>{`\n    `}<span parentName=\"a\" {...{\n            \"className\": \"gatsby-resp-image-background-image\",\n            \"style\": {\n              \"paddingBottom\": \"82.9479768786127%\",\n              \"position\": \"relative\",\n              \"bottom\": \"0\",\n              \"left\": \"0\",\n              \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAABt0lEQVQ4y42T6XKrMAyFef83bNKyGELYwTbGhOTO3M82ZWh/tPWcOPIiHelYRGV5H8fJLHY2C1gW62DXvyC636u27bq+b7ueKNauDGOMdWP9GZGUCp9pkoD18/la1webhmR+dSbtqmr8XN9uZV03PzsQ+vHYdmfSHmCWCiPPC6VniqEOyDneJThBSs1t49WJmradpEuY24C0iT4MI2fb8wnJGdAW5T1JRagrQivrFFrm2QCltPGyY5AFhZ+BDOxPkyK0Sxupt23DDsqN40hG2H0/cG/bvpCzvH1jhjAwwwQXDFrPAGbpEzkzyzNz07RK61Dz6B+Nbf46N3r4rZc34PX6B3OaZjszvUGUo+ag8GHjuZxqRkjcvC6fNYd+QHNoYXH2JOEMb3pUS5Tr+0dMxXnhOhrm8ADu9e0DhGLYWT1nWNr9kdf95mefuJopLnT1Af9t2MM+HdlJm3rQzajch5Gk1C+YRZ5ngowKfsyZcEtR5Ley5CjNsrDPXFZ11Xauwy7X69vl8h7HqRBJloZ7iUecJCxFUaQiix1HFk4JR186Z6eTpGGR0A0/88K74XbUyQ53lA6d/x/vX8Pd9mLDyQAAAABJRU5ErkJggg==')\",\n              \"backgroundSize\": \"cover\",\n              \"display\": \"block\"\n            }\n          }}></span>{`\n  `}<img parentName=\"a\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"alt\": \"Expression Builder with compound expression\",\n            \"title\": \"Expression Builder with compound expression\",\n            \"src\": \"/static/16b48c6ed28b37c1c5549cd71fb96c4e/f868f/firewall-rules-expressions-explained-2.png\",\n            \"srcSet\": [\"/static/16b48c6ed28b37c1c5549cd71fb96c4e/8f77f/firewall-rules-expressions-explained-2.png 346w\", \"/static/16b48c6ed28b37c1c5549cd71fb96c4e/e185b/firewall-rules-expressions-explained-2.png 691w\", \"/static/16b48c6ed28b37c1c5549cd71fb96c4e/f868f/firewall-rules-expressions-explained-2.png 1382w\", \"/static/16b48c6ed28b37c1c5549cd71fb96c4e/e0202/firewall-rules-expressions-explained-2.png 1395w\"],\n            \"sizes\": \"(max-width: 1382px) 100vw, 1382px\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            },\n            \"loading\": \"lazy\"\n          }}></img>{`\n  `}</a>{`\n    `}</span></p>\n    <p>{`For a list of supported logical operators, see `}<a parentName=\"p\" {...{\n        \"href\": \"/cf-firewall-language/operators\"\n      }}><em parentName=\"a\">{`Firewall Rules language: Operators`}</em></a>{`.`}</p>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}